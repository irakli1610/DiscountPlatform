2025-03-23 13:06:32.460 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 13:06:32.511 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 13:06:32.526 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 13:06:32.587 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 13:06:32.597 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 13:06:32.601 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 13:06:32.608 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 13:06:32.618 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 13:06:32.621 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 13:06:32.857 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:32.869 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:32.873 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:32.890 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:32.894 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:32.897 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:32.984 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 13:06:33.057 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 13:06:33.083 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:33.117 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 13:06:33.133 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 13:06:33.195 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:06:33.248 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 13:06:33.516 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 13:06:33.518 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 13:06:33.627 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 13:06:33.628 +04:00  INF  Hosting environment: Development
2025-03-23 13:06:33.630 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 13:06:34.070 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 13:06:34.360 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 296.1624ms
2025-03-23 13:06:34.405 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 13:06:34.405 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 13:06:34.424 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 19.4166ms
2025-03-23 13:06:34.476 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 71.7173ms
2025-03-23 13:06:34.642 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 13:06:34.671 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 28.6362ms
2025-03-23 13:27:22.462 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 13:27:22.518 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 13:27:22.541 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 13:27:22.604 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 13:27:22.615 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 13:27:22.618 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 13:27:22.622 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 13:27:22.630 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 13:27:22.633 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 13:27:22.846 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:22.854 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:22.858 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:22.874 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:22.877 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:22.880 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:22.930 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 13:27:22.985 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 13:27:23.003 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:23.031 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 13:27:23.044 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 13:27:23.087 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 13:27:23.129 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 13:27:23.295 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 13:27:23.296 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 13:27:23.418 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 13:27:23.420 +04:00  INF  Hosting environment: Development
2025-03-23 13:27:23.421 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 13:27:23.896 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 13:27:24.119 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 229.9607ms
2025-03-23 13:27:24.148 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 13:27:24.148 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 13:27:24.158 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.2505ms
2025-03-23 13:27:24.205 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 57.8823ms
2025-03-23 13:27:24.381 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 13:27:24.411 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.1079ms
2025-03-23 13:27:32.774 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-all?pageNumber=1&pageSize=10 - null null
2025-03-23 13:27:32.792 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API)'
2025-03-23 13:27:32.819 +04:00  INF  Route matched with {action = "GetAllCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel]] GetAllCategoriesAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 13:27:32.896 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 13:27:32.898 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 13:27:32.932 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 13:27:33.020 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 13:27:33.031 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API) in 206.0044ms
2025-03-23 13:27:33.034 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API)'
2025-03-23 13:27:33.039 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-all?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 265.059ms
2025-03-23 14:00:42.175 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-all?pageNumber=-5&pageSize=10 - null null
2025-03-23 14:00:42.183 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API)'
2025-03-23 14:00:42.185 +04:00  INF  Route matched with {action = "GetAllCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel]] GetAllCategoriesAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:00:42.247 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 14:00:42.262 +04:00  ERR  An exception occurred while iterating over the results of a query for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): The offset specified in a OFFSET clause may not be negative.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:0d112321-baaf-4756-bc93-52b8792aa511
Error Number:10742,State:1,Class:15Microsoft.Data.SqlClient.SqlException (0x80131904): The offset specified in a OFFSET clause may not be negative.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:0d112321-baaf-4756-bc93-52b8792aa511
Error Number:10742,State:1,Class:15

2025-03-23 14:00:42.354 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API) in 167.3869ms
2025-03-23 14:00:42.356 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API)'
2025-03-23 14:00:47.965 +04:00  ERR  Unhandled exception occurred.Microsoft.Data.SqlClient.SqlException (0x80131904): The offset specified in a OFFSET clause may not be negative.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.BaseRepository`1.GetAllAsync(Int32 pageNumber, Int32 pageSize, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\BaseRepository.cs:line 38
   at offers.itacademy.ge.Application.Services.CategoryService.GetAllCategoriesAsync(Int32 pageNumber, Int32 pageSize, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 27
   at offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync(Int32 pageNumber, Int32 pageSize, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 26
   at lambda_method345(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21
ClientConnectionId:0d112321-baaf-4756-bc93-52b8792aa511
Error Number:10742,State:1,Class:15

2025-03-23 14:00:48.066 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-all?pageNumber=-5&pageSize=10 - 500 null application/json 5891.8707ms
2025-03-23 14:01:08.185 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-all?pageNumber=5&pageSize=10 - null null
2025-03-23 14:01:08.195 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API)'
2025-03-23 14:01:08.196 +04:00  INF  Route matched with {action = "GetAllCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel]] GetAllCategoriesAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:01:08.207 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 14:01:08.210 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 14:01:08.211 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API) in 13.1924ms
2025-03-23 14:01:08.213 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetAllCategoriesAsync (offers.itacademy.ge.API)'
2025-03-23 14:01:08.214 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-all?pageNumber=5&pageSize=10 - 200 null application/json; charset=utf-8 28.9894ms
2025-03-23 14:01:23.037 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/1 - null null
2025-03-23 14:01:23.042 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-23 14:01:23.050 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:01:23.089 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:01:23.095 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-23 14:01:23.097 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 45.4534ms
2025-03-23 14:01:23.098 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-23 14:01:23.099 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/1 - 200 null application/json; charset=utf-8 61.9318ms
2025-03-23 14:01:25.920 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/10 - null null
2025-03-23 14:01:25.923 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-23 14:01:25.924 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:01:25.930 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:01:25.973 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 47.0113ms
2025-03-23 14:01:25.975 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-23 14:01:27.951 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-23 14:01:27.953 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/10 - 404 null application/json 2033.3591ms
2025-03-23 14:01:46.523 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 22
2025-03-23 14:01:46.538 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-23 14:01:46.543 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-23 14:01:46.544 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 401 0 null 21.2812ms
2025-03-23 14:01:59.404 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-23 14:01:59.407 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 14:01:59.412 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 14:01:59.475 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 14:01:59.657 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 14:01:59.659 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 245.2989ms
2025-03-23 14:01:59.660 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 14:01:59.662 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 258.2826ms
2025-03-23 14:02:09.843 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 22
2025-03-23 14:02:09.885 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:09.890 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:02:09.908 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__categoryModel_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__categoryModel_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:02:09.993 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-03-23 14:02:10.015 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-23 14:02:10.017 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 124.0102ms
2025-03-23 14:02:10.018 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:10.019 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 200 null application/json; charset=utf-8 177.4697ms
2025-03-23 14:02:20.452 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 22
2025-03-23 14:02:20.457 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:20.458 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:02:20.463 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__categoryModel_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__categoryModel_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:02:20.510 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 50.7087ms
2025-03-23 14:02:20.512 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:22.043 +04:00  WRN  ObjectAlreadyExistsException: Category with this specifications already exists
2025-03-23 14:02:22.045 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 409 null application/json 1593.2865ms
2025-03-23 14:02:30.640 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 23
2025-03-23 14:02:30.643 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:30.645 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:02:30.651 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__categoryModel_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__categoryModel_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:02:30.661 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-03-23 14:02:30.665 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-23 14:02:30.666 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 19.8645ms
2025-03-23 14:02:30.668 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:30.669 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 200 null application/json; charset=utf-8 28.5281ms
2025-03-23 14:02:37.364 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 16
2025-03-23 14:02:37.368 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:37.369 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:02:37.378 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 14:02:37.396 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 25.3274ms
2025-03-23 14:02:37.397 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:37.398 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 400 null application/problem+json; charset=utf-8 34.1741ms
2025-03-23 14:02:40.825 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 3
2025-03-23 14:02:40.829 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:40.830 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:02:40.832 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 14:02:40.834 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 2.6754ms
2025-03-23 14:02:40.835 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:40.836 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 400 null application/problem+json; charset=utf-8 10.8947ms
2025-03-23 14:02:57.763 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - application/json 23
2025-03-23 14:02:57.775 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:57.781 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:02:57.790 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:02:57.797 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__updatedCategory_Name_0='?' (Size = 100), @__id_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__updatedCategory_Name_0 AND [c].[Id] <> @__id_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:02:57.806 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Categories] SET [Name] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-03-23 14:02:57.809 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-23 14:02:57.811 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 27.8094ms
2025-03-23 14:02:57.812 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:02:57.813 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - 200 null application/json; charset=utf-8 50.5843ms
2025-03-23 14:03:01.649 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/40 - application/json 23
2025-03-23 14:03:01.652 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:01.654 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:01.659 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:03:01.718 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 61.9337ms
2025-03-23 14:03:01.720 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:05.605 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-23 14:03:05.607 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/40 - 404 null application/json 3957.9123ms
2025-03-23 14:03:12.410 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - application/json 16
2025-03-23 14:03:12.413 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:12.414 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:12.417 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 14:03:12.418 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 2.1317ms
2025-03-23 14:03:12.419 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:12.421 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - 400 null application/problem+json; charset=utf-8 10.5895ms
2025-03-23 14:03:15.986 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - application/json 3
2025-03-23 14:03:15.989 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:15.990 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:15.993 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 14:03:15.995 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 2.7848ms
2025-03-23 14:03:15.997 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:15.998 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - 400 null application/problem+json; charset=utf-8 11.9491ms
2025-03-23 14:03:29.976 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - application/json 25
2025-03-23 14:03:29.979 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:29.980 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:29.985 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:03:29.989 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__updatedCategory_Name_0='?' (Size = 100), @__id_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__updatedCategory_Name_0 AND [c].[Id] <> @__id_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:03:29.998 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Categories] SET [Name] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-03-23 14:03:30.000 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-23 14:03:30.002 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 19.4544ms
2025-03-23 14:03:30.003 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:30.004 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/4 - 200 null application/json; charset=utf-8 28.9349ms
2025-03-23 14:03:44.723 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/66 - null null
2025-03-23 14:03:44.727 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:44.731 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:44.737 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:03:44.783 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 50.7401ms
2025-03-23 14:03:44.785 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:46.340 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-23 14:03:46.342 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/66 - 404 null application/json 1618.8241ms
2025-03-23 14:03:49.828 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/5 - null null
2025-03-23 14:03:49.831 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:49.832 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:49.837 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:03:49.857 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-23 14:03:49.862 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 27.3792ms
2025-03-23 14:03:49.863 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:49.864 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/5 - 200 0 null 35.8926ms
2025-03-23 14:03:57.620 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/4 - null null
2025-03-23 14:03:57.624 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:57.625 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:03:57.631 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:03:57.641 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-23 14:03:57.643 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 16.6584ms
2025-03-23 14:03:57.645 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:03:57.646 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/4 - 200 0 null 25.4258ms
2025-03-23 14:04:22.136 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-23 14:04:22.144 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:04:22.145 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-23 14:04:22.150 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-23 14:04:22.163 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-23 14:04:22.165 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 18.1002ms
2025-03-23 14:04:22.166 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-23 14:04:22.167 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 200 0 null 31.5517ms
2025-03-23 14:28:17.962 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 14:28:18.424 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 14:28:18.446 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 14:28:18.501 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 14:28:18.511 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 14:28:18.515 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 14:28:18.523 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 14:28:18.531 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 14:28:18.535 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 14:28:18.774 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:18.837 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:18.841 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:18.854 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:18.858 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:18.861 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:18.909 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-03-23 14:28:18.969 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 14:28:18.999 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 14:28:19.011 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:19.082 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 14:28:19.097 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 14:28:19.111 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 14:28:19.126 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:28:19.148 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-23 14:28:19.177 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 14:28:19.342 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 14:28:19.344 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 14:28:19.464 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 14:28:19.465 +04:00  INF  Hosting environment: Development
2025-03-23 14:28:19.466 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 14:28:19.606 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 14:28:19.867 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 270.3344ms
2025-03-23 14:28:19.899 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 14:28:19.899 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 14:28:19.928 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 29.6241ms
2025-03-23 14:28:19.957 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 58.8476ms
2025-03-23 14:28:20.228 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 14:28:20.262 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 34.5339ms
2025-03-23 14:29:51.201 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 14:29:51.246 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 14:29:51.267 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 14:29:51.324 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 14:29:51.337 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 14:29:51.340 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 14:29:51.347 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 14:29:51.356 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 14:29:51.360 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 14:29:51.598 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.606 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.610 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.625 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.630 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.632 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.684 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 14:29:51.735 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 14:29:51.753 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.781 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 14:29:51.795 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 14:29:51.837 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 14:29:51.878 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 14:29:52.037 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 14:29:52.039 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 14:29:52.138 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 14:29:52.140 +04:00  INF  Hosting environment: Development
2025-03-23 14:29:52.141 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 14:29:52.459 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 14:29:52.680 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 227.7629ms
2025-03-23 14:29:52.709 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 14:29:52.709 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 14:29:52.719 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.7405ms
2025-03-23 14:29:52.754 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.3286ms
2025-03-23 14:29:52.990 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 14:29:53.015 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.2929ms
2025-03-23 14:30:01.433 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/companies?pageNumber=1&pageSize=10 - null null
2025-03-23 14:30:01.452 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-23 14:30:01.458 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-23 14:30:01.460 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/companies?pageNumber=1&pageSize=10 - 401 0 null 27.2607ms
2025-03-23 14:30:22.795 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-23 14:30:22.802 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 14:30:22.828 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 14:30:22.980 +04:00  INF  Executed DbCommand (28ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 14:30:23.175 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 14:30:23.181 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 347.9354ms
2025-03-23 14:30:23.184 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 14:30:23.189 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 394.2476ms
2025-03-23 14:30:31.067 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/companies?pageNumber=1&pageSize=10 - null null
2025-03-23 14:30:31.098 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-23 14:30:31.103 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-23 14:30:31.104 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/companies?pageNumber=1&pageSize=10 - 403 0 null 37.6795ms
2025-03-23 14:30:37.029 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/customers?pageNumber=1&pageSize=10 - null null
2025-03-23 14:30:37.034 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-23 14:30:37.035 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-23 14:30:37.037 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/customers?pageNumber=1&pageSize=10 - 403 0 null 7.9481ms
2025-03-23 14:30:41.748 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/admins?pageNumber=1&pageSize=10 - null null
2025-03-23 14:30:41.752 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-23 14:30:41.753 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-23 14:30:41.754 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/admins?pageNumber=1&pageSize=10 - 403 0 null 6.3176ms
2025-03-23 14:30:49.817 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-23 14:30:49.820 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 14:30:49.822 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 14:30:49.872 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 14:30:50.010 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 14:30:50.012 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 187.8992ms
2025-03-23 14:30:50.013 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 14:30:50.015 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 198.4376ms
2025-03-23 14:31:00.759 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/companies?pageNumber=1&pageSize=10 - null null
2025-03-23 14:31:00.763 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetAllCompaniesAsync (offers.itacademy.ge.API)'
2025-03-23 14:31:00.769 +04:00  INF  Route matched with {action = "GetAllCompanies", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Users.Company.CompanyResponseModel]] GetAllCompaniesAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 14:31:00.796 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 14:31:00.798 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 14:31:00.809 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 14:31:00.874 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Users.Company.CompanyResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 14:31:00.889 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.GetAllCompaniesAsync (offers.itacademy.ge.API) in 117.8429ms
2025-03-23 14:31:00.892 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetAllCompaniesAsync (offers.itacademy.ge.API)'
2025-03-23 14:31:00.893 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/companies?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 134.6934ms
2025-03-23 14:31:06.244 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/customers?pageNumber=1&pageSize=10 - null null
2025-03-23 14:31:06.247 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetAllCustomersAsync (offers.itacademy.ge.API)'
2025-03-23 14:31:06.251 +04:00  INF  Route matched with {action = "GetAllCustomers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Users.Customer.CustomerResponseModel]] GetAllCustomersAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 14:31:06.257 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 14:31:06.258 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 14:31:06.268 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 14:31:06.274 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Users.Customer.CustomerResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 14:31:06.278 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.GetAllCustomersAsync (offers.itacademy.ge.API) in 24.6573ms
2025-03-23 14:31:06.279 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetAllCustomersAsync (offers.itacademy.ge.API)'
2025-03-23 14:31:06.281 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/customers?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 36.7234ms
2025-03-23 14:31:08.888 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/admins?pageNumber=1&pageSize=10 - null null
2025-03-23 14:31:08.891 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetAllAdminsAsync (offers.itacademy.ge.API)'
2025-03-23 14:31:08.895 +04:00  INF  Route matched with {action = "GetAllAdmins", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Users.Admin.AdminResponseModel]] GetAllAdminsAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 14:31:08.900 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 14:31:08.902 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 14:31:08.912 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 0
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 14:31:08.917 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Users.Admin.AdminResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 14:31:08.921 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.GetAllAdminsAsync (offers.itacademy.ge.API) in 24.5016ms
2025-03-23 14:31:08.923 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetAllAdminsAsync (offers.itacademy.ge.API)'
2025-03-23 14:31:08.924 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/admins?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 36.2953ms
2025-03-23 15:04:12.320 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 15:04:12.375 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 15:04:12.411 +04:00  INF  Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 15:04:12.473 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 15:04:12.484 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 15:04:12.488 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 15:04:12.497 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 15:04:12.506 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 15:04:12.510 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 15:04:12.740 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.748 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.752 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.767 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.770 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.773 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.822 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 15:04:12.873 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 15:04:12.891 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:12.918 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 15:04:12.933 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 15:04:12.975 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 15:04:13.011 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 15:04:13.196 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 15:04:13.197 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 15:04:13.300 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 15:04:13.301 +04:00  INF  Hosting environment: Development
2025-03-23 15:04:13.302 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 15:04:13.648 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 15:04:13.871 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 230.831ms
2025-03-23 15:04:13.899 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 15:04:13.899 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 15:04:13.908 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.1793ms
2025-03-23 15:04:13.946 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.6608ms
2025-03-23 15:04:14.082 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 15:04:14.106 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 23.7301ms
2025-03-23 15:04:31.978 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/2/activate-company - null 0
2025-03-23 15:04:31.998 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-23 15:04:32.004 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-23 15:04:32.005 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/2/activate-company - 401 0 null 27.4759ms
2025-03-23 15:04:41.777 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-23 15:04:41.785 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 15:04:41.818 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 15:04:41.952 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 15:04:42.151 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 15:04:42.157 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 331.623ms
2025-03-23 15:04:42.159 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 15:04:42.164 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 386.3267ms
2025-03-23 15:04:50.395 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/2/activate-company - null 0
2025-03-23 15:04:50.443 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-23 15:04:50.450 +04:00  INF  Route matched with {action = "ActivateCompany", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] ActivateCompany(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 15:04:50.531 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 15:04:50.590 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API) in 136.6577ms
2025-03-23 15:04:50.592 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-23 15:04:52.071 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Company is already activated
   at offers.itacademy.ge.Application.Services.UserService.ActivateCompanyAsync(Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 122
   at offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 58
   at lambda_method379(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 15:04:52.162 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/2/activate-company - 500 null application/json 1767.0053ms
2025-03-23 15:05:19.516 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/2/activate-company - null 0
2025-03-23 15:05:19.529 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-23 15:05:19.530 +04:00  INF  Route matched with {action = "ActivateCompany", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] ActivateCompany(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 15:05:19.541 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 15:05:19.594 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 100), @p2='?' (Size = 255), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Balance] = @p0, [Email] = @p1, [ImageUrl] = @p2, [IsActivated] = @p3, [Password] = @p4, [Role] = @p5, [UserName] = @p6
OUTPUT 1
WHERE [Id] = @p7;
2025-03-23 15:05:19.605 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-23 15:05:19.610 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API) in 77.8045ms
2025-03-23 15:05:19.611 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-23 15:05:19.613 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/2/activate-company - 200 null application/json; charset=utf-8 96.7413ms
2025-03-23 15:05:35.749 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/20/activate-company - null 0
2025-03-23 15:05:35.753 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-23 15:05:35.758 +04:00  INF  Route matched with {action = "ActivateCompany", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] ActivateCompany(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 15:05:35.777 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 15:05:35.826 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API) in 66.6107ms
2025-03-23 15:05:35.828 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-23 15:05:37.192 +04:00  INF  NotFoundException: Company with this specifications was not fund
2025-03-23 15:05:37.194 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/20/activate-company - 404 null application/json 1446.0415ms
2025-03-23 17:56:07.456 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 17:56:07.507 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 17:56:07.528 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 17:56:07.582 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 17:56:07.591 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 17:56:07.595 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 17:56:07.603 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 17:56:07.612 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 17:56:07.617 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 17:56:07.836 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:07.843 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:07.846 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:07.862 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:07.866 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:07.869 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:07.916 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 17:56:07.974 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 17:56:07.992 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:08.018 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 17:56:08.033 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 17:56:08.075 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 17:56:08.117 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 17:56:08.292 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 17:56:08.294 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 17:56:08.402 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 17:56:08.404 +04:00  INF  Hosting environment: Development
2025-03-23 17:56:08.405 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 17:56:08.642 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 17:56:08.870 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 234.8949ms
2025-03-23 17:56:08.906 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 17:56:08.906 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 17:56:08.915 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.9479ms
2025-03-23 17:56:08.963 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 58.4056ms
2025-03-23 17:56:09.189 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 17:56:09.229 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.3957ms
2025-03-23 18:02:23.488 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:02:23.539 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:02:23.565 +04:00  INF  Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:02:23.643 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:02:23.654 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:02:23.661 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:02:23.673 +04:00  INF  Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:02:23.684 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:02:23.693 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:02:23.929 +04:00  INF  Executed DbCommand (24ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:23.937 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:23.940 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:23.971 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:23.974 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:23.977 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:24.030 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:02:24.080 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:02:24.105 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:24.139 +04:00  INF  Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:02:24.155 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:02:24.201 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:02:24.243 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:02:24.452 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:02:24.453 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:02:24.607 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:02:24.614 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:02:24.615 +04:00  INF  Hosting environment: Development
2025-03-23 18:02:24.616 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:02:24.854 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 254.8636ms
2025-03-23 18:02:24.881 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:02:24.881 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:02:24.898 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 17.1328ms
2025-03-23 18:02:24.934 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.0368ms
2025-03-23 18:02:25.047 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:02:25.082 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 35.5032ms
2025-03-23 18:06:27.468 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/all?pageNumber=1&pageSize=10 - null null
2025-03-23 18:06:27.494 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Company)
2025-03-23 18:06:27.499 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-23 18:06:27.501 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/all?pageNumber=1&pageSize=10 - 401 0 null 34.8736ms
2025-03-23 18:06:44.932 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:06:44.939 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:06:44.964 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:06:45.096 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:06:45.294 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:06:45.302 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 331.4817ms
2025-03-23 18:06:45.304 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:06:45.308 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 376.2607ms
2025-03-23 18:06:56.988 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/all?pageNumber=1&pageSize=10 - null null
2025-03-23 18:06:57.025 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:06:57.033 +04:00  INF  Route matched with {action = "GetAllOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetAllOffersAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:06:57.095 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:06:57.097 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:06:57.126 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 18:06:57.203 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:06:57.217 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllOffersAsync (offers.itacademy.ge.API) in 181.461ms
2025-03-23 18:06:57.220 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:06:57.222 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/all?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 234.2275ms
2025-03-23 18:07:05.193 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/active?pageNumber=1&pageSize=10 - null null
2025-03-23 18:07:05.197 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllActiveOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:07:05.203 +04:00  INF  Route matched with {action = "GetAllActiveOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetAllActiveOffersAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:07:05.235 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:07:05.236 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:07:05.301 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Status] = 0
    ORDER BY (SELECT 1)
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [p0]
INNER JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:07:05.307 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:07:05.310 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllActiveOffersAsync (offers.itacademy.ge.API) in 104.0494ms
2025-03-23 18:07:05.312 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllActiveOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:07:05.313 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/active?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 120.2383ms
2025-03-23 18:07:21.920 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/id/1 - null null
2025-03-23 18:07:21.924 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetOfferByIdAsync (offers.itacademy.ge.API)'
2025-03-23 18:07:21.932 +04:00  INF  Route matched with {action = "GetOfferById", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] GetOfferByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:07:21.959 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 18:07:22.017 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetOfferByIdAsync (offers.itacademy.ge.API) in 82.8265ms
2025-03-23 18:07:22.019 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetOfferByIdAsync (offers.itacademy.ge.API)'
2025-03-23 18:07:23.821 +04:00  INF  NotFoundException: product was not found with this specifications
2025-03-23 18:07:23.889 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/id/1 - 404 null application/json 1969.5217ms
2025-03-23 18:07:45.840 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/id/2 - null null
2025-03-23 18:07:45.847 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetOfferByIdAsync (offers.itacademy.ge.API)'
2025-03-23 18:07:45.848 +04:00  INF  Route matched with {action = "GetOfferById", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] GetOfferByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:07:45.857 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 18:07:45.865 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel'.
2025-03-23 18:07:45.867 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetOfferByIdAsync (offers.itacademy.ge.API) in 15.4789ms
2025-03-23 18:07:45.869 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetOfferByIdAsync (offers.itacademy.ge.API)'
2025-03-23 18:07:45.870 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/id/2 - 200 null application/json; charset=utf-8 30.9893ms
2025-03-23 18:08:25.900 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/1?pageNumber=1&pageSize=10 - null null
2025-03-23 18:08:25.907 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:08:25.911 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:08:25.917 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:08:25.918 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:08:25.932 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:08:25.935 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:08:25.936 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 23.1321ms
2025-03-23 18:08:25.941 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:08:25.942 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/1?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 41.9553ms
2025-03-23 18:08:29.977 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - null null
2025-03-23 18:08:29.980 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:08:29.981 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:08:29.986 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:08:29.989 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:08:29.990 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 7.0749ms
2025-03-23 18:08:29.991 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:08:29.992 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 15.5818ms
2025-03-23 18:10:35.427 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - null null
2025-03-23 18:10:35.434 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:35.435 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:10:35.450 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:10:35.453 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:10:35.454 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 16.5177ms
2025-03-23 18:10:35.455 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:35.457 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 29.993ms
2025-03-23 18:10:42.292 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - null null
2025-03-23 18:10:42.295 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:42.296 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:10:42.304 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:10:42.309 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:10:42.310 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 10.2198ms
2025-03-23 18:10:42.312 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:42.313 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 21.2774ms
2025-03-23 18:10:43.046 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - null null
2025-03-23 18:10:43.049 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:43.051 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:10:43.056 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:10:43.059 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:10:43.060 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 7.1128ms
2025-03-23 18:10:43.061 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:43.062 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 15.9854ms
2025-03-23 18:10:43.610 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - null null
2025-03-23 18:10:43.612 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:43.614 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:10:43.618 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:10:43.621 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:10:43.622 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 6.8607ms
2025-03-23 18:10:43.623 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:43.624 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/10?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 14.7887ms
2025-03-23 18:10:51.941 +04:00  INF  Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:10:51.990 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:10:52.012 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:10:52.065 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:10:52.076 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:10:52.080 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:10:52.085 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:10:52.094 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:10:52.098 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:10:52.336 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.344 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.348 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.363 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.367 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.369 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.420 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:10:52.478 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:10:52.497 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.523 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:10:52.537 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:10:52.587 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:10:52.640 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:10:52.804 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:10:52.806 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:10:52.923 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:10:52.924 +04:00  INF  Hosting environment: Development
2025-03-23 18:10:52.925 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:10:53.058 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:10:53.279 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 229.5777ms
2025-03-23 18:10:53.311 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:10:53.315 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:10:53.331 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 15.9396ms
2025-03-23 18:10:53.373 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 62.4277ms
2025-03-23 18:10:53.562 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:10:53.601 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.1019ms
2025-03-23 18:10:59.123 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/55?pageNumber=1&pageSize=10 - null null
2025-03-23 18:10:59.140 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:10:59.164 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:10:59.283 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:10:59.359 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 188.9369ms
2025-03-23 18:10:59.363 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:11:01.078 +04:00  INF  NotFoundException: Company with this specifications was not fund
2025-03-23 18:11:01.152 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/55?pageNumber=1&pageSize=10 - 404 null application/json 2028.8259ms
2025-03-23 18:11:07.268 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/company/2?pageNumber=1&pageSize=10 - null null
2025-03-23 18:11:07.274 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:11:07.276 +04:00  INF  Route matched with {action = "GetCompanyOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetCompanyOffersAsync(Int32, Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:11:07.326 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:11:07.350 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:11:07.352 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:11:07.401 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__companyId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [c].[Id], [c].[Name]
FROM (
    SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[CompanyId] = @__companyId_0
    ORDER BY (SELECT 1)
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [p0]
LEFT JOIN [Categories] AS [c] ON [p0].[CategoryId] = [c].[Id]
2025-03-23 18:11:07.487 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:11:07.508 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API) in 229.3206ms
2025-03-23 18:11:07.510 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetCompanyOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:11:07.512 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/company/2?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 243.5316ms
2025-03-23 18:12:38.737 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:12:38.751 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Company)
2025-03-23 18:12:38.755 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-23 18:12:38.756 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 401 0 null 19.563ms
2025-03-23 18:12:57.042 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:12:57.047 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:12:57.053 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:12:57.109 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:12:57.279 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:12:57.281 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 225.8387ms
2025-03-23 18:12:57.282 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:12:57.284 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 241.7407ms
2025-03-23 18:13:07.193 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:13:07.232 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:13:07.237 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:13:07.281 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 18:13:07.299 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 58.1403ms
2025-03-23 18:13:07.302 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:13:07.303 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/problem+json; charset=utf-8 110.1755ms
2025-03-23 18:13:38.639 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 150
2025-03-23 18:13:38.649 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:13:38.651 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:13:38.711 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 58.3997ms
2025-03-23 18:13:38.714 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:13:40.940 +04:00  WRN  ArgumentException: Value cannot be null. (Parameter 's')
2025-03-23 18:13:40.942 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/json 2302.9515ms
2025-03-23 18:13:41.996 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:13:42.021 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 25.2994ms
2025-03-23 18:13:42.062 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:13:42.071 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:13:42.079 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 16.3073ms
2025-03-23 18:13:42.098 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 36.0623ms
2025-03-23 18:13:42.271 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:13:42.298 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 27.6103ms
2025-03-23 18:26:56.334 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:26:56.341 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:26:56.345 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:26:56.378 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:26:56.509 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:26:56.511 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 163.3156ms
2025-03-23 18:26:56.512 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:26:56.513 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 179.6425ms
2025-03-23 18:27:12.645 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:27:12.649 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:27:12.657 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:27:12.663 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 18:27:12.669 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 10.1738ms
2025-03-23 18:27:12.671 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:27:12.672 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/problem+json; charset=utf-8 27.4481ms
2025-03-23 18:27:48.927 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:27:48.930 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:27:48.931 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:27:48.939 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 18:27:48.941 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 3.7326ms
2025-03-23 18:27:48.943 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:27:48.945 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/problem+json; charset=utf-8 18.4077ms
2025-03-23 18:27:56.101 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:27:56.105 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:27:56.106 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:27:56.130 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 22.6711ms
2025-03-23 18:27:56.132 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:27:57.569 +04:00  WRN  ArgumentException: Value cannot be null. (Parameter 's')
2025-03-23 18:27:57.571 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/json 1470.2799ms
2025-03-23 18:28:35.909 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:28:35.916 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:28:35.917 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:28:35.941 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 22.042ms
2025-03-23 18:28:35.943 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:28:42.855 +04:00  WRN  ArgumentException: Value cannot be null. (Parameter 's')
2025-03-23 18:28:42.856 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/json 6947.9994ms
2025-03-23 18:29:20.482 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:29:20.489 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:29:20.490 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:29:20.513 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 20.19ms
2025-03-23 18:29:20.515 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:29:22.871 +04:00  WRN  ArgumentException: Value cannot be null. (Parameter 's')
2025-03-23 18:29:22.876 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/json 2395.1942ms
2025-03-23 18:29:52.363 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:29:52.372 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:29:52.373 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:29:56.105 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 3729.5153ms
2025-03-23 18:29:56.111 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:31:59.049 +04:00  WRN  ArgumentException: Value cannot be null. (Parameter 's')
2025-03-23 18:31:59.058 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/json 126695.2426ms
2025-03-23 18:32:00.105 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:32:00.118 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 13.128ms
2025-03-23 18:32:00.138 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:32:00.138 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:32:00.144 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 6.4253ms
2025-03-23 18:32:00.157 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 19.4692ms
2025-03-23 18:32:00.635 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:32:00.663 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 28.707ms
2025-03-23 18:32:21.026 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:32:21.077 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:32:21.098 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:32:21.160 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:32:21.171 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:32:21.175 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:32:21.182 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:32:21.190 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:32:21.195 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:32:21.416 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.424 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.429 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.444 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.449 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.451 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.505 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:32:21.588 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:32:21.606 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.632 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:32:21.646 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:32:21.691 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:32:21.731 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:32:21.904 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:32:21.905 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:32:22.005 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:32:22.007 +04:00  INF  Hosting environment: Development
2025-03-23 18:32:22.008 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:32:22.279 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:32:22.494 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 221.7952ms
2025-03-23 18:32:22.522 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:32:22.522 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:32:22.531 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.5395ms
2025-03-23 18:32:22.575 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.3895ms
2025-03-23 18:32:22.680 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:32:22.703 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 24.0119ms
2025-03-23 18:32:37.114 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:32:37.137 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:32:37.162 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:32:37.286 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:32:37.482 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:32:37.489 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 321.6382ms
2025-03-23 18:32:37.491 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:32:37.496 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 382.4076ms
2025-03-23 18:32:49.046 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:32:49.092 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:32:49.100 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:32:49.187 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 18:32:49.207 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 103.6181ms
2025-03-23 18:32:49.210 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:32:49.211 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 400 null application/problem+json; charset=utf-8 165.1967ms
2025-03-23 18:33:01.876 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:33:01.882 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:33:01.883 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:33:05.769 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:33:05.782 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:33:05.845 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 3960.2652ms
2025-03-23 18:33:05.848 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:33:06.772 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-23 18:33:06.843 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 404 null application/json 4968.0251ms
2025-03-23 18:33:22.067 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:33:22.072 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:33:22.073 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:33:28.603 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:33:28.609 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:33:28.756 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 18:33:28.784 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-23 18:33:28.896 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 6821.612ms
2025-03-23 18:33:28.898 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:33:30.411 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.ProductOfferService.CreateOfferAsync(ProductOfferRequestModel offer, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 84
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync(ProductOfferRequestModel offer, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 56
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:33:30.432 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 500 null application/json 8366.4096ms
2025-03-23 18:34:03.402 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:34:03.407 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:34:03.409 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:34:05.875 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:34:05.879 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:34:05.885 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 18:34:05.891 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-23 18:34:06.002 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 2591.3299ms
2025-03-23 18:34:06.004 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:34:07.456 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.ProductOfferService.CreateOfferAsync(ProductOfferRequestModel offer, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 84
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync(ProductOfferRequestModel offer, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 56
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:34:07.468 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 500 null application/json 4066.5766ms
2025-03-23 18:34:09.824 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:34:09.827 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:34:09.830 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:34:12.113 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:34:12.119 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:34:12.128 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 18:34:12.134 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-23 18:34:12.264 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 2431.4633ms
2025-03-23 18:34:12.266 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:35:52.377 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.ProductOfferService.CreateOfferAsync(ProductOfferRequestModel offer, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 84
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync(ProductOfferRequestModel offer, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 56
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:35:52.404 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 500 null application/json 102579.7051ms
2025-03-23 18:35:56.709 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:35:56.712 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:35:56.714 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:36:09.076 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:36:13.968 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:37:27.204 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 18:37:27.210 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-23 18:37:27.338 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 90622.0945ms
2025-03-23 18:37:27.339 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:38:44.391 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ProductOffers_Users_CompanyId". The conflict occurred in database "DiscountPlatform", table "dbo.Users", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:293c8eb9-916d-4209-901c-fa16c8fd85e0
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.ProductOfferService.CreateOfferAsync(ProductOfferRequestModel offer, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 84
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync(ProductOfferRequestModel offer, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 56
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:38:44.435 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 500 null application/json 167726.529ms
2025-03-23 18:38:51.624 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:38:51.627 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:38:51.629 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:38:52.938 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:38:52.943 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:38:52.983 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 1352.7251ms
2025-03-23 18:38:52.985 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:38:53.994 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-23 18:38:53.995 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 404 null application/json 2371.7689ms
2025-03-23 18:39:01.506 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 147
2025-03-23 18:39:01.509 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:39:01.510 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:39:06.409 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:39:06.950 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.279 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:40:08.327 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:40:08.349 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:40:08.406 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:40:08.416 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:40:08.420 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:40:08.426 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:40:08.435 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:40:08.438 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:40:08.650 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.658 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.662 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.676 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.681 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.684 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.734 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:40:08.788 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:40:08.808 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.835 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:40:08.849 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:40:08.908 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:08.952 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:40:09.139 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:40:09.140 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:40:09.243 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:40:09.245 +04:00  INF  Hosting environment: Development
2025-03-23 18:40:09.246 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:40:09.597 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:40:09.841 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 250.3616ms
2025-03-23 18:40:09.869 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:40:09.873 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:40:09.878 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.7588ms
2025-03-23 18:40:09.914 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.394ms
2025-03-23 18:40:10.081 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:40:10.101 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 20.5057ms
2025-03-23 18:40:21.708 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:40:21.723 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:40:21.748 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:40:21.871 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:40:22.059 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:40:22.065 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 311.3789ms
2025-03-23 18:40:22.067 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:40:22.071 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 363.4738ms
2025-03-23 18:40:51.323 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 149
2025-03-23 18:40:51.363 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:40:51.371 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:40:53.453 +04:00  INF  Executed DbCommand (51ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 18:40:53.472 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:40:53.642 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 18:40:53.670 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel'.
2025-03-23 18:40:53.680 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 2306.0278ms
2025-03-23 18:40:53.683 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:40:53.685 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 200 null application/json; charset=utf-8 2362.098ms
2025-03-23 18:41:15.255 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/ProductOffers/delete-offer?id=4 - null null
2025-03-23 18:41:15.261 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.DeleteOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:41:15.265 +04:00  INF  Route matched with {action = "DeleteOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task DeleteOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:41:15.291 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 18:41:15.347 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.DeleteOfferAsync (offers.itacademy.ge.API) in 80.0248ms
2025-03-23 18:41:15.350 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.DeleteOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:41:16.407 +04:00  INF  NotFoundException: product was not found with this specifications
2025-03-23 18:41:16.475 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/ProductOffers/delete-offer?id=4 - 404 null application/json 1220.2775ms
2025-03-23 18:41:22.778 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/ProductOffers/delete-offer?id=7 - null null
2025-03-23 18:41:22.784 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.DeleteOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:41:22.786 +04:00  INF  Route matched with {action = "DeleteOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task DeleteOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:41:22.795 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 18:41:22.811 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [ProductOffers]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-23 18:41:22.816 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.DeleteOfferAsync (offers.itacademy.ge.API) in 28.7887ms
2025-03-23 18:41:22.818 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.DeleteOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:41:22.819 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/ProductOffers/delete-offer?id=7 - 200 0 null 40.6862ms
2025-03-23 18:41:53.526 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/update-offer?productOfferId=2 - application/json 150
2025-03-23 18:41:53.532 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.UpdateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:41:53.536 +04:00  INF  Route matched with {action = "UpdateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] UpdateOfferAsync(Int32, offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:41:53.547 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-23 18:41:53.565 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.UpdateOfferAsync (offers.itacademy.ge.API) in 26.4435ms
2025-03-23 18:41:53.567 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.UpdateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:41:53.568 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/update-offer?productOfferId=2 - 400 null application/problem+json; charset=utf-8 43.4639ms
2025-03-23 18:42:00.009 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/update-offer?productOfferId=2 - application/json 150
2025-03-23 18:42:00.015 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.UpdateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:42:00.016 +04:00  INF  Route matched with {action = "UpdateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] UpdateOfferAsync(Int32, offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:42:00.026 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 18:42:00.035 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__updatedOffer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__updatedOffer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:42:00.054 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-23 18:42:00.057 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel'.
2025-03-23 18:42:00.060 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.UpdateOfferAsync (offers.itacademy.ge.API) in 41.7731ms
2025-03-23 18:42:00.061 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.UpdateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:42:00.063 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/update-offer?productOfferId=2 - 200 null application/json; charset=utf-8 54.445ms
2025-03-23 18:45:27.131 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:45:27.176 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:45:27.200 +04:00  INF  Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:45:27.258 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:45:27.267 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:45:27.271 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:45:27.278 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:45:27.286 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:45:27.290 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:45:27.516 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.522 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.525 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.540 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.545 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.547 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.598 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:45:27.649 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:45:27.667 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.781 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 18:45:27.807 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:45:27.820 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:45:27.837 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:45:27.866 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:45:28.042 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:45:28.043 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:45:28.147 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:45:28.149 +04:00  INF  Hosting environment: Development
2025-03-23 18:45:28.150 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:45:28.644 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:45:28.878 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 240.4763ms
2025-03-23 18:45:28.911 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:45:28.911 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:45:28.930 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 19.3947ms
2025-03-23 18:45:28.955 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.9039ms
2025-03-23 18:45:29.180 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:45:29.206 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 26.1489ms
2025-03-23 18:45:40.572 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:45:40.589 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:45:40.614 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:45:40.741 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:45:40.935 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:45:40.943 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 322.4136ms
2025-03-23 18:45:40.946 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:45:40.950 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 377.9765ms
2025-03-23 18:45:57.421 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/20/cancel - null 0
2025-03-23 18:45:57.459 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:45:57.467 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:45:57.644 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 173.763ms
2025-03-23 18:45:57.646 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:46:01.654 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: The LINQ expression 'DbSet<ProductOffer>()
    .Where(p => p.Id == __offerId_0 && p.CompanyId == __companyId_1 && (int)p.Status == 0 && (DateTime.UtcNow - p.CreationTime).TotalMinutes <= 10)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ExecuteAsync[TSource,TResult](MethodInfo operatorMethodInfo, IQueryable`1 source, LambdaExpression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.FirstOrDefaultAsync[TSource](IQueryable`1 source, Expression`1 predicate, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.ProductOffers.ProductOfferRepository.GetCancellableOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\ProductOffers\ProductOfferRepository.cs:line 54
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 136
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method391(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:46:01.742 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/20/cancel - 500 null application/json 4320.3163ms
2025-03-23 18:49:50.901 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:49:50.949 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:49:50.970 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:49:51.025 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:49:51.037 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:49:51.040 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:49:51.047 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:49:51.055 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:49:51.059 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:49:51.289 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.297 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.300 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.315 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.320 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.323 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.377 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:49:51.429 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:49:51.448 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.477 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:49:51.491 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:49:51.532 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:49:51.571 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:49:51.735 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:49:51.737 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:49:51.859 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:49:51.860 +04:00  INF  Hosting environment: Development
2025-03-23 18:49:51.861 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:49:52.039 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:49:52.258 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 227.3759ms
2025-03-23 18:49:52.289 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:49:52.289 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:49:52.298 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.4379ms
2025-03-23 18:49:52.333 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.1527ms
2025-03-23 18:49:52.604 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:49:52.650 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.2746ms
2025-03-23 18:50:07.280 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:50:07.297 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:50:07.321 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:50:07.447 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:50:07.638 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:50:07.644 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 317.8019ms
2025-03-23 18:50:07.646 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:50:07.651 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 371.1773ms
2025-03-23 18:50:21.984 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/all?pageNumber=1&pageSize=10 - null null
2025-03-23 18:50:22.027 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:50:22.034 +04:00  INF  Route matched with {action = "GetAllOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetAllOffersAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:50:22.095 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:50:22.098 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-23 18:50:22.111 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-23 18:50:22.180 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-23 18:50:22.193 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllOffersAsync (offers.itacademy.ge.API) in 155.7611ms
2025-03-23 18:50:22.196 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetAllOffersAsync (offers.itacademy.ge.API)'
2025-03-23 18:50:22.198 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/all?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 213.507ms
2025-03-23 18:50:31.171 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/5/cancel - null 0
2025-03-23 18:50:31.177 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:50:31.184 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:50:31.282 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:50:31.342 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 156.465ms
2025-03-23 18:50:31.344 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:50:32.617 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is not cancellable
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 138
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method396(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:50:32.698 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/5/cancel - 500 null application/json 1527.9779ms
2025-03-23 18:52:25.655 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/2/cancel - null 0
2025-03-23 18:52:25.664 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:52:25.665 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:52:25.682 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:52:25.745 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 77.1892ms
2025-03-23 18:52:25.746 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:52:27.346 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is not cancellable
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 138
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method396(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:52:27.354 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/2/cancel - 500 null application/json 1699.02ms
2025-03-23 18:52:35.575 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - null 0
2025-03-23 18:52:35.579 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:52:35.580 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:52:35.590 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:52:35.655 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-23 18:52:35.668 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-23 18:52:35.671 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 89.2032ms
2025-03-23 18:52:35.673 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:52:35.674 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - 200 null application/json; charset=utf-8 99.6806ms
2025-03-23 18:52:54.379 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - null 0
2025-03-23 18:52:54.382 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:52:54.383 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:52:54.388 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:52:54.429 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 43.7454ms
2025-03-23 18:52:54.431 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:52:55.854 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is not cancellable
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 138
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method396(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:52:55.861 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - 500 null application/json 1482.2725ms
2025-03-23 18:53:05.492 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/6/cancel - null 0
2025-03-23 18:53:05.495 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:53:05.496 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:53:05.513 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:53:05.570 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 71.8179ms
2025-03-23 18:53:05.572 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:53:06.877 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is not cancellable
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 138
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method396(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 18:53:06.885 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/6/cancel - 500 null application/json 1393.0286ms
2025-03-23 18:57:15.658 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:57:15.707 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 18:57:15.730 +04:00  INF  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 18:57:15.791 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 18:57:15.802 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 18:57:15.806 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 18:57:15.813 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 18:57:15.822 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 18:57:15.826 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 18:57:16.065 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.073 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.076 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.093 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.097 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.099 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.153 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 18:57:16.209 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 18:57:16.226 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.254 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 18:57:16.267 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 18:57:16.317 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 18:57:16.370 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 18:57:16.552 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 18:57:16.554 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 18:57:16.665 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 18:57:16.667 +04:00  INF  Hosting environment: Development
2025-03-23 18:57:16.668 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 18:57:17.239 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 18:57:17.466 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 237.1052ms
2025-03-23 18:57:17.501 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 18:57:17.506 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 18:57:17.522 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 16.2948ms
2025-03-23 18:57:17.551 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.5294ms
2025-03-23 18:57:17.719 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 18:57:17.747 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 28.2383ms
2025-03-23 18:57:51.196 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 18:57:51.218 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:57:51.241 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 18:57:51.373 +04:00  INF  Executed DbCommand (26ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 18:57:51.575 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 18:57:51.582 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 333.4041ms
2025-03-23 18:57:51.584 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 18:57:51.590 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 393.1675ms
2025-03-23 18:58:03.365 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/5/cancel - null 0
2025-03-23 18:58:03.404 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:58:03.412 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:58:03.564 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:58:07.830 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 4414.86ms
2025-03-23 18:58:07.832 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:58:09.519 +04:00  INF  NotFoundException: Offer not found
2025-03-23 18:58:09.591 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/5/cancel - 404 null application/json 6226.7858ms
2025-03-23 18:58:16.784 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - null 0
2025-03-23 18:58:16.792 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:58:16.793 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 18:58:16.802 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1 AND [p].[Status] = 0
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 18:58:19.990 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 3194.516ms
2025-03-23 18:58:19.992 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 18:58:21.987 +04:00  INF  NotFoundException: Offer not found
2025-03-23 18:58:21.989 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - 404 null application/json 5204.6863ms
2025-03-23 19:02:05.939 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 19:02:05.993 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 19:02:06.018 +04:00  INF  Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 19:02:06.083 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 19:02:06.094 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 19:02:06.097 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 19:02:06.104 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 19:02:06.113 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 19:02:06.118 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 19:02:06.351 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.359 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.363 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.380 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.384 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.387 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.444 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 19:02:06.501 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 19:02:06.520 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.547 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 19:02:06.560 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 19:02:06.602 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:02:06.646 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 19:02:06.812 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 19:02:06.814 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 19:02:06.919 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 19:02:06.921 +04:00  INF  Hosting environment: Development
2025-03-23 19:02:06.922 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 19:02:07.285 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 19:02:07.507 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 228.9308ms
2025-03-23 19:02:07.546 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 19:02:07.546 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 19:02:07.555 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.6291ms
2025-03-23 19:02:07.588 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.1142ms
2025-03-23 19:02:07.757 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 19:02:07.781 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 23.5466ms
2025-03-23 19:02:16.916 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 19:02:16.932 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 19:02:16.954 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 19:02:17.079 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 19:02:17.271 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 19:02:17.278 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 317.1244ms
2025-03-23 19:02:17.280 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 19:02:17.284 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 368.3471ms
2025-03-23 19:02:28.846 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/1/cancel - null 0
2025-03-23 19:02:28.884 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:02:28.891 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 19:02:29.048 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 19:02:31.914 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 3019.1834ms
2025-03-23 19:02:31.917 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:02:32.897 +04:00  INF  NotFoundException: Offer not found
2025-03-23 19:02:32.969 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/1/cancel - 404 null application/json 4123.1386ms
2025-03-23 19:02:40.382 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/2/cancel - null 0
2025-03-23 19:02:40.389 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:02:40.391 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 19:02:40.399 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 19:02:43.170 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 2776.9149ms
2025-03-23 19:02:43.172 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:02:43.819 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is not cancellable
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 146
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 19:02:43.834 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/2/cancel - 500 null application/json 3452.339ms
2025-03-23 19:03:32.328 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - null 0
2025-03-23 19:03:32.333 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:03:32.335 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 19:03:32.367 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 19:03:32.425 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 88.5185ms
2025-03-23 19:03:32.427 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:03:35.029 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is already cancelled
   at offers.itacademy.ge.Application.Services.ProductOfferService.CancelOfferAsync(Int32 offerId, Int32 companyId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\ProductOfferService.cs:line 142
   at offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync(Int32 offerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\ProductOffersController.cs:line 80
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 19:03:35.037 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/8/cancel - 500 null application/json 2708.7292ms
2025-03-23 19:03:53.797 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/ProductOffers - application/json 150
2025-03-23 19:03:53.801 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:03:53.806 +04:00  INF  Route matched with {action = "CreateOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel] CreateOfferAsync(offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 19:03:55.698 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 19:03:55.710 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Id] = @__offer_CategoryId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 19:03:55.850 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-23 19:03:55.878 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel'.
2025-03-23 19:03:55.889 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API) in 2081.0422ms
2025-03-23 19:03:55.891 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CreateOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:03:55.892 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/ProductOffers - 200 null application/json; charset=utf-8 2095.4296ms
2025-03-23 19:04:07.035 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/ProductOffers/9/cancel - null 0
2025-03-23 19:04:07.038 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:04:07.040 +04:00  INF  Route matched with {action = "CancelOffer", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelOfferAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-23 19:04:07.059 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__offerId_0='?' (DbType = Int32), @__companyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p1].[Id], [p1].[CategoryId], [p1].[CompanyId], [p1].[CreationTime], [p1].[Description], [p1].[ExpirationTime], [p1].[Name], [p1].[Price], [p1].[Quantity], [p1].[Status], [s].[Id], [s].[CustomerId], [s].[ProductOfferId], [s].[PurchaseDate], [s].[Quantity], [s].[Id0], [s].[Email], [s].[Password], [s].[Role], [s].[UserName], [s].[Balance]
FROM (
    SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
    FROM [ProductOffers] AS [p]
    WHERE [p].[Id] = @__offerId_0 AND [p].[CompanyId] = @__companyId_1
) AS [p1]
LEFT JOIN (
    SELECT [p0].[Id], [p0].[CustomerId], [p0].[ProductOfferId], [p0].[PurchaseDate], [p0].[Quantity], [u0].[Id] AS [Id0], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
    FROM [Purchases] AS [p0]
    INNER JOIN (
        SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
        FROM [Users] AS [u]
        WHERE [u].[Role] = 2
    ) AS [u0] ON [p0].[CustomerId] = [u0].[Id]
) AS [s] ON [p1].[Id] = [s].[ProductOfferId]
ORDER BY [p1].[Id], [s].[Id]
2025-03-23 19:04:07.071 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-23 19:04:07.074 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-23 19:04:07.078 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API) in 37.0876ms
2025-03-23 19:04:07.080 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.CancelOfferAsync (offers.itacademy.ge.API)'
2025-03-23 19:04:07.082 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/ProductOffers/9/cancel - 200 null application/json; charset=utf-8 46.6749ms
2025-03-23 21:42:07.859 +04:00  FTL  Application failed to start.System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'DiscountPlatformContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Migrate(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 30
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 24
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-23 21:42:26.244 +04:00  FTL  Application failed to start.System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'DiscountPlatformContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Migrate(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 30
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 24
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-23 21:43:05.290 +04:00  FTL  Application failed to start.System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'DiscountPlatformContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Migrate(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 30
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 24
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-23 21:45:04.497 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 21:45:04.541 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 21:45:04.563 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 21:45:04.620 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 21:45:04.630 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 21:45:04.635 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 21:45:04.647 +04:00  INF  Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 21:45:04.662 +04:00  INF  Applying migration '20250323174455_addPurchaseStatus'.
2025-03-23 21:45:04.690 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Purchases] ADD [Status] int NOT NULL DEFAULT 0;
2025-03-23 21:45:04.693 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250323174455_addPurchaseStatus', N'9.0.3');
2025-03-23 21:45:04.700 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 21:45:04.947 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:04.956 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:04.960 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:04.977 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:04.982 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:04.985 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:05.043 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 21:45:05.107 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 21:45:05.125 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:05.156 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 21:45:05.170 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 21:45:05.218 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:45:05.261 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 21:45:05.540 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 21:45:05.541 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 21:45:05.668 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 21:45:05.669 +04:00  INF  Hosting environment: Development
2025-03-23 21:45:05.670 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 21:45:05.897 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 21:45:06.168 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 278.4832ms
2025-03-23 21:45:06.197 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 21:45:06.197 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 21:45:06.208 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 11.2989ms
2025-03-23 21:45:06.251 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.9742ms
2025-03-23 21:45:06.547 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 21:45:06.578 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.538ms
2025-03-23 21:45:17.985 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-23 21:45:18.017 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:45:18.052 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 21:45:18.192 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 21:45:18.396 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 21:45:18.402 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 343.288ms
2025-03-23 21:45:18.405 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:45:18.409 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 424.1697ms
2025-03-23 21:45:57.600 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - null 0
2025-03-23 21:45:57.658 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Customer)
2025-03-23 21:45:57.661 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-23 21:45:57.663 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - 403 0 null 63.0704ms
2025-03-23 21:46:11.080 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-23 21:46:11.087 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:46:11.089 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 21:46:11.152 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 21:46:11.285 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 21:46:11.288 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 196.932ms
2025-03-23 21:46:11.290 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:46:11.291 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 211.1381ms
2025-03-23 21:46:21.258 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - null 0
2025-03-23 21:46:21.264 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:46:21.270 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 21:46:21.275 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 2.8012ms
2025-03-23 21:46:21.277 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:47:15.794 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 21:47:15.843 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 21:47:15.864 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 21:47:15.920 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 21:47:15.930 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 21:47:15.932 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 21:47:15.939 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 21:47:15.948 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 21:47:15.952 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 21:47:16.176 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.183 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.187 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.203 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.207 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.210 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.258 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 21:47:16.311 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 21:47:16.330 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.355 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 21:47:16.369 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 21:47:16.413 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:47:16.454 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 21:47:16.626 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 21:47:16.627 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 21:47:16.734 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 21:47:16.736 +04:00  INF  Hosting environment: Development
2025-03-23 21:47:16.737 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 21:47:17.236 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 21:47:17.451 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 221.2179ms
2025-03-23 21:47:17.486 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 21:47:17.486 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 21:47:17.506 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 19.8715ms
2025-03-23 21:47:17.535 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.8753ms
2025-03-23 21:47:17.813 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 21:47:17.854 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.906ms
2025-03-23 21:47:29.979 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-23 21:47:29.995 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:47:30.019 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 21:47:30.143 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 21:47:30.336 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 21:47:30.342 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 317.5557ms
2025-03-23 21:47:30.345 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:47:30.349 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 370.4165ms
2025-03-23 21:47:44.255 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - null 0
2025-03-23 21:47:44.294 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:47:44.300 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 21:47:44.423 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:47:44.436 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 21:47:44.441 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:47:44.572 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p22='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (Size = 255), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p28='?' (DbType = Int32), @p23='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p24='?' (Size = 100), @p25='?' (Size = 4000), @p26='?' (DbType = Int32), @p27='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p10, @p11, @p12, @p13, @p14);
UPDATE [Users] SET [Balance] = @p15, [Email] = @p16, [ImageUrl] = @p17, [IsActivated] = @p18, [Password] = @p19, [Role] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [Balance] = @p23, [Email] = @p24, [Password] = @p25, [Role] = @p26, [UserName] = @p27
OUTPUT 1
WHERE [Id] = @p28;
2025-03-23 21:47:44.658 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel'.
2025-03-23 21:47:44.669 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 366.7649ms
2025-03-23 21:47:44.671 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:47:44.673 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - 200 null application/json; charset=utf-8 418.7296ms
2025-03-23 21:48:02.504 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - null 0
2025-03-23 21:48:02.510 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:48:02.512 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 21:48:02.521 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:48:02.525 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 21:48:02.529 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:48:02.541 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p22='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (Size = 255), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p28='?' (DbType = Int32), @p23='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p24='?' (Size = 100), @p25='?' (Size = 4000), @p26='?' (DbType = Int32), @p27='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p10, @p11, @p12, @p13, @p14);
UPDATE [Users] SET [Balance] = @p15, [Email] = @p16, [ImageUrl] = @p17, [IsActivated] = @p18, [Password] = @p19, [Role] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [Balance] = @p23, [Email] = @p24, [Password] = @p25, [Role] = @p26, [UserName] = @p27
OUTPUT 1
WHERE [Id] = @p28;
2025-03-23 21:48:02.545 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel'.
2025-03-23 21:48:02.547 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 32.7053ms
2025-03-23 21:48:02.549 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:48:02.550 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - 200 null application/json; charset=utf-8 46.2439ms
2025-03-23 21:48:22.935 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - null 0
2025-03-23 21:48:22.949 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:48:22.951 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 21:48:22.964 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:48:22.975 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 21:48:22.978 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:48:22.983 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p22='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (Size = 255), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p28='?' (DbType = Int32), @p23='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p24='?' (Size = 100), @p25='?' (Size = 4000), @p26='?' (DbType = Int32), @p27='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p10, @p11, @p12, @p13, @p14);
UPDATE [Users] SET [Balance] = @p15, [Email] = @p16, [ImageUrl] = @p17, [IsActivated] = @p18, [Password] = @p19, [Role] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [Balance] = @p23, [Email] = @p24, [Password] = @p25, [Role] = @p26, [UserName] = @p27
OUTPUT 1
WHERE [Id] = @p28;
2025-03-23 21:48:22.986 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel'.
2025-03-23 21:48:22.988 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 34.3775ms
2025-03-23 21:48:22.989 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 21:48:22.990 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=9&quantity=1 - 200 null application/json; charset=utf-8 55.0037ms
2025-03-23 21:53:25.358 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 21:53:25.416 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 21:53:25.438 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 21:53:25.497 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 21:53:25.508 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 21:53:25.513 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 21:53:25.519 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 21:53:25.529 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 21:53:25.533 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 21:53:25.754 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.763 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.767 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.783 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.788 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.790 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.837 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 21:53:25.891 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 21:53:25.910 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:25.936 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 21:53:25.949 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 21:53:26.010 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 21:53:26.050 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 21:53:26.215 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 21:53:26.216 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 21:53:26.323 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 21:53:26.325 +04:00  INF  Hosting environment: Development
2025-03-23 21:53:26.327 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 21:53:26.565 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 21:53:26.786 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 228.7097ms
2025-03-23 21:53:26.819 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 21:53:26.824 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 21:53:26.842 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 17.8032ms
2025-03-23 21:53:26.875 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.6279ms
2025-03-23 21:53:27.036 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 21:53:27.062 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.938ms
2025-03-23 21:53:39.831 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/4 - null 0
2025-03-23 21:53:39.850 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Customer)
2025-03-23 21:53:39.862 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-23 21:53:39.864 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/4 - 401 0 null 32.956ms
2025-03-23 21:53:51.194 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-23 21:53:51.202 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:53:51.229 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 21:53:51.353 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 21:53:51.556 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 21:53:51.564 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 327.9037ms
2025-03-23 21:53:51.566 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 21:53:51.570 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 375.9807ms
2025-03-23 21:53:58.261 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/4 - null 0
2025-03-23 21:53:58.294 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 21:53:58.301 +04:00  INF  Route matched with {action = "CancelPurchase", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelPurchaseAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 21:54:03.083 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status]
FROM [Purchases] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 21:54:08.618 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 21:54:45.901 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API) in 47596.2268ms
2025-03-23 21:54:45.902 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 21:54:49.063 +04:00  ERR  Unhandled exception occurred.System.NullReferenceException: Object reference not set to an instance of an object.
   at offers.itacademy.ge.Application.Services.PurchaseService.CancelPurchaseAsync(Int32 purchaseId, Int32 customerId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\PurchaseService.cs:line 80
   at offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync(Int32 purchaseId, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\PurchasesController.cs:line 43
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 21:54:49.153 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/4 - 500 null application/json 50893.3273ms
2025-03-23 22:20:26.065 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 22:20:26.116 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 22:20:26.144 +04:00  INF  Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 22:20:26.200 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 22:20:26.211 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 22:20:26.215 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 22:20:26.224 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 22:20:26.231 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 22:20:26.236 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 22:20:26.473 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.480 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.484 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.502 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.506 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.509 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.572 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 22:20:26.630 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 22:20:26.650 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.680 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 22:20:26.694 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 22:20:26.743 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:20:26.784 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 22:20:26.958 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 22:20:26.960 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 22:20:27.063 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 22:20:27.065 +04:00  INF  Hosting environment: Development
2025-03-23 22:20:27.066 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 22:20:27.476 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 22:20:27.710 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 240.4497ms
2025-03-23 22:20:27.740 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 22:20:27.746 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 22:20:27.763 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 17.7631ms
2025-03-23 22:20:27.792 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 51.8085ms
2025-03-23 22:20:27.986 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 22:20:28.011 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.078ms
2025-03-23 22:20:40.276 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-23 22:20:40.292 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 22:20:40.316 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 22:20:40.449 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 22:20:40.650 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 22:20:40.657 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 335.5803ms
2025-03-23 22:20:40.659 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 22:20:40.664 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 387.9215ms
2025-03-23 22:21:08.330 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/5 - null 0
2025-03-23 22:21:08.374 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 22:21:08.382 +04:00  INF  Route matched with {action = "CancelPurchase", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelPurchaseAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:21:16.671 +04:00  INF  Executed DbCommand (18ms) [Parameters=[@__purchaseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated]
FROM [Purchases] AS [p]
LEFT JOIN [ProductOffers] AS [p0] ON [p].[ProductOfferId] = [p0].[Id]
LEFT JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
WHERE [p].[Id] = @__purchaseId_0
2025-03-23 22:21:21.092 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:21:30.714 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API) in 22328.6854ms
2025-03-23 22:21:30.716 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 22:21:33.400 +04:00  INF  InvalidCancellationRequestException: Cancellation window in 5 minute, it is expired
2025-03-23 22:21:35.400 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/5 - 400 null application/json 27070ms
2025-03-23 22:22:04.343 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=2&quantity=5 - null 0
2025-03-23 22:22:04.358 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:22:04.370 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:22:04.398 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:22:04.411 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 22:22:04.415 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:22:04.524 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p22='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (Size = 255), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p28='?' (DbType = Int32), @p23='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p24='?' (Size = 100), @p25='?' (Size = 4000), @p26='?' (DbType = Int32), @p27='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p10, @p11, @p12, @p13, @p14);
UPDATE [Users] SET [Balance] = @p15, [Email] = @p16, [ImageUrl] = @p17, [IsActivated] = @p18, [Password] = @p19, [Role] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [Balance] = @p23, [Email] = @p24, [Password] = @p25, [Role] = @p26, [UserName] = @p27
OUTPUT 1
WHERE [Id] = @p28;
2025-03-23 22:22:04.606 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel'.
2025-03-23 22:22:04.616 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 244.2228ms
2025-03-23 22:22:04.622 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:22:04.624 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=2&quantity=5 - 200 null application/json; charset=utf-8 281.8008ms
2025-03-23 22:22:23.817 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/6 - null 0
2025-03-23 22:22:23.822 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 22:22:23.823 +04:00  INF  Route matched with {action = "CancelPurchase", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelPurchaseAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:22:25.411 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchaseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated]
FROM [Purchases] AS [p]
LEFT JOIN [ProductOffers] AS [p0] ON [p].[ProductOfferId] = [p0].[Id]
LEFT JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
WHERE [p].[Id] = @__purchaseId_0
2025-03-23 22:22:25.415 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:22:25.424 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p15='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p23='?' (DbType = Int32), @p16='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 100), @p18='?' (Size = 255), @p19='?' (DbType = Boolean), @p20='?' (Size = 4000), @p21='?' (DbType = Int32), @p22='?' (Size = 50), @p29='?' (DbType = Int32), @p24='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p25='?' (Size = 100), @p26='?' (Size = 4000), @p27='?' (DbType = Int32), @p28='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
UPDATE [Purchases] SET [CustomerId] = @p10, [ProductOfferId] = @p11, [PurchaseDate] = @p12, [Quantity] = @p13, [Status] = @p14
OUTPUT 1
WHERE [Id] = @p15;
UPDATE [Users] SET [Balance] = @p16, [Email] = @p17, [ImageUrl] = @p18, [IsActivated] = @p19, [Password] = @p20, [Role] = @p21, [UserName] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [Balance] = @p24, [Email] = @p25, [Password] = @p26, [Role] = @p27, [UserName] = @p28
OUTPUT 1
WHERE [Id] = @p29;
2025-03-23 22:22:25.429 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-23 22:22:25.432 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API) in 1607.4884ms
2025-03-23 22:22:25.434 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 22:22:25.435 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/6 - 200 null application/json; charset=utf-8 1618.213ms
2025-03-23 22:22:50.673 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=2&quantity=5 - null 0
2025-03-23 22:22:50.679 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:22:50.681 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:22:50.687 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:22:50.693 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 22:22:50.696 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:22:50.702 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p22='?' (DbType = Int32), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (Size = 255), @p18='?' (DbType = Boolean), @p19='?' (Size = 4000), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p28='?' (DbType = Int32), @p23='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p24='?' (Size = 100), @p25='?' (Size = 4000), @p26='?' (DbType = Int32), @p27='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p10, @p11, @p12, @p13, @p14);
UPDATE [Users] SET [Balance] = @p15, [Email] = @p16, [ImageUrl] = @p17, [IsActivated] = @p18, [Password] = @p19, [Role] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22;
UPDATE [Users] SET [Balance] = @p23, [Email] = @p24, [Password] = @p25, [Role] = @p26, [UserName] = @p27
OUTPUT 1
WHERE [Id] = @p28;
2025-03-23 22:22:50.706 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel'.
2025-03-23 22:22:50.708 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 25.1893ms
2025-03-23 22:22:50.709 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:22:50.710 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=2&quantity=5 - 200 null application/json; charset=utf-8 38.0847ms
2025-03-23 22:23:44.679 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=2&quantity=5 - null 0
2025-03-23 22:23:44.689 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:23:44.691 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:23:44.701 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:23:44.705 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 22:23:44.709 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:23:44.755 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 62.0474ms
2025-03-23 22:23:44.757 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:24:03.386 +04:00  INF  PurchaseException:  your balance is not enough to cover purchase expenses
2025-03-23 22:24:03.387 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=2&quantity=5 - 400 null application/json 18708.8014ms
2025-03-23 22:24:30.010 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/7 - null 0
2025-03-23 22:24:30.017 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 22:24:30.018 +04:00  INF  Route matched with {action = "CancelPurchase", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] CancelPurchaseAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:24:31.280 +04:00  INF  Executed DbCommand (11ms) [Parameters=[@__purchaseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated]
FROM [Purchases] AS [p]
LEFT JOIN [ProductOffers] AS [p0] ON [p].[ProductOfferId] = [p0].[Id]
LEFT JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
WHERE [p].[Id] = @__purchaseId_0
2025-03-23 22:24:31.284 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:24:31.295 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p15='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p23='?' (DbType = Int32), @p16='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p17='?' (Size = 100), @p18='?' (Size = 255), @p19='?' (DbType = Boolean), @p20='?' (Size = 4000), @p21='?' (DbType = Int32), @p22='?' (Size = 50), @p29='?' (DbType = Int32), @p24='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p25='?' (Size = 100), @p26='?' (Size = 4000), @p27='?' (DbType = Int32), @p28='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [ProductOffers] SET [CategoryId] = @p0, [CompanyId] = @p1, [CreationTime] = @p2, [Description] = @p3, [ExpirationTime] = @p4, [Name] = @p5, [Price] = @p6, [Quantity] = @p7, [Status] = @p8
OUTPUT 1
WHERE [Id] = @p9;
UPDATE [Purchases] SET [CustomerId] = @p10, [ProductOfferId] = @p11, [PurchaseDate] = @p12, [Quantity] = @p13, [Status] = @p14
OUTPUT 1
WHERE [Id] = @p15;
UPDATE [Users] SET [Balance] = @p16, [Email] = @p17, [ImageUrl] = @p18, [IsActivated] = @p19, [Password] = @p20, [Role] = @p21, [UserName] = @p22
OUTPUT 1
WHERE [Id] = @p23;
UPDATE [Users] SET [Balance] = @p24, [Email] = @p25, [Password] = @p26, [Role] = @p27, [UserName] = @p28
OUTPUT 1
WHERE [Id] = @p29;
2025-03-23 22:24:31.298 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-23 22:24:31.299 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API) in 1279.3484ms
2025-03-23 22:24:31.300 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.CancelPurchaseAsync (offers.itacademy.ge.API)'
2025-03-23 22:24:31.303 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Purchases/cancel-purchase/7 - 200 null application/json; charset=utf-8 1292.9921ms
2025-03-23 22:25:04.416 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=8&quantity=5 - null 0
2025-03-23 22:25:04.423 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:25:04.425 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:25:04.430 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:25:04.438 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 22:25:04.442 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:25:04.483 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 56.9716ms
2025-03-23 22:25:04.485 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:27:35.164 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 22:27:35.218 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-23 22:27:35.239 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-23 22:27:35.300 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-23 22:27:35.309 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-23 22:27:35.312 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-23 22:27:35.318 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-23 22:27:35.327 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-23 22:27:35.332 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-23 22:27:35.541 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.549 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.553 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.568 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.573 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.575 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.626 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-23 22:27:35.680 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-23 22:27:35.699 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.725 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-23 22:27:35.739 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-23 22:27:35.802 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-23 22:27:35.841 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-23 22:27:36.012 +04:00  INF  Now listening on: https://localhost:7230
2025-03-23 22:27:36.013 +04:00  INF  Now listening on: http://localhost:5229
2025-03-23 22:27:36.144 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-23 22:27:36.145 +04:00  INF  Hosting environment: Development
2025-03-23 22:27:36.146 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-23 22:27:36.271 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-23 22:27:36.519 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 255.9169ms
2025-03-23 22:27:36.548 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-23 22:27:36.548 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-23 22:27:36.568 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 19.4399ms
2025-03-23 22:27:36.595 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 46.9413ms
2025-03-23 22:27:36.778 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-23 22:27:36.806 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 28.8072ms
2025-03-23 22:27:46.358 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-23 22:27:46.375 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 22:27:46.400 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-23 22:27:46.520 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-23 22:27:46.719 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-23 22:27:46.726 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 320.2585ms
2025-03-23 22:27:46.728 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-23 22:27:46.732 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 374.8611ms
2025-03-23 22:28:20.174 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=8&quantity=1 - null 0
2025-03-23 22:28:20.213 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:28:20.219 +04:00  INF  Route matched with {action = "PurchaseOffer", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel] PurchaseOfferAsync(Int32, Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-23 22:28:20.313 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-23 22:28:20.325 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-23 22:28:20.384 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API) in 161.7202ms
2025-03-23 22:28:20.387 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync (offers.itacademy.ge.API)'
2025-03-23 22:28:21.992 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Offer is not valid
   at offers.itacademy.ge.Application.Services.PurchaseService.PurchaseOfferAsync(Int32 customerId, Int32 offerId, Int32 quantity, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\PurchaseService.cs:line 36
   at offers.itacademy.ge.API.Controllers.PurchasesController.PurchaseOfferAsync(Int32 offerId, Int32 quantity, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\PurchasesController.cs:line 32
   at lambda_method376(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-23 22:28:22.075 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Purchases/buy?offerId=8&quantity=1 - 500 null application/json 1901.4333ms
