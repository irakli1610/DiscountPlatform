2025-03-22 13:32:13.627 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 13:32:14.104 +04:00  INF  Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:32:14.117 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 13:32:14.138 +04:00  INF  Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 13:32:14.210 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 13:32:14.220 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:32:14.224 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 13:32:14.238 +04:00  INF  Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 13:32:14.248 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 13:32:14.252 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 13:32:14.473 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.481 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.485 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.495 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.499 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.501 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.553 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 13:32:14.607 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 13:32:14.623 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.629 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.668 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 13:32:14.677 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 13:32:14.713 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.718 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:32:14.753 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 13:32:14.923 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 13:32:14.924 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 13:32:15.033 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 13:32:15.034 +04:00  INF  Hosting environment: Development
2025-03-22 13:32:15.036 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 13:32:15.355 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 13:32:15.590 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 235.72ms
2025-03-22 13:32:15.621 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 13:32:15.625 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 13:32:15.638 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 12.5181ms
2025-03-22 13:32:15.677 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.93ms
2025-03-22 13:32:15.872 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 13:32:15.902 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.1952ms
2025-03-22 13:32:20.549 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/51 - null null
2025-03-22 13:32:20.568 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:32:20.594 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 13:32:22.223 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 13:32:22.312 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 1712.1922ms
2025-03-22 13:32:22.322 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:32:22.446 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 13:32:22.530 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/51 - 404 null application/json 1981.2844ms
2025-03-22 13:34:06.927 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 13:34:07.399 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:34:07.411 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 13:34:07.432 +04:00  INF  Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 13:34:07.494 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 13:34:07.504 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:34:07.508 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 13:34:07.517 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 13:34:07.527 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 13:34:07.532 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 13:34:07.759 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.766 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.771 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.780 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.784 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.787 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.849 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 13:34:07.909 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 13:34:07.927 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.931 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:07.955 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 13:34:07.965 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 13:34:08.007 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:08.011 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:34:08.054 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 13:34:08.240 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 13:34:08.242 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 13:34:08.353 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 13:34:08.355 +04:00  INF  Hosting environment: Development
2025-03-22 13:34:08.356 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 13:34:08.610 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 13:34:08.839 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 237.0507ms
2025-03-22 13:34:08.870 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 13:34:08.870 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 13:34:08.882 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 13.0506ms
2025-03-22 13:34:08.943 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 73.6302ms
2025-03-22 13:34:09.047 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 13:34:09.083 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 36.4644ms
2025-03-22 13:34:14.672 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/9845 - null null
2025-03-22 13:34:14.698 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:34:14.728 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 13:34:16.327 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 13:34:16.407 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 1672.39ms
2025-03-22 13:34:16.410 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:34:16.520 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 13:34:16.607 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/9845 - 404 null application/json 1935.7286ms
2025-03-22 13:37:20.687 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 13:37:21.160 +04:00  INF  Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:37:21.173 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 13:37:21.194 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 13:37:21.260 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 13:37:21.270 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:37:21.274 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 13:37:21.284 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 13:37:21.293 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 13:37:21.297 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 13:37:21.537 +04:00  INF  Executed DbCommand (23ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.546 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.550 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.559 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.563 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.566 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.619 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 13:37:21.672 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 13:37:21.689 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.693 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.731 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 13:37:21.743 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 13:37:21.796 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.800 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:37:21.845 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 13:37:22.023 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 13:37:22.025 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 13:37:22.129 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 13:37:22.130 +04:00  INF  Hosting environment: Development
2025-03-22 13:37:22.132 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 13:37:22.552 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 13:37:22.787 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 241.553ms
2025-03-22 13:37:22.817 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 13:37:22.823 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 13:37:22.835 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 18.3415ms
2025-03-22 13:37:22.860 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.7523ms
2025-03-22 13:37:23.030 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 13:37:23.051 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 21.8329ms
2025-03-22 13:37:27.163 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/54 - null null
2025-03-22 13:37:27.180 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:37:27.206 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 13:37:28.870 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 13:37:28.948 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 1736.8571ms
2025-03-22 13:37:28.951 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:37:29.064 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 13:37:29.150 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/54 - 404 null application/json 1987.8413ms
2025-03-22 13:44:38.398 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 13:44:38.900 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:44:38.914 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 13:44:38.934 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 13:44:38.997 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 13:44:39.007 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 13:44:39.011 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 13:44:39.020 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 13:44:39.030 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 13:44:39.034 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 13:44:39.265 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.271 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.275 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.283 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.287 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.290 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.342 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 13:44:39.415 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 13:44:39.429 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.434 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.460 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 13:44:39.470 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 13:44:39.507 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.511 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 13:44:39.548 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 13:44:39.713 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 13:44:39.716 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 13:44:39.842 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 13:44:39.843 +04:00  INF  Hosting environment: Development
2025-03-22 13:44:39.844 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 13:44:39.993 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 13:44:40.219 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 233.8478ms
2025-03-22 13:44:40.241 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 13:44:40.241 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 13:44:40.253 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 12.0456ms
2025-03-22 13:44:40.291 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 50.8176ms
2025-03-22 13:44:40.560 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 13:44:40.590 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.3671ms
2025-03-22 13:44:45.027 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/123 - null null
2025-03-22 13:44:45.045 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:44:45.067 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 13:44:49.220 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 13:44:49.294 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 4220.5975ms
2025-03-22 13:44:49.297 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:44:49.396 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 13:44:49.473 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/123 - 404 null application/json 4446.7614ms
2025-03-22 13:45:09.713 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/123 - null null
2025-03-22 13:45:09.718 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:45:09.720 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 13:45:11.945 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 13:45:12.002 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 2279.8985ms
2025-03-22 13:45:12.004 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:45:12.058 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 13:45:12.060 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/123 - 404 null application/json 2346.5577ms
2025-03-22 13:45:12.971 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 13:45:12.983 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 12.0447ms
2025-03-22 13:45:13.024 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 13:45:13.027 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 13:45:13.033 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 6.4906ms
2025-03-22 13:45:13.053 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.3313ms
2025-03-22 13:45:13.232 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 13:45:13.254 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 22.3556ms
2025-03-22 13:45:23.964 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/845 - null null
2025-03-22 13:45:23.969 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:45:23.975 +04:00  INF  Route matched with {action = "GetCategoryById", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] GetCategoryByIdAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 13:45:25.396 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 13:45:25.444 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API) in 1466.9387ms
2025-03-22 13:45:25.447 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.GetCategoryByIdAsync (offers.itacademy.ge.API)'
2025-03-22 13:45:25.489 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 13:45:25.491 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Categories/get-by-id/845 - 404 null application/json 1526.8547ms
2025-03-22 13:47:18.563 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 22
2025-03-22 13:47:18.580 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-22 13:47:18.584 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-22 13:47:18.586 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 401 0 null 25.1299ms
2025-03-22 13:58:08.172 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 38
2025-03-22 13:58:08.179 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 13:58:08.183 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 13:58:08.247 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 13:58:08.267 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 81.5729ms
2025-03-22 13:58:08.269 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 13:58:08.270 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 400 null application/problem+json; charset=utf-8 98.1174ms
2025-03-22 14:02:04.016 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:02:04.449 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:02:04.461 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:02:04.482 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:02:04.544 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:02:04.554 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:02:04.559 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:02:04.565 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:02:04.575 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:02:04.578 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:02:04.811 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.818 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.822 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.831 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.835 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.838 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.893 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:02:04.946 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:02:04.963 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.968 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:04.995 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:02:05.005 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:02:05.044 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:05.048 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:02:05.085 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:02:05.252 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:02:05.254 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:02:05.371 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:02:05.372 +04:00  INF  Hosting environment: Development
2025-03-22 14:02:05.373 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:02:05.549 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:02:05.786 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 242.8831ms
2025-03-22 14:02:05.820 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:02:05.820 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:02:05.829 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.5076ms
2025-03-22 14:02:05.866 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 46.9354ms
2025-03-22 14:02:06.037 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:02:06.059 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 23.049ms
2025-03-22 14:02:13.288 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 14:02:13.304 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:02:13.328 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:02:13.445 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:02:13.536 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 202.8253ms
2025-03-22 14:02:13.540 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:02:13.643 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Sequence contains no elements.
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.Users.UserRepository.GetUserByUserName(Expression`1 predicate, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\Users\UserRepository.cs:line 23
   at offers.itacademy.ge.Application.Services.UserService.AuthenticateAsync(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 31
   at offers.itacademy.ge.API.Controllers.UsersController.Login(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 33
   at lambda_method296(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:02:13.735 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 500 null application/json 446.9015ms
2025-03-22 14:02:34.882 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 26
2025-03-22 14:02:34.887 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:02:34.889 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:02:34.946 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 14:02:34.968 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 76.129ms
2025-03-22 14:02:34.970 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:02:34.972 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 400 null application/problem+json; charset=utf-8 89.3913ms
2025-03-22 14:02:41.937 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 3
2025-03-22 14:02:41.940 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:02:41.942 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:02:41.966 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 14:02:41.968 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 21.0595ms
2025-03-22 14:02:41.969 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:02:41.971 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 400 null application/problem+json; charset=utf-8 34.4043ms
2025-03-22 14:03:41.685 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:03:42.125 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:03:42.138 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:03:42.152 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:03:42.211 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:03:42.222 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:03:42.226 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:03:42.231 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:03:42.239 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:03:42.243 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:03:42.457 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.464 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.469 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.477 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.481 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.484 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.538 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:03:42.614 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:03:42.630 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.633 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.657 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:03:42.666 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:03:42.703 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.707 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:03:42.743 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:03:42.913 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:03:42.914 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:03:43.023 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:03:43.024 +04:00  INF  Hosting environment: Development
2025-03-22 14:03:43.026 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:03:43.318 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:03:43.543 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 231.7123ms
2025-03-22 14:03:43.576 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:03:43.576 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:03:43.586 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.1887ms
2025-03-22 14:03:43.628 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.2488ms
2025-03-22 14:03:43.898 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:03:43.930 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.805ms
2025-03-22 14:03:51.779 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 26
2025-03-22 14:03:51.798 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:03:51.824 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:03:51.946 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:03:52.051 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 221.2363ms
2025-03-22 14:03:52.054 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:03:52.166 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Sequence contains no elements.
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.Users.UserRepository.GetUserByUserName(Expression`1 predicate, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\Users\UserRepository.cs:line 23
   at offers.itacademy.ge.Application.Services.UserService.AuthenticateAsync(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 31
   at offers.itacademy.ge.API.Controllers.UsersController.Login(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 33
   at lambda_method296(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:03:52.261 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 500 null application/json 481.7594ms
2025-03-22 14:04:03.747 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 3
2025-03-22 14:04:03.754 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:04:03.755 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:04:03.805 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:04:03.881 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 124.1223ms
2025-03-22 14:04:03.884 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:04:03.936 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Sequence contains no elements.
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.Users.UserRepository.GetUserByUserName(Expression`1 predicate, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\Users\UserRepository.cs:line 23
   at offers.itacademy.ge.Application.Services.UserService.AuthenticateAsync(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 31
   at offers.itacademy.ge.API.Controllers.UsersController.Login(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 33
   at lambda_method296(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:04:03.943 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 500 null application/json 195.8257ms
2025-03-22 14:04:36.303 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:04:36.750 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:04:36.763 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:04:36.776 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:04:36.836 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:04:36.845 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:04:36.848 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:04:36.854 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:04:36.862 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:04:36.866 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:04:37.080 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.089 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.093 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.102 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.105 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.107 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.158 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:04:37.211 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:04:37.227 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.231 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.256 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:04:37.266 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:04:37.314 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.319 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:04:37.354 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:04:37.518 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:04:37.520 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:04:37.627 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:04:37.629 +04:00  INF  Hosting environment: Development
2025-03-22 14:04:37.630 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:04:38.218 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:04:38.450 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 238.8631ms
2025-03-22 14:04:38.482 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:04:38.482 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:04:38.492 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.2152ms
2025-03-22 14:04:38.540 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 58.8703ms
2025-03-22 14:04:38.738 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:04:38.775 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 37.1839ms
2025-03-22 14:04:46.031 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 4
2025-03-22 14:04:46.048 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:04:46.073 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:04:46.162 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 14:04:46.185 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 105.0367ms
2025-03-22 14:04:46.187 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:04:46.189 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 400 null application/problem+json; charset=utf-8 159.1609ms
2025-03-22 14:05:02.088 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 44
2025-03-22 14:05:02.095 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:05:02.097 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:05:02.173 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 14:05:02.174 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 75.587ms
2025-03-22 14:05:02.176 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:05:02.178 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 400 null application/problem+json; charset=utf-8 89.3092ms
2025-03-22 14:05:08.526 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 26
2025-03-22 14:05:08.529 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:05:08.530 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:05:08.541 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 14:05:08.542 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 9.8669ms
2025-03-22 14:05:08.544 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:05:08.545 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 400 null application/problem+json; charset=utf-8 19.2993ms
2025-03-22 14:07:56.447 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 14:07:56.458 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:07:56.460 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:08:02.872 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:08:02.997 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 6535.383ms
2025-03-22 14:08:02.999 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:08:03.097 +04:00  ERR  Unhandled exception occurred.System.InvalidOperationException: Sequence contains no elements.
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.Users.UserRepository.GetUserByUserName(Expression`1 predicate, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\Users\UserRepository.cs:line 23
   at offers.itacademy.ge.Application.Services.UserService.AuthenticateAsync(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 31
   at offers.itacademy.ge.API.Controllers.UsersController.Login(UserLoginRequestModel model, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 33
   at lambda_method296(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:08:03.189 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 500 null application/json 6743.5604ms
2025-03-22 14:19:57.382 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:19:57.806 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:19:57.820 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:19:57.836 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:19:57.909 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:19:57.917 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:19:57.921 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:19:57.925 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:19:57.934 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:19:57.937 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:19:58.157 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.164 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.169 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.178 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.183 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.186 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.241 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:19:58.294 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:19:58.310 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.316 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.341 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:19:58.350 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:19:58.389 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.395 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:19:58.432 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:19:58.615 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:19:58.616 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:19:58.727 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:19:58.729 +04:00  INF  Hosting environment: Development
2025-03-22 14:19:58.730 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:19:59.223 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:19:59.446 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 231.4834ms
2025-03-22 14:19:59.479 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:19:59.479 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:19:59.489 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.4807ms
2025-03-22 14:19:59.528 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.6694ms
2025-03-22 14:19:59.684 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:19:59.709 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.7702ms
2025-03-22 14:20:12.014 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-22 14:20:12.036 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:20:12.062 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:20:13.858 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:20:13.928 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 1861.2689ms
2025-03-22 14:20:13.931 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:20:14.026 +04:00  WRN  UnauthorizedAccessException: Invalid username or password
2025-03-22 14:20:14.102 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 401 null application/json 2088.3221ms
2025-03-22 14:20:21.975 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-22 14:20:21.982 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:20:21.983 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:20:24.278 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:20:30.093 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 8108.0129ms
2025-03-22 14:20:30.095 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:20:30.132 +04:00  WRN  UnauthorizedAccessException: Invalid username or password
2025-03-22 14:20:30.135 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 401 null application/json 8159.6024ms
2025-03-22 14:20:45.154 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 61
2025-03-22 14:20:49.639 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:20:49.640 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:20:51.317 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:20:51.482 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:20:51.487 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 1843.9686ms
2025-03-22 14:20:51.488 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:20:51.490 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 6336.6182ms
2025-03-22 14:21:30.011 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 22
2025-03-22 14:21:30.027 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-22 14:21:30.034 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-22 14:21:30.035 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 401 0 null 23.5456ms
2025-03-22 14:21:49.119 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 21
2025-03-22 14:21:49.163 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:21:49.169 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:22:05.608 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Name] = @__name_0
2025-03-22 14:22:13.542 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-03-22 14:22:27.392 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-22 14:22:31.219 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 42047.2598ms
2025-03-22 14:22:31.221 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:22:33.101 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 200 null application/json; charset=utf-8 43982.3956ms
2025-03-22 14:22:39.423 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 21
2025-03-22 14:22:39.429 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:22:39.430 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:22:42.187 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Name] = @__name_0
2025-03-22 14:22:49.097 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 9665.3219ms
2025-03-22 14:22:49.099 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:22:49.138 +04:00  ERR  Unhandled exception occurred.System.ApplicationException: Category with this name already exists.
   at offers.itacademy.ge.Application.Services.CategoryService.CreateCategoryAsync(CategoryRequestModel categoryModel, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 47
   at offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync(CategoryRequestModel category, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 39
   at lambda_method327(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:22:49.154 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 500 null application/json 9731.9405ms
2025-03-22 14:26:23.680 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:26:24.117 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:26:24.130 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:26:24.144 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:26:24.210 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:26:24.220 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:26:24.224 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:26:24.229 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:26:24.238 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:26:24.242 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:26:24.464 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.473 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.477 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.486 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.491 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.493 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.545 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:26:24.598 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:26:24.614 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.619 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.643 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:26:24.653 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:26:24.689 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.694 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:26:24.727 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:26:24.915 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:26:24.917 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:26:25.024 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:26:25.026 +04:00  INF  Hosting environment: Development
2025-03-22 14:26:25.027 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:26:25.516 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:26:25.739 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 230.8279ms
2025-03-22 14:26:25.770 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:26:25.770 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:26:25.789 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 19.0333ms
2025-03-22 14:26:25.822 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.8434ms
2025-03-22 14:26:26.091 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:26:26.122 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.3702ms
2025-03-22 14:26:46.114 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 61
2025-03-22 14:26:46.141 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:26:46.172 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:26:50.374 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:26:50.557 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:26:50.563 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 4383.4799ms
2025-03-22 14:26:50.565 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:26:50.570 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 4456.4277ms
2025-03-22 14:27:07.176 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 21
2025-03-22 14:27:07.214 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:27:07.221 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:27:12.045 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Name] = @__name_0
2025-03-22 14:28:00.641 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 53417.0598ms
2025-03-22 14:28:00.644 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:28:00.752 +04:00  WRN  ObjectAlreadyExistsException: Category with this specifications already exists
2025-03-22 14:28:00.829 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 409 null application/json 53652.8598ms
2025-03-22 14:28:01.640 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:28:01.656 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 15.9337ms
2025-03-22 14:28:01.674 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:28:01.675 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:28:01.683 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.6441ms
2025-03-22 14:28:01.713 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.9505ms
2025-03-22 14:28:02.182 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:28:02.199 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 17.6947ms
2025-03-22 14:31:04.286 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 61
2025-03-22 14:31:04.294 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:31:04.309 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:31:04.321 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:31:04.452 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:31:04.454 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 142.7247ms
2025-03-22 14:31:04.456 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:31:04.457 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 172.2037ms
2025-03-22 14:35:02.080 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/55 - application/json 22
2025-03-22 14:35:02.090 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:35:02.094 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:35:02.132 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:35:02.180 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 84.4395ms
2025-03-22 14:35:02.182 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:35:02.228 +04:00  ERR  Unhandled exception occurred.System.Collections.Generic.KeyNotFoundException: Category not found
   at offers.itacademy.ge.Application.Services.CategoryService.UpdateCategoryAsync(Int32 id, CategoryRequestModel updatedCategory, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 63
   at offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync(Int32 id, CategoryRequestModel category, CancellationToken token)
   at lambda_method354(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context)

2025-03-22 14:35:02.243 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/55 - 500 null application/json 162.6413ms
2025-03-22 14:35:34.942 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:35:35.380 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:35:35.392 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:35:35.405 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:35:35.468 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:35:35.479 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:35:35.482 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:35:35.488 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:35:35.497 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:35:35.501 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:35:35.725 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.734 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.738 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.747 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.750 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.753 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.809 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:35:35.862 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:35:35.879 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.884 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.911 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:35:35.920 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:35:35.956 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.960 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:35:35.996 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:35:36.174 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:35:36.175 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:35:36.292 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:35:36.293 +04:00  INF  Hosting environment: Development
2025-03-22 14:35:36.295 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:35:36.839 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:35:37.070 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 239.4213ms
2025-03-22 14:35:37.100 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:35:37.100 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:35:37.111 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.9001ms
2025-03-22 14:35:37.148 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.5406ms
2025-03-22 14:35:37.311 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:35:37.333 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 21.5254ms
2025-03-22 14:35:46.482 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/214 - application/json 22
2025-03-22 14:35:46.533 +04:00  INF  Failed to validate the token.Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10503: Signature validation failed. Token does not have a kid. Keys tried: '[PII of type 'System.Text.StringBuilder' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)

2025-03-22 14:35:46.542 +04:00  INF  Bearer was not authenticated. Failure message: IDX10503: Signature validation failed. Token does not have a kid. Keys tried: '[PII of type 'System.Text.StringBuilder' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-03-22 14:35:46.551 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-22 14:35:46.557 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-22 14:35:46.559 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/214 - 401 0 null 76.9194ms
2025-03-22 14:36:14.538 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:36:14.955 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:36:14.968 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:36:14.984 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:36:15.043 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:36:15.052 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:36:15.056 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:36:15.060 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:36:15.069 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:36:15.072 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:36:15.284 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.291 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.295 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.303 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.308 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.311 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.365 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:36:15.418 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:36:15.434 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.438 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.463 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:36:15.472 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:36:15.508 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.512 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:36:15.548 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:36:15.731 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:36:15.734 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:36:15.840 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:36:15.842 +04:00  INF  Hosting environment: Development
2025-03-22 14:36:15.843 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:36:16.319 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:36:16.548 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 235.426ms
2025-03-22 14:36:16.582 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:36:16.582 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:36:16.591 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.6164ms
2025-03-22 14:36:16.630 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.2912ms
2025-03-22 14:36:16.792 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:36:16.816 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 23.6986ms
2025-03-22 14:36:34.582 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 61
2025-03-22 14:36:34.599 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:36:34.623 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:36:34.757 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:36:34.959 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:36:34.967 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 335.3979ms
2025-03-22 14:36:34.969 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:36:34.974 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 391.3429ms
2025-03-22 14:37:00.234 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/214352 - application/json 22
2025-03-22 14:37:00.279 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:37:00.286 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:37:03.188 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:37:05.482 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 5192.1603ms
2025-03-22 14:37:05.484 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:37:05.578 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 14:37:05.650 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/214352 - 404 null application/json 5416.9318ms
2025-03-22 14:37:14.797 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/1 - application/json 22
2025-03-22 14:37:14.804 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:37:14.805 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:37:17.130 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:37:22.164 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Categories] SET [Name] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-03-22 14:37:24.913 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-22 14:37:26.811 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 12003.9435ms
2025-03-22 14:37:26.813 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:37:28.353 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/1 - 200 null application/json; charset=utf-8 13556.6104ms
2025-03-22 14:43:36.607 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/55 - null null
2025-03-22 14:43:36.615 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:43:36.619 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:43:36.641 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:43:36.684 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 63.2804ms
2025-03-22 14:43:36.686 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:43:36.731 +04:00  ERR  Unhandled exception occurred.System.Collections.Generic.KeyNotFoundException: Category not found
   at offers.itacademy.ge.Application.Services.CategoryService.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 79
   at offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:43:36.748 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/55 - 500 null application/json 140.8609ms
2025-03-22 14:43:58.571 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:43:59.011 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:43:59.023 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:43:59.036 +04:00  INF  Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:43:59.096 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:43:59.106 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:43:59.108 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:43:59.113 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:43:59.121 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:43:59.124 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:43:59.339 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.403 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.407 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.423 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.428 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.431 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.483 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-03-22 14:43:59.543 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:43:59.582 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:43:59.591 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.594 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.612 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:43:59.620 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:43:59.655 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.659 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:43:59.693 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:43:59.859 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:43:59.860 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:43:59.964 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:43:59.965 +04:00  INF  Hosting environment: Development
2025-03-22 14:43:59.967 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:44:00.291 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:44:00.518 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 233.7351ms
2025-03-22 14:44:00.543 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:44:00.545 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:44:00.551 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.471ms
2025-03-22 14:44:00.592 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 50.2474ms
2025-03-22 14:44:00.778 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:44:00.800 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 22.1811ms
2025-03-22 14:44:09.060 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/51 - null null
2025-03-22 14:44:09.111 +04:00  INF  Failed to validate the token.Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10503: Signature validation failed. Token does not have a kid. Keys tried: '[PII of type 'System.Text.StringBuilder' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)

2025-03-22 14:44:09.121 +04:00  INF  Bearer was not authenticated. Failure message: IDX10503: Signature validation failed. Token does not have a kid. Keys tried: '[PII of type 'System.Text.StringBuilder' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-03-22 14:44:09.129 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-22 14:44:09.135 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-22 14:44:09.137 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/51 - 401 0 null 76.9095ms
2025-03-22 14:44:35.783 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 61
2025-03-22 14:44:35.788 +04:00  INF  Failed to validate the token.Microsoft.IdentityModel.Tokens.SecurityTokenSignatureKeyNotFoundException: IDX10503: Signature validation failed. Token does not have a kid. Keys tried: '[PII of type 'System.Text.StringBuilder' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignature(JsonWebToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateSignatureAndIssuerSecurityKey(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)

2025-03-22 14:44:35.792 +04:00  INF  Bearer was not authenticated. Failure message: IDX10503: Signature validation failed. Token does not have a kid. Keys tried: '[PII of type 'System.Text.StringBuilder' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. Number of keys in TokenValidationParameters: '1'. 
Number of keys in Configuration: '0'. 
Exceptions caught:
 '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
token: '[PII of type 'Microsoft.IdentityModel.JsonWebTokens.JsonWebToken' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'. See https://aka.ms/IDX10503 for details.
2025-03-22 14:44:35.796 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:44:35.823 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:44:35.950 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:44:36.134 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:44:36.140 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 311.4463ms
2025-03-22 14:44:36.142 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:44:36.148 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 365.134ms
2025-03-22 14:44:47.742 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/51 - null null
2025-03-22 14:44:47.758 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:44:47.764 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:44:47.841 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:44:52.965 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 5198.1916ms
2025-03-22 14:44:52.967 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:44:53.061 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-22 14:44:53.138 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/51 - 404 null application/json 5396.6001ms
2025-03-22 14:44:58.899 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 14:44:58.904 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:44:58.905 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:44:58.913 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:45:03.242 +04:00  INF  Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 14:45:03.265 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6b553468-0a84-4b1b-9243-b9afdff33e58
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6b553468-0a84-4b1b-9243-b9afdff33e58
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-22 14:45:03.395 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 4488.1384ms
2025-03-22 14:45:03.397 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:45:03.447 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6b553468-0a84-4b1b-9243-b9afdff33e58
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.CategoryService.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 83
   at offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:45:03.467 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 500 null application/json 4568.3893ms
2025-03-22 14:45:52.201 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 14:45:52.205 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:45:52.206 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:45:52.219 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:45:59.543 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 14:45:59.548 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6b553468-0a84-4b1b-9243-b9afdff33e58
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6b553468-0a84-4b1b-9243-b9afdff33e58
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-22 14:45:59.669 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 7460.8081ms
2025-03-22 14:45:59.671 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:51:37.433 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:51:44.644 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:51:45.208 +04:00  INF  Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [DiscountPlatform];
2025-03-22 14:51:45.247 +04:00  INF  Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [DiscountPlatform] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-03-22 14:51:45.265 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:51:45.271 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:51:45.285 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:51:45.347 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:51:45.357 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:51:45.360 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:51:45.370 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:51:45.382 +04:00  INF  Applying migration '20250322105137_init'.
2025-03-22 14:51:45.402 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-22 14:51:45.407 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(50) NOT NULL,
    [Email] nvarchar(100) NOT NULL,
    [Password] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [IsActivated] bit NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-03-22 14:51:45.412 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ProductOffers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    [Description] nvarchar(500) NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [Quantity] int NOT NULL,
    [CreateTime] datetime2 NOT NULL,
    [ExpirationTime] datetime2 NOT NULL,
    [CategoryId] int NULL,
    [CompanyId] int NOT NULL,
    [Status] int NOT NULL,
    CONSTRAINT [PK_ProductOffers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ProductOffers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_ProductOffers_Users_CompanyId] FOREIGN KEY ([CompanyId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-03-22 14:51:45.417 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Purchases] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ProductOfferId] int NOT NULL,
    [Quantity] int NOT NULL,
    [PurchaseDate] datetime2 NOT NULL,
    CONSTRAINT [PK_Purchases] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId] FOREIGN KEY ([ProductOfferId]) REFERENCES [ProductOffers] ([Id]),
    CONSTRAINT [FK_Purchases_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id])
);
2025-03-22 14:51:45.421 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CategoryId] ON [ProductOffers] ([CategoryId]);
2025-03-22 14:51:45.425 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CompanyId] ON [ProductOffers] ([CompanyId]);
2025-03-22 14:51:45.428 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_ProductOfferId] ON [Purchases] ([ProductOfferId]);
2025-03-22 14:51:45.431 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_UserId] ON [Purchases] ([UserId]);
2025-03-22 14:51:45.435 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322105137_init', N'9.0.3');
2025-03-22 14:51:45.441 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:51:45.668 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:45.752 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:45.756 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:45.768 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:45.931 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:46.062 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:46.258 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 100), @p5='?' (DbType = Boolean), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 100), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (Size = 50), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 4000), @p19='?' (DbType = Int32), @p20='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Categories] USING (
VALUES (@p0, 0),
(@p1, 1),
(@p2, 2)) AS i ([Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Name])
VALUES (i.[Name])
OUTPUT INSERTED.[Id], i._Position;
MERGE [Users] USING (
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, 0),
(@p9, @p10, @p11, @p12, @p13, @p14, 1),
(@p15, @p16, @p17, @p18, @p19, @p20, 2)) AS i ([Balance], [Email], [IsActivated], [Password], [Role], [UserName], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Balance], [Email], [IsActivated], [Password], [Role], [UserName])
VALUES (i.[Balance], i.[Email], i.[IsActivated], i.[Password], i.[Role], i.[UserName])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 14:51:46.318 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:51:46.329 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:51:46.341 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:46.376 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:46.405 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = DateTime2), @p12='?' (Size = 500), @p13='?' (DbType = DateTime2), @p14='?' (Size = 100), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [ProductOffers] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, 0),
(@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 1)) AS i ([CategoryId], [CompanyId], [CreateTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CompanyId], [CreateTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
VALUES (i.[CategoryId], i.[CompanyId], i.[CreateTime], i.[Description], i.[ExpirationTime], i.[Name], i.[Price], i.[Quantity], i.[Status])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 14:51:46.419 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:51:46.429 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:51:46.438 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:46.451 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:51:46.464 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Purchases] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1)) AS i ([ProductOfferId], [PurchaseDate], [Quantity], [UserId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([ProductOfferId], [PurchaseDate], [Quantity], [UserId])
VALUES (i.[ProductOfferId], i.[PurchaseDate], i.[Quantity], i.[UserId])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 14:51:46.491 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:51:46.666 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:51:46.668 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:51:46.777 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:51:46.778 +04:00  INF  Hosting environment: Development
2025-03-22 14:51:46.780 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:51:46.976 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:51:47.201 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 232.1536ms
2025-03-22 14:51:47.234 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:51:47.234 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:51:47.247 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 14.2639ms
2025-03-22 14:51:47.276 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.0249ms
2025-03-22 14:51:47.441 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:51:47.466 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.3329ms
2025-03-22 14:51:51.996 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 14:51:52.012 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:51:52.038 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:51:52.176 +04:00  INF  Executed DbCommand (24ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:51:52.285 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:51:52.292 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 246.0395ms
2025-03-22 14:51:52.293 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:51:52.298 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 301.6255ms
2025-03-22 14:52:07.124 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 14:52:07.163 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:52:07.169 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:52:07.243 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:52:10.281 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 14:52:10.308 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e821ed1e-62c0-4006-a6e5-8eabb4961f8e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e821ed1e-62c0-4006-a6e5-8eabb4961f8e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-22 14:52:10.421 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 3248.1133ms
2025-03-22 14:52:10.423 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:52:16.045 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e821ed1e-62c0-4006-a6e5-8eabb4961f8e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.CategoryService.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 83
   at offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:52:16.131 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 500 null application/json 9007.109ms
2025-03-22 14:55:41.717 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:56:24.899 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:56:25.373 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:56:25.385 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:56:25.401 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:56:25.461 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:56:25.470 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:56:25.474 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:56:25.485 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:56:25.499 +04:00  INF  Applying migration '20250322105542_init2'.
2025-03-22 14:56:25.507 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322105542_init2', N'9.0.3');
2025-03-22 14:56:25.511 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:56:25.773 +04:00  INF  Executed DbCommand (32ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.781 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.786 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.796 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.800 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.803 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.862 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:56:25.913 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:56:25.932 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.937 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:25.963 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:56:25.972 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:56:26.030 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:26.033 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:56:26.068 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:56:26.235 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:56:26.236 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:56:26.338 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:56:26.339 +04:00  INF  Hosting environment: Development
2025-03-22 14:56:26.341 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:56:26.771 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:56:26.992 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 228.4276ms
2025-03-22 14:56:27.019 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:56:27.019 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:56:27.028 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.2523ms
2025-03-22 14:56:27.064 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.4751ms
2025-03-22 14:56:27.323 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:56:27.343 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 20.9747ms
2025-03-22 14:56:33.969 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 14:56:33.985 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:56:34.009 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:56:34.129 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:56:34.317 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:56:34.324 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 307.8657ms
2025-03-22 14:56:34.326 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:56:34.331 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 362.237ms
2025-03-22 14:56:44.490 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 14:56:44.529 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:56:44.537 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:56:44.619 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:56:48.580 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 14:56:48.607 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b5fc36d4-bdac-4133-b6f7-faad18fab674
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b5fc36d4-bdac-4133-b6f7-faad18fab674
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-22 14:56:48.763 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 4223.6835ms
2025-03-22 14:56:48.766 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:56:51.123 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b5fc36d4-bdac-4133-b6f7-faad18fab674
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.CategoryService.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 83
   at offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:56:52.341 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 500 null application/json 7851.591ms
2025-03-22 14:57:25.541 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:57:25.635 +04:00  INF  No migrations were found in assembly 'offers.itacademy.ge.Persistance'. A migration needs to be added before the database can be updated.
2025-03-22 14:57:26.061 +04:00  INF  Executed DbCommand (99ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [DiscountPlatform];
2025-03-22 14:57:26.100 +04:00  INF  Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [DiscountPlatform] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-03-22 14:57:26.122 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:57:26.130 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:57:26.152 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:57:26.250 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:57:26.260 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:57:26.263 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:57:26.274 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:57:26.285 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 14:57:26.288 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:57:26.545 +04:00  ERR  Failed executing DbCommand (23ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:26.559 +04:00  ERR  An exception occurred while iterating over the results of a query for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Categories'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:6b4d8798-df0d-4e7b-aad1-df8394a18f9d
Error Number:208,State:1,Class:16Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Categories'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
ClientConnectionId:6b4d8798-df0d-4e7b-aad1-df8394a18f9d
Error Number:208,State:1,Class:16

2025-03-22 14:57:26.592 +04:00  FTL  Application failed to start.Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Categories'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method6(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedCategories(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 76
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 37
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceproviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 27
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70
ClientConnectionId:6b4d8798-df0d-4e7b-aad1-df8394a18f9d
Error Number:208,State:1,Class:16

2025-03-22 14:57:38.574 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:57:44.770 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 14:57:45.250 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:57:45.264 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 14:57:45.279 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 14:57:45.350 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 14:57:45.361 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 14:57:45.364 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 14:57:45.372 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 14:57:45.384 +04:00  INF  Applying migration '20250322105738_init'.
2025-03-22 14:57:45.405 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-22 14:57:45.410 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(50) NOT NULL,
    [Email] nvarchar(100) NOT NULL,
    [Password] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [IsActivated] bit NOT NULL,
    [Balance] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-03-22 14:57:45.415 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ProductOffers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    [Description] nvarchar(500) NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [Quantity] int NOT NULL,
    [CreateTime] datetime2 NOT NULL,
    [ExpirationTime] datetime2 NOT NULL,
    [CategoryId] int NULL,
    [CompanyId] int NOT NULL,
    [Status] int NOT NULL,
    CONSTRAINT [PK_ProductOffers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ProductOffers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_ProductOffers_Users_CompanyId] FOREIGN KEY ([CompanyId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-03-22 14:57:45.419 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Purchases] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [ProductOfferId] int NOT NULL,
    [Quantity] int NOT NULL,
    [PurchaseDate] datetime2 NOT NULL,
    CONSTRAINT [PK_Purchases] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId] FOREIGN KEY ([ProductOfferId]) REFERENCES [ProductOffers] ([Id]),
    CONSTRAINT [FK_Purchases_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id])
);
2025-03-22 14:57:45.423 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CategoryId] ON [ProductOffers] ([CategoryId]);
2025-03-22 14:57:45.426 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CompanyId] ON [ProductOffers] ([CompanyId]);
2025-03-22 14:57:45.429 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_ProductOfferId] ON [Purchases] ([ProductOfferId]);
2025-03-22 14:57:45.432 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_UserId] ON [Purchases] ([UserId]);
2025-03-22 14:57:45.436 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322105738_init', N'9.0.3');
2025-03-22 14:57:45.441 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 14:57:45.656 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:45.742 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:45.747 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:45.756 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:45.916 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:46.050 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:46.197 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 100), @p5='?' (DbType = Boolean), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 100), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Int32), @p14='?' (Size = 50), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 4000), @p19='?' (DbType = Int32), @p20='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Categories] USING (
VALUES (@p0, 0),
(@p1, 1),
(@p2, 2)) AS i ([Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Name])
VALUES (i.[Name])
OUTPUT INSERTED.[Id], i._Position;
MERGE [Users] USING (
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, 0),
(@p9, @p10, @p11, @p12, @p13, @p14, 1),
(@p15, @p16, @p17, @p18, @p19, @p20, 2)) AS i ([Balance], [Email], [IsActivated], [Password], [Role], [UserName], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Balance], [Email], [IsActivated], [Password], [Role], [UserName])
VALUES (i.[Balance], i.[Email], i.[IsActivated], i.[Password], i.[Role], i.[UserName])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 14:57:46.261 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 14:57:46.271 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 14:57:46.282 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:46.319 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:46.347 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = DateTime2), @p12='?' (Size = 500), @p13='?' (DbType = DateTime2), @p14='?' (Size = 100), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [ProductOffers] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, 0),
(@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 1)) AS i ([CategoryId], [CompanyId], [CreateTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CompanyId], [CreateTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
VALUES (i.[CategoryId], i.[CompanyId], i.[CreateTime], i.[Description], i.[ExpirationTime], i.[Name], i.[Price], i.[Quantity], i.[Status])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 14:57:46.360 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 14:57:46.369 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 14:57:46.379 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:46.391 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 14:57:46.406 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Purchases] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1)) AS i ([ProductOfferId], [PurchaseDate], [Quantity], [UserId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([ProductOfferId], [PurchaseDate], [Quantity], [UserId])
VALUES (i.[ProductOfferId], i.[PurchaseDate], i.[Quantity], i.[UserId])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 14:57:46.433 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 14:57:46.603 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 14:57:46.604 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 14:57:46.714 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 14:57:46.715 +04:00  INF  Hosting environment: Development
2025-03-22 14:57:46.716 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 14:57:47.025 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 14:57:47.259 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 240.8856ms
2025-03-22 14:57:47.287 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 14:57:47.287 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 14:57:47.301 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 13.618ms
2025-03-22 14:57:47.337 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 50.2358ms
2025-03-22 14:57:47.454 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 14:57:47.496 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.584ms
2025-03-22 14:57:53.154 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 14:57:53.172 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:57:53.198 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 14:57:53.331 +04:00  INF  Executed DbCommand (18ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 14:57:53.443 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 14:57:53.450 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 244.9161ms
2025-03-22 14:57:53.452 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 14:57:53.456 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 302.2947ms
2025-03-22 14:58:04.634 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 14:58:04.673 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:58:04.679 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:58:04.765 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:58:07.170 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 14:58:07.195 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3260f81c-19f0-468e-bfb4-ba0fd0185bee
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3260f81c-19f0-468e-bfb4-ba0fd0185bee
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-22 14:58:07.303 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 2619.8291ms
2025-03-22 14:58:07.305 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:58:08.997 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3260f81c-19f0-468e-bfb4-ba0fd0185bee
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.CategoryService.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\CategoryService.cs:line 83
   at offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync(Int32 id, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\CategoriesController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-22 14:58:09.093 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 500 null application/json 4459.8194ms
2025-03-22 14:58:45.256 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 14:58:45.262 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 14:58:45.264 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 14:58:45.273 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 14:58:46.617 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 14:58:46.622 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3260f81c-19f0-468e-bfb4-ba0fd0185bee
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Purchases_ProductOffers_ProductOfferId". The conflict occurred in database "DiscountPlatform", table "dbo.Purchases", column 'ProductOfferId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3260f81c-19f0-468e-bfb4-ba0fd0185bee
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-22 14:58:46.716 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 1449.8458ms
2025-03-22 14:58:46.719 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:01:25.381 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:01:35.085 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:01:35.575 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:01:35.588 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 15:01:35.610 +04:00  INF  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 15:01:35.672 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 15:01:35.681 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:01:35.685 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 15:01:35.694 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 15:01:35.706 +04:00  INF  Applying migration '20250322110125_init2'.
2025-03-22 15:01:35.784 +04:00  INF  Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var sysname;
SELECT @var = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Purchases]') AND [c].[name] = N'ProductOfferId');
IF @var IS NOT NULL EXEC(N'ALTER TABLE [Purchases] DROP CONSTRAINT [' + @var + '];');
ALTER TABLE [Purchases] ALTER COLUMN [ProductOfferId] int NULL;
2025-03-22 15:01:35.788 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322110125_init2', N'9.0.3');
2025-03-22 15:01:35.793 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 15:01:36.010 +04:00  INF  Executed DbCommand (18ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.018 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.022 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.038 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.042 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.045 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.103 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 15:01:36.155 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 15:01:36.174 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.178 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.207 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 15:01:36.216 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 15:01:36.259 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.263 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:01:36.299 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 15:01:36.482 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 15:01:36.483 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 15:01:36.634 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 15:01:36.635 +04:00  INF  Hosting environment: Development
2025-03-22 15:01:36.636 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 15:01:36.712 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 15:01:36.966 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 263.1916ms
2025-03-22 15:01:37.002 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 15:01:37.002 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 15:01:37.013 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 11.4848ms
2025-03-22 15:01:37.051 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.5294ms
2025-03-22 15:01:37.177 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 15:01:37.200 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 23.1613ms
2025-03-22 15:02:52.588 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:02:59.001 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:02:59.500 +04:00  INF  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:02:59.512 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 15:02:59.534 +04:00  INF  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 15:02:59.597 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 15:02:59.608 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:02:59.613 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 15:02:59.623 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 15:02:59.636 +04:00  INF  Applying migration '20250322110252_init3'.
2025-03-22 15:02:59.652 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Purchases] DROP CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId];
2025-03-22 15:02:59.661 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Purchases] ADD CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId] FOREIGN KEY ([ProductOfferId]) REFERENCES [ProductOffers] ([Id]) ON DELETE SET NULL;
2025-03-22 15:02:59.665 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322110252_init3', N'9.0.3');
2025-03-22 15:02:59.671 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 15:02:59.898 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:02:59.905 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:02:59.908 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:02:59.925 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:02:59.928 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:02:59.931 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:02:59.978 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 15:03:00.051 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 15:03:00.068 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:03:00.072 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:03:00.097 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 15:03:00.107 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 15:03:00.150 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:03:00.156 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:03:00.193 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 15:03:00.362 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 15:03:00.364 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 15:03:00.491 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 15:03:00.492 +04:00  INF  Hosting environment: Development
2025-03-22 15:03:00.493 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 15:03:00.687 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 15:03:00.927 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 247.6163ms
2025-03-22 15:03:00.958 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 15:03:00.958 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 15:03:00.973 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 15.8ms
2025-03-22 15:03:01.018 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 61.1862ms
2025-03-22 15:03:01.140 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 15:03:01.171 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.0156ms
2025-03-22 15:03:06.453 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 15:03:06.474 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:03:06.504 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:03:06.636 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 15:03:06.838 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 15:03:06.845 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 334.9912ms
2025-03-22 15:03:06.848 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:03:06.854 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 400.0981ms
2025-03-22 15:03:20.133 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 15:03:20.172 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:03:20.179 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:03:20.266 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 15:03:24.165 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 15:03:27.659 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 7475.6805ms
2025-03-22 15:03:27.660 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:03:30.049 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 200 0 null 9916.8161ms
2025-03-22 15:03:44.451 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/2 - null null
2025-03-22 15:03:44.458 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:03:44.460 +04:00  INF  Route matched with {action = "DeleteCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task DeleteCategoryAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:03:44.468 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] = @__p_0
2025-03-22 15:03:45.988 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Categories]
OUTPUT 1
WHERE [Id] = @p0;
2025-03-22 15:03:45.991 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API) in 1528.7975ms
2025-03-22 15:03:45.992 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.DeleteCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:03:45.994 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/2 - 200 0 null 1543.6289ms
2025-03-22 15:04:13.555 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:04:13.986 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:04:13.999 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 15:04:14.029 +04:00  INF  Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 15:04:14.087 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 15:04:14.098 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:04:14.102 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 15:04:14.108 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 15:04:14.118 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 15:04:14.123 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 15:04:14.332 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.399 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.411 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.420 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.425 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.428 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.497 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Categories] USING (
VALUES (@p0, 0),
(@p1, 1)) AS i ([Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Name])
VALUES (i.[Name])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 15:04:14.562 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 15:04:14.592 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 15:04:14.604 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.638 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.671 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = DateTime2), @p12='?' (Size = 500), @p13='?' (DbType = DateTime2), @p14='?' (Size = 100), @p15='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [ProductOffers] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, 0),
(@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, 1)) AS i ([CategoryId], [CompanyId], [CreateTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CompanyId], [CreateTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
VALUES (i.[CategoryId], i.[CompanyId], i.[CreateTime], i.[Description], i.[ExpirationTime], i.[Name], i.[Price], i.[Quantity], i.[Status])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 15:04:14.685 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 15:04:14.702 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 15:04:14.717 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.733 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:04:14.745 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Purchases] USING (
VALUES (@p0, @p1, @p2, @p3, 0),
(@p4, @p5, @p6, @p7, 1)) AS i ([ProductOfferId], [PurchaseDate], [Quantity], [UserId], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([ProductOfferId], [PurchaseDate], [Quantity], [UserId])
VALUES (i.[ProductOfferId], i.[PurchaseDate], i.[Quantity], i.[UserId])
OUTPUT INSERTED.[Id], i._Position;
2025-03-22 15:04:14.773 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 15:04:14.943 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 15:04:14.945 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 15:04:15.053 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 15:04:15.055 +04:00  INF  Hosting environment: Development
2025-03-22 15:04:15.056 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 15:04:15.462 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 15:04:15.686 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 231.6145ms
2025-03-22 15:04:15.719 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 15:04:15.719 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 15:04:15.736 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 15.0216ms
2025-03-22 15:04:15.775 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.7097ms
2025-03-22 15:04:15.964 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 15:04:15.994 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.6442ms
2025-03-22 15:05:20.834 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-22 15:05:20.856 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:05:20.879 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:05:21.001 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 15:05:21.194 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 15:05:21.201 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 315.9145ms
2025-03-22 15:05:21.203 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:05:21.208 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 373.9725ms
2025-03-22 15:05:32.393 +04:00  INF  Request starting HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - null null
2025-03-22 15:05:32.432 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-22 15:05:32.436 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-22 15:05:32.438 +04:00  INF  Request finished HTTP/2 DELETE https://localhost:7230/api/Categories/delete/1 - 403 0 null 45.5029ms
2025-03-22 15:06:00.775 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-22 15:06:00.783 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:06:00.785 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:06:00.851 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 15:06:00.912 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 125.0299ms
2025-03-22 15:06:00.914 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:06:03.319 +04:00  WRN  UnauthorizedAccessException: Invalid username or password
2025-03-22 15:06:03.392 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 401 null application/json 2617.3673ms
2025-03-22 15:06:14.996 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 15:06:15.000 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:06:15.001 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:06:15.012 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 15:06:15.142 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 15:06:15.145 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 142.1456ms
2025-03-22 15:06:15.146 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:06:15.148 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 152.4012ms
2025-03-22 15:06:26.449 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 16
2025-03-22 15:06:26.455 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:06:26.462 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:06:26.482 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 15:06:26.505 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 41.0917ms
2025-03-22 15:06:26.507 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:06:26.508 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 400 null application/problem+json; charset=utf-8 59.749ms
2025-03-22 15:08:35.607 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:08:36.051 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:08:36.067 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 15:08:36.082 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 15:08:36.143 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 15:08:36.152 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:08:36.157 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 15:08:36.162 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 15:08:36.171 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 15:08:36.174 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 15:08:36.387 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.396 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.400 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.409 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.412 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.415 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.467 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 15:08:36.520 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 15:08:36.539 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.543 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.567 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 15:08:36.579 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 15:08:36.623 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.629 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:08:36.678 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 15:08:36.849 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 15:08:36.850 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 15:08:36.957 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 15:08:36.959 +04:00  INF  Hosting environment: Development
2025-03-22 15:08:36.960 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 15:08:37.246 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 15:08:37.480 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 242.6098ms
2025-03-22 15:08:37.507 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 15:08:37.511 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 15:08:37.523 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 11.8163ms
2025-03-22 15:08:37.561 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.2219ms
2025-03-22 15:08:37.764 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 15:08:37.804 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.6861ms
2025-03-22 15:08:43.434 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 15:08:43.450 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:08:43.474 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:08:43.597 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 15:08:43.787 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 15:08:43.793 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 312.7466ms
2025-03-22 15:08:43.796 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:08:43.800 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 366.525ms
2025-03-22 15:08:54.400 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 22
2025-03-22 15:08:54.450 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:08:54.458 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:08:54.526 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Name] = @__name_0
2025-03-22 15:08:54.656 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-03-22 15:08:54.680 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel'.
2025-03-22 15:08:54.684 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 223.3238ms
2025-03-22 15:08:54.687 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:08:54.688 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 200 null application/json; charset=utf-8 287.9855ms
2025-03-22 15:09:12.053 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 16
2025-03-22 15:09:12.059 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:12.061 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:09:12.077 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 15:09:12.108 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 45.5947ms
2025-03-22 15:09:12.110 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:12.111 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 400 null application/problem+json; charset=utf-8 58.5189ms
2025-03-22 15:09:16.913 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Categories/create - application/json 3
2025-03-22 15:09:16.918 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:16.919 +04:00  INF  Route matched with {action = "CreateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] CreateCategoryAsync(offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:09:16.927 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 15:09:16.928 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API) in 7.3211ms
2025-03-22 15:09:16.929 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.CreateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:16.931 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Categories/create - 400 null application/problem+json; charset=utf-8 17.9385ms
2025-03-22 15:09:25.721 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/6 - application/json 3
2025-03-22 15:09:25.724 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:25.730 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:09:25.740 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 15:09:25.742 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 7.0078ms
2025-03-22 15:09:25.744 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:25.745 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/6 - 400 null application/problem+json; charset=utf-8 24.7044ms
2025-03-22 15:09:30.743 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Categories/update/6 - application/json 16
2025-03-22 15:09:30.747 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:30.749 +04:00  INF  Route matched with {action = "UpdateCategory", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Categories.CategoryResponseModel] UpdateCategoryAsync(Int32, offers.itacademy.ge.Application.Models.Categories.CategoryRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.CategoriesController (offers.itacademy.ge.API).
2025-03-22 15:09:30.752 +04:00  INF  Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-03-22 15:09:30.753 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API) in 2.5895ms
2025-03-22 15:09:30.754 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.CategoriesController.UpdateCategoryAsync (offers.itacademy.ge.API)'
2025-03-22 15:09:30.757 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Categories/update/6 - 400 null application/problem+json; charset=utf-8 13.3144ms
2025-03-22 15:47:34.789 +04:00  WRN  No store type was specified for the decimal property 'Balance' on entity type 'User'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-22 15:47:35.261 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:47:35.273 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 15:47:35.290 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 15:47:35.351 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 15:47:35.361 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 15:47:35.364 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 15:47:35.369 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 15:47:35.377 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 15:47:35.381 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 15:47:35.643 +04:00  INF  Executed DbCommand (18ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.651 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.653 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.662 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.668 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.671 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.731 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 1 AND [u].[IsActivated] = CAST(1 AS bit)
2025-03-22 15:47:35.785 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 15:47:35.805 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.811 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.840 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 15:47:35.849 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreateTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 15:47:35.893 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.897 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__purchase_UserId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[UserId] = @__purchase_UserId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 15:47:35.941 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 15:47:36.127 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 15:47:36.129 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 15:47:36.235 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 15:47:36.237 +04:00  INF  Hosting environment: Development
2025-03-22 15:47:36.238 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 15:47:36.595 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 15:47:36.877 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 290.0037ms
2025-03-22 15:47:36.911 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 15:47:36.911 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 15:47:36.933 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 21.2523ms
2025-03-22 15:47:36.961 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 50.0755ms
2025-03-22 15:47:37.176 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 15:47:37.202 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 26.5645ms
2025-03-22 15:47:45.005 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 50
2025-03-22 15:47:45.022 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:47:45.046 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:47:45.184 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-22 15:47:45.380 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-22 15:47:45.386 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 333.9812ms
2025-03-22 15:47:45.389 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-22 15:47:45.393 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 388.4077ms
2025-03-22 15:48:05.627 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/getUsersByRole?pageNumber=1&pageSize=10&role=0 - null null
2025-03-22 15:48:05.669 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API)'
2025-03-22 15:48:05.678 +04:00  INF  Route matched with {action = "GetUsersByRole", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Users.UserResponseModel]] GetUsersByRole(Int32, Int32, offers.itacademy.ge.Domain.Users.UserRole, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:48:05.747 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-22 15:48:05.749 +04:00  WRN  The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-22 15:48:05.761 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__role_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = @__role_0
ORDER BY (SELECT 1)
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
2025-03-22 15:48:05.839 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Users.UserResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-22 15:48:05.846 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API) in 164.5939ms
2025-03-22 15:48:05.848 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API)'
2025-03-22 15:48:05.850 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/getUsersByRole?pageNumber=1&pageSize=10&role=0 - 200 null application/json; charset=utf-8 222.8416ms
2025-03-22 15:48:09.108 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/getUsersByRole?pageNumber=1&pageSize=10&role=1 - null null
2025-03-22 15:48:09.116 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API)'
2025-03-22 15:48:09.118 +04:00  INF  Route matched with {action = "GetUsersByRole", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Users.UserResponseModel]] GetUsersByRole(Int32, Int32, offers.itacademy.ge.Domain.Users.UserRole, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:48:09.132 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__role_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = @__role_0
ORDER BY (SELECT 1)
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
2025-03-22 15:48:09.134 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Users.UserResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-22 15:48:09.136 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API) in 15.4622ms
2025-03-22 15:48:09.138 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API)'
2025-03-22 15:48:09.139 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/getUsersByRole?pageNumber=1&pageSize=10&role=1 - 200 null application/json; charset=utf-8 31.8035ms
2025-03-22 15:48:12.433 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Users/getUsersByRole?pageNumber=1&pageSize=10&role=2 - null null
2025-03-22 15:48:12.439 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API)'
2025-03-22 15:48:12.441 +04:00  INF  Route matched with {action = "GetUsersByRole", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Users.UserResponseModel]] GetUsersByRole(Int32, Int32, offers.itacademy.ge.Domain.Users.UserRole, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-22 15:48:12.448 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__role_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Balance], [u].[Email], [u].[IsActivated], [u].[Password], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Role] = @__role_0
ORDER BY (SELECT 1)
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
2025-03-22 15:48:12.451 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Users.UserResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-22 15:48:12.453 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API) in 10.7927ms
2025-03-22 15:48:12.455 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.GetUsersByRole (offers.itacademy.ge.API)'
2025-03-22 15:48:12.456 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Users/getUsersByRole?pageNumber=1&pageSize=10&role=2 - 200 null application/json; charset=utf-8 23.7428ms
2025-03-22 23:02:17.413 +04:00  INF  Executed DbCommand (153ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [DiscountPlatform];
2025-03-22 23:02:17.728 +04:00  INF  Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [DiscountPlatform] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-03-22 23:02:17.780 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:02:17.798 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 23:02:17.847 +04:00  INF  Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 23:02:17.977 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 23:02:17.988 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:02:17.991 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 23:02:18.002 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 23:02:18.016 +04:00  INF  Applying migration '20250322190204_init'.
2025-03-22 23:02:18.044 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-22 23:02:18.052 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(50) NOT NULL,
    [Email] nvarchar(100) NOT NULL,
    [Password] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [IsActivated] bit NULL DEFAULT CAST(0 AS bit),
    [ImageUrl] nvarchar(255) NULL,
    [Balance] decimal(18,2) NULL DEFAULT 0.0,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-03-22 23:02:18.057 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ProductOffers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    [Description] nvarchar(500) NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [Quantity] int NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [ExpirationTime] datetime2 NOT NULL,
    [CategoryId] int NULL,
    [CompanyId] int NOT NULL,
    [Status] int NOT NULL,
    CONSTRAINT [PK_ProductOffers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ProductOffers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_ProductOffers_Users_CompanyId] FOREIGN KEY ([CompanyId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-03-22 23:02:18.063 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Purchases] (
    [Id] int NOT NULL IDENTITY,
    [CustomerId] int NOT NULL,
    [ProductOfferId] int NULL,
    [Quantity] int NOT NULL,
    [PurchaseDate] datetime2 NOT NULL,
    CONSTRAINT [PK_Purchases] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId] FOREIGN KEY ([ProductOfferId]) REFERENCES [ProductOffers] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_Purchases_Users_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Users] ([Id])
);
2025-03-22 23:02:18.067 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CategoryId] ON [ProductOffers] ([CategoryId]);
2025-03-22 23:02:18.079 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CompanyId] ON [ProductOffers] ([CompanyId]);
2025-03-22 23:02:18.088 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_CustomerId] ON [Purchases] ([CustomerId]);
2025-03-22 23:02:18.098 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_ProductOfferId] ON [Purchases] ([ProductOfferId]);
2025-03-22 23:02:18.112 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322190204_init', N'9.0.3');
2025-03-22 23:02:18.125 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 23:02:18.451 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:18.532 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:18.537 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:18.551 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:18.772 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:18.969 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:19.229 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Size = 100), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 50), @p7='?' (Size = 100), @p8='?' (Size = 255), @p9='?' (DbType = Boolean), @p10='?' (Size = 4000), @p11='?' (DbType = Int32), @p12='?' (Size = 50), @p13='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p14='?' (Size = 100), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Categories] USING (
VALUES (@p0, 0),
(@p1, 1),
(@p2, 2)) AS i ([Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Name])
VALUES (i.[Name])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Users] ([Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6);
INSERT INTO [Users] ([Email], [ImageUrl], [IsActivated], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p7, @p8, @p9, @p10, @p11, @p12);
INSERT INTO [Users] ([Balance], [Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p13, @p14, @p15, @p16, @p17);
2025-03-22 23:02:19.301 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-22 23:02:19.311 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 23:02:19.324 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:02:19.376 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 23:02:19.385 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 23:02:19.406 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-22 23:02:19.444 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 23:02:19.947 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 23:02:19.950 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 23:02:20.190 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 23:02:20.192 +04:00  INF  Hosting environment: Development
2025-03-22 23:02:20.193 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 23:02:20.218 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 23:02:20.521 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 313.317ms
2025-03-22 23:02:20.564 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 23:02:20.564 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 23:02:20.611 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 46.8322ms
2025-03-22 23:02:20.653 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 88.8578ms
2025-03-22 23:02:20.905 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 23:02:20.945 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.871ms
2025-03-22 23:04:31.518 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:04:31.589 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 23:04:31.626 +04:00  INF  Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 23:04:31.719 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 23:04:31.733 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:04:31.737 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 23:04:31.750 +04:00  INF  Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 23:04:31.764 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-22 23:04:31.770 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 23:04:32.187 +04:00  INF  Executed DbCommand (47ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.205 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.210 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.241 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.246 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.251 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.330 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-22 23:04:32.407 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 23:04:32.443 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.482 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 23:04:32.503 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 23:04:32.586 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:04:32.733 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-22 23:04:32.790 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 23:04:33.013 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 23:04:33.015 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 23:04:33.247 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 23:04:33.248 +04:00  INF  Hosting environment: Development
2025-03-22 23:04:33.250 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 23:04:33.328 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 23:04:33.599 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 281.5946ms
2025-03-22 23:04:33.644 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 23:04:33.644 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 23:04:33.665 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 20.8041ms
2025-03-22 23:04:33.726 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 82.3455ms
2025-03-22 23:04:33.855 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 23:04:33.899 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 44.9725ms
2025-03-22 23:07:35.924 +04:00  FTL  Application failed to start.System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'DiscountPlatformContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Migrate(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 30
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 24
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-22 23:07:41.097 +04:00  FTL  Application failed to start.System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'DiscountPlatformContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Migrate(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 30
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 24
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-22 23:07:48.659 +04:00  FTL  Application failed to start.System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'DiscountPlatformContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Migrate(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 30
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 24
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-22 23:08:14.068 +04:00  INF  Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:08:14.119 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 23:08:14.133 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 23:08:14.190 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 23:08:14.199 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:08:14.201 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 23:08:14.206 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 23:08:14.220 +04:00  INF  Applying migration '20250322190804_init2'.
2025-03-22 23:08:14.245 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [Company_Balance] decimal(18,2) NULL DEFAULT 0.0;
2025-03-22 23:08:14.249 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322190804_init2', N'9.0.3');
2025-03-22 23:08:14.253 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 23:08:14.490 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.499 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.502 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.518 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.523 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.526 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.582 +04:00  INF  Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Company_Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-22 23:08:14.636 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 23:08:14.654 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.680 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 23:08:14.693 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 23:08:14.747 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:08:14.813 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 23:08:14.987 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 23:08:14.990 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 23:08:15.092 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 23:08:15.093 +04:00  INF  Hosting environment: Development
2025-03-22 23:08:15.093 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 23:08:15.394 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 23:08:15.638 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 249.4276ms
2025-03-22 23:08:15.690 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 23:08:15.694 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 23:08:15.716 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 27.6612ms
2025-03-22 23:08:15.746 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 57.7238ms
2025-03-22 23:08:15.949 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 23:08:15.982 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.5503ms
2025-03-22 23:09:46.556 +04:00  INF  Executed DbCommand (134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [DiscountPlatform];
2025-03-22 23:09:46.628 +04:00  INF  Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [DiscountPlatform] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-03-22 23:09:46.647 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:09:46.653 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 23:09:46.669 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 23:09:46.752 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 23:09:46.766 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:09:46.769 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 23:09:46.783 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 23:09:46.796 +04:00  INF  Applying migration '20250322190938_init'.
2025-03-22 23:09:46.823 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-22 23:09:46.828 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(50) NOT NULL,
    [Email] nvarchar(100) NOT NULL,
    [Password] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [IsActivated] bit NULL DEFAULT CAST(0 AS bit),
    [ImageUrl] nvarchar(255) NULL,
    [Company_Balance] decimal(18,2) NULL DEFAULT 0.0,
    [Balance] decimal(18,2) NULL DEFAULT 0.0,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-03-22 23:09:46.833 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ProductOffers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    [Description] nvarchar(500) NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [Quantity] int NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [ExpirationTime] datetime2 NOT NULL,
    [CategoryId] int NULL,
    [CompanyId] int NOT NULL,
    [Status] int NOT NULL,
    CONSTRAINT [PK_ProductOffers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ProductOffers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_ProductOffers_Users_CompanyId] FOREIGN KEY ([CompanyId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-03-22 23:09:46.837 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Purchases] (
    [Id] int NOT NULL IDENTITY,
    [CustomerId] int NOT NULL,
    [ProductOfferId] int NULL,
    [Quantity] int NOT NULL,
    [PurchaseDate] datetime2 NOT NULL,
    CONSTRAINT [PK_Purchases] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId] FOREIGN KEY ([ProductOfferId]) REFERENCES [ProductOffers] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_Purchases_Users_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Users] ([Id])
);
2025-03-22 23:09:46.840 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CategoryId] ON [ProductOffers] ([CategoryId]);
2025-03-22 23:09:46.844 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CompanyId] ON [ProductOffers] ([CompanyId]);
2025-03-22 23:09:46.847 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_CustomerId] ON [Purchases] ([CustomerId]);
2025-03-22 23:09:46.850 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_ProductOfferId] ON [Purchases] ([ProductOfferId]);
2025-03-22 23:09:46.855 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322190938_init', N'9.0.3');
2025-03-22 23:09:46.861 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 23:09:47.082 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:47.157 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:47.162 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:47.173 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:47.364 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:47.525 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:47.793 +04:00  INF  Executed DbCommand (18ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Size = 100), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 50), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (Size = 100), @p9='?' (Size = 255), @p10='?' (DbType = Boolean), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (Size = 50), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p15='?' (Size = 100), @p16='?' (Size = 4000), @p17='?' (DbType = Int32), @p18='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Categories] USING (
VALUES (@p0, 0),
(@p1, 1),
(@p2, 2)) AS i ([Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Name])
VALUES (i.[Name])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Users] ([Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6);
INSERT INTO [Users] ([Company_Balance], [Email], [ImageUrl], [IsActivated], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO [Users] ([Balance], [Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p14, @p15, @p16, @p17, @p18);
2025-03-22 23:09:47.890 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Company_Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-22 23:09:47.903 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 23:09:47.919 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:48.009 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-22 23:09:48.036 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 23:09:48.053 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 23:09:48.073 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:09:48.103 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-22 23:09:48.145 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 23:09:48.320 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 23:09:48.321 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 23:09:48.430 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 23:09:48.431 +04:00  INF  Hosting environment: Development
2025-03-22 23:09:48.433 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 23:09:48.754 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 23:09:49.011 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 271.3539ms
2025-03-22 23:09:49.044 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 23:09:49.044 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 23:09:49.062 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 17.6466ms
2025-03-22 23:09:49.133 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 88.3694ms
2025-03-22 23:09:49.250 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 23:09:49.294 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 43.5197ms
2025-03-22 23:15:57.853 +04:00  INF  Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:15:57.928 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 23:15:57.948 +04:00  INF  Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 23:15:58.035 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 23:15:58.049 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:15:58.053 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 23:15:58.061 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 23:15:58.082 +04:00  INF  Applying migration '20250322191409_init2'.
2025-03-22 23:15:58.441 +04:00  INF  Executed DbCommand (323ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[Users].[Company_Balance]', N'Customer_Balance', 'COLUMN';
2025-03-22 23:15:58.446 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322191409_init2', N'9.0.3');
2025-03-22 23:15:58.450 +04:00  INF  Applying migration '20250322191511_init3'.
2025-03-22 23:15:58.505 +04:00  INF  Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var sysname;
SELECT @var = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'Customer_Balance');
IF @var IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var + '];');
ALTER TABLE [Users] DROP COLUMN [Customer_Balance];
2025-03-22 23:15:58.511 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322191511_init3', N'9.0.3');
2025-03-22 23:15:58.517 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 23:15:58.927 +04:00  INF  Executed DbCommand (31ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:58.938 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:58.944 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:58.971 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:58.976 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:58.981 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:59.080 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-22 23:15:59.172 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 23:15:59.207 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:59.259 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 23:15:59.281 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 23:15:59.355 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:15:59.411 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 23:15:59.656 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 23:15:59.658 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 23:15:59.835 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 23:15:59.837 +04:00  INF  Hosting environment: Development
2025-03-22 23:15:59.839 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 23:16:00.190 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 23:16:00.558 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 376.5887ms
2025-03-22 23:16:00.608 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 23:16:00.608 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 23:16:00.635 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 27.1055ms
2025-03-22 23:16:00.683 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 74.9255ms
2025-03-22 23:16:01.047 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 23:16:01.079 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 32.2918ms
2025-03-22 23:17:55.810 +04:00  INF  Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [DiscountPlatform];
2025-03-22 23:17:55.892 +04:00  INF  Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [DiscountPlatform] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-03-22 23:17:55.943 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:17:55.950 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-22 23:17:55.965 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-22 23:17:56.026 +04:00  INF  Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-22 23:17:56.039 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-22 23:17:56.042 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-22 23:17:56.052 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-22 23:17:56.067 +04:00  INF  Applying migration '20250322191746_init'.
2025-03-22 23:17:56.097 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-03-22 23:17:56.101 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserName] nvarchar(50) NOT NULL,
    [Email] nvarchar(100) NOT NULL,
    [Password] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [IsActivated] bit NULL DEFAULT CAST(0 AS bit),
    [ImageUrl] nvarchar(255) NULL,
    [Balance] decimal(18,2) NULL DEFAULT 0.0,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-03-22 23:17:56.106 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ProductOffers] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(100) NOT NULL,
    [Description] nvarchar(500) NOT NULL,
    [Price] decimal(18,2) NOT NULL,
    [Quantity] int NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [ExpirationTime] datetime2 NOT NULL,
    [CategoryId] int NULL,
    [CompanyId] int NOT NULL,
    [Status] int NOT NULL,
    CONSTRAINT [PK_ProductOffers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ProductOffers_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_ProductOffers_Users_CompanyId] FOREIGN KEY ([CompanyId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-03-22 23:17:56.111 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Purchases] (
    [Id] int NOT NULL IDENTITY,
    [CustomerId] int NOT NULL,
    [ProductOfferId] int NULL,
    [Quantity] int NOT NULL,
    [PurchaseDate] datetime2 NOT NULL,
    CONSTRAINT [PK_Purchases] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Purchases_ProductOffers_ProductOfferId] FOREIGN KEY ([ProductOfferId]) REFERENCES [ProductOffers] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_Purchases_Users_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Users] ([Id])
);
2025-03-22 23:17:56.115 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CategoryId] ON [ProductOffers] ([CategoryId]);
2025-03-22 23:17:56.119 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductOffers_CompanyId] ON [ProductOffers] ([CompanyId]);
2025-03-22 23:17:56.123 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_CustomerId] ON [Purchases] ([CustomerId]);
2025-03-22 23:17:56.126 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Purchases_ProductOfferId] ON [Purchases] ([ProductOfferId]);
2025-03-22 23:17:56.133 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250322191746_init', N'9.0.3');
2025-03-22 23:17:56.139 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-22 23:17:56.393 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:56.459 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:56.464 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:56.476 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:56.675 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:56.827 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:57.053 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Size = 100), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 50), @p7='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p8='?' (Size = 100), @p9='?' (Size = 255), @p10='?' (DbType = Boolean), @p11='?' (Size = 4000), @p12='?' (DbType = Int32), @p13='?' (Size = 50), @p14='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p15='?' (Size = 100), @p16='?' (Size = 4000), @p17='?' (DbType = Int32), @p18='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [Categories] USING (
VALUES (@p0, 0),
(@p1, 1),
(@p2, 2)) AS i ([Name], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([Name])
VALUES (i.[Name])
OUTPUT INSERTED.[Id], i._Position;
INSERT INTO [Users] ([Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6);
INSERT INTO [Users] ([Balance], [Email], [ImageUrl], [IsActivated], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO [Users] ([Balance], [Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p14, @p15, @p16, @p17, @p18);
2025-03-22 23:17:57.121 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-22 23:17:57.131 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-22 23:17:57.144 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:57.196 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 500), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ProductOffers] ([CategoryId], [CompanyId], [CreationTime], [Description], [ExpirationTime], [Name], [Price], [Quantity], [Status])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-03-22 23:17:57.212 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-22 23:17:57.221 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-22 23:17:57.235 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-22 23:17:57.253 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Purchases] ([CustomerId], [ProductOfferId], [PurchaseDate], [Quantity])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-22 23:17:57.281 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-22 23:17:57.444 +04:00  INF  Now listening on: https://localhost:7230
2025-03-22 23:17:57.446 +04:00  INF  Now listening on: http://localhost:5229
2025-03-22 23:17:57.556 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-22 23:17:57.558 +04:00  INF  Hosting environment: Development
2025-03-22 23:17:57.559 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-22 23:17:57.980 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-22 23:17:58.219 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 245.6243ms
2025-03-22 23:17:58.269 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-22 23:17:58.281 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-22 23:17:58.293 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 24.0176ms
2025-03-22 23:17:58.365 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 96.0649ms
2025-03-22 23:17:58.497 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-22 23:17:58.567 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 70.0895ms
