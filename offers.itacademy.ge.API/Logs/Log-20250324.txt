2025-03-24 11:59:47.540 +04:00  INF  Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 11:59:47.631 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 11:59:47.662 +04:00  INF  Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 11:59:47.754 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 11:59:47.770 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 11:59:47.775 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 11:59:47.786 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 11:59:47.800 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 11:59:47.805 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 11:59:48.321 +04:00  INF  Executed DbCommand (30ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.334 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.341 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.363 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.368 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.373 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.463 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 11:59:48.559 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 11:59:48.589 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.635 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 11:59:48.657 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 11:59:48.760 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 11:59:48.833 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 11:59:49.214 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 11:59:49.217 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 11:59:49.406 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 11:59:49.416 +04:00  INF  Hosting environment: Development
2025-03-24 11:59:49.418 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 11:59:50.064 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 11:59:50.500 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 447.0491ms
2025-03-24 11:59:50.546 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 11:59:50.556 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 11:59:50.574 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 28.3283ms
2025-03-24 11:59:50.654 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 98.1663ms
2025-03-24 11:59:50.876 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 11:59:50.927 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 51.6482ms
2025-03-24 12:08:18.759 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 12:08:18.807 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:08:18.860 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 12:08:19.144 +04:00  INF  Executed DbCommand (28ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 12:08:19.500 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 12:08:19.508 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 638.9914ms
2025-03-24 12:08:19.511 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:08:19.518 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 758.8963ms
2025-03-24 12:08:36.140 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - null null
2025-03-24 12:08:36.239 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:08:36.249 +04:00  INF  Route matched with {action = "GetMyPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetMyPurchasesAsync(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:08:36.391 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:08:36.518 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API) in 263.9658ms
2025-03-24 12:08:36.522 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:08:45.424 +04:00  INF  NotFoundException: User not found
2025-03-24 12:08:45.556 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - 404 null application/json 9416.2687ms
2025-03-24 12:08:46.307 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 12:08:46.340 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 34.8354ms
2025-03-24 12:08:46.383 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 12:08:46.383 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 12:08:46.398 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 15.0146ms
2025-03-24 12:08:46.416 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 33.5596ms
2025-03-24 12:08:46.938 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 12:08:46.980 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.9556ms
2025-03-24 12:08:59.697 +04:00  INF  Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 12:08:59.760 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 12:08:59.778 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 12:08:59.843 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 12:08:59.856 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 12:08:59.859 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 12:08:59.864 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 12:08:59.873 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 12:08:59.876 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 12:09:00.146 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.154 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.157 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.174 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.177 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.180 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.239 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 12:09:00.298 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 12:09:00.318 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.345 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 12:09:00.358 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 12:09:00.402 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:00.440 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 12:09:00.603 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 12:09:00.604 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 12:09:00.725 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 12:09:00.726 +04:00  INF  Hosting environment: Development
2025-03-24 12:09:00.727 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 12:09:01.269 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 12:09:01.498 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 235.8959ms
2025-03-24 12:09:01.537 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 12:09:01.537 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 12:09:01.552 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 15.7382ms
2025-03-24 12:09:01.594 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 57.5658ms
2025-03-24 12:09:01.693 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 12:09:01.720 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 27.4308ms
2025-03-24 12:09:11.894 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 12:09:11.936 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:09:12.002 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 12:09:12.242 +04:00  INF  Executed DbCommand (27ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 12:09:12.666 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 12:09:12.676 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 663.5767ms
2025-03-24 12:09:12.680 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:09:12.688 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 794.1334ms
2025-03-24 12:09:24.614 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - null null
2025-03-24 12:09:24.707 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:09:24.717 +04:00  INF  Route matched with {action = "GetMyPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetMyPurchasesAsync(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:09:24.838 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:09:24.924 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API) in 202.981ms
2025-03-24 12:09:24.927 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:09:26.563 +04:00  INF  NotFoundException: User not found
2025-03-24 12:09:26.668 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - 404 null application/json 2054.0075ms
2025-03-24 12:09:48.717 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - null null
2025-03-24 12:09:48.728 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:09:48.789 +04:00  INF  Route matched with {action = "GetMyPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetMyPurchasesAsync(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:09:59.849 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:55.258 +04:00  INF  Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 12:11:55.346 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 12:11:55.370 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 12:11:55.455 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 12:11:55.469 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 12:11:55.474 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 12:11:55.481 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 12:11:55.497 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 12:11:55.501 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 12:11:55.875 +04:00  INF  Executed DbCommand (20ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:55.883 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:55.899 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:55.946 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:55.951 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:55.956 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:56.045 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 12:11:56.114 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 12:11:56.135 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:56.179 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 12:11:56.194 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 12:11:56.244 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:11:56.287 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 12:11:56.467 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 12:11:56.469 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 12:11:56.742 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 12:11:56.743 +04:00  INF  Hosting environment: Development
2025-03-24 12:11:56.745 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 12:11:57.032 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 12:11:57.262 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 237.6279ms
2025-03-24 12:11:57.292 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 12:11:57.292 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 12:11:57.302 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.2202ms
2025-03-24 12:11:57.353 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 60.9834ms
2025-03-24 12:11:57.569 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 12:11:57.615 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 47.0145ms
2025-03-24 12:12:07.101 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 12:12:07.149 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:12:07.195 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 12:12:07.466 +04:00  INF  Executed DbCommand (29ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 12:12:07.882 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 12:12:07.898 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 690.326ms
2025-03-24 12:12:07.905 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:12:07.928 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 827.1933ms
2025-03-24 12:12:29.370 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - null null
2025-03-24 12:12:29.442 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:12:29.450 +04:00  INF  Route matched with {action = "GetMyPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetMyPurchasesAsync(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:12:33.385 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:12:37.333 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated]
FROM [Purchases] AS [p]
LEFT JOIN [ProductOffers] AS [p0] ON [p].[ProductOfferId] = [p0].[Id]
LEFT JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
WHERE [p].[CustomerId] = @__userId_0 OR [p0].[CompanyId] = @__userId_0
2025-03-24 12:12:37.538 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 12:12:37.556 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API) in 8101.8563ms
2025-03-24 12:12:37.559 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetMyPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:12:37.562 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/my-purchases - 200 null application/json; charset=utf-8 8191.831ms
2025-03-24 12:12:50.958 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/user/3/purchases - null null
2025-03-24 12:12:50.972 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-24 12:12:50.984 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-24 12:12:50.986 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/user/3/purchases - 403 0 null 29.5212ms
2025-03-24 12:13:03.770 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/offer/3/purchases - null null
2025-03-24 12:13:03.780 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Company|Admin)
2025-03-24 12:13:03.783 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-24 12:13:03.786 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/offer/3/purchases - 403 0 null 15.9702ms
2025-03-24 12:13:14.917 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-24 12:13:14.925 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:13:14.928 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 12:13:14.954 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 12:13:15.218 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 12:13:15.221 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 288.3421ms
2025-03-24 12:13:15.224 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:13:15.226 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 310.1515ms
2025-03-24 12:13:44.644 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/offer/2/purchases - null null
2025-03-24 12:13:44.756 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetOfferPurchases (offers.itacademy.ge.API)'
2025-03-24 12:13:44.774 +04:00  INF  Route matched with {action = "GetOfferPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetOfferPurchases(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:13:44.833 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
WHERE [p].[Id] = @__p_0
2025-03-24 12:13:44.878 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__offerId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance]
FROM [Purchases] AS [p]
INNER JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 2
) AS [u0] ON [p].[CustomerId] = [u0].[Id]
WHERE [p].[ProductOfferId] = @__offerId_0
2025-03-24 12:13:44.886 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 12:13:44.888 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetOfferPurchases (offers.itacademy.ge.API) in 109.4038ms
2025-03-24 12:13:44.892 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetOfferPurchases (offers.itacademy.ge.API)'
2025-03-24 12:13:44.895 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/offer/2/purchases - 200 null application/json; charset=utf-8 251.8733ms
2025-03-24 12:14:12.453 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/user/2/purchases - null null
2025-03-24 12:14:12.466 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-03-24 12:14:12.468 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-24 12:14:12.470 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/user/2/purchases - 403 0 null 17.3834ms
2025-03-24 12:14:20.946 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-24 12:14:20.952 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:14:20.954 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 12:14:20.981 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 12:14:21.102 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 12:14:21.106 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 147.7354ms
2025-03-24 12:14:21.109 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 12:14:21.113 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 166.0604ms
2025-03-24 12:14:37.081 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/user/2/purchases - null null
2025-03-24 12:14:37.087 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:14:37.094 +04:00  INF  Route matched with {action = "GetUserPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetUserPurchasesAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:14:39.612 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:14:39.627 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated]
FROM [Purchases] AS [p]
LEFT JOIN [ProductOffers] AS [p0] ON [p].[ProductOfferId] = [p0].[Id]
LEFT JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
WHERE [p].[CustomerId] = @__userId_0 OR [p0].[CompanyId] = @__userId_0
2025-03-24 12:14:39.634 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 12:14:39.637 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API) in 2537.7029ms
2025-03-24 12:14:39.640 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:14:39.643 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/user/2/purchases - 200 null application/json; charset=utf-8 2562.3348ms
2025-03-24 12:14:45.447 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/user/3/purchases - null null
2025-03-24 12:14:45.453 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:14:45.455 +04:00  INF  Route matched with {action = "GetUserPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetUserPurchasesAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:14:46.966 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:14:46.972 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CustomerId], [p].[ProductOfferId], [p].[PurchaseDate], [p].[Quantity], [p].[Status], [p0].[Id], [p0].[CategoryId], [p0].[CompanyId], [p0].[CreationTime], [p0].[Description], [p0].[ExpirationTime], [p0].[Name], [p0].[Price], [p0].[Quantity], [p0].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated]
FROM [Purchases] AS [p]
LEFT JOIN [ProductOffers] AS [p0] ON [p].[ProductOfferId] = [p0].[Id]
LEFT JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p0].[CompanyId] = [u0].[Id]
WHERE [p].[CustomerId] = @__userId_0 OR [p0].[CompanyId] = @__userId_0
2025-03-24 12:14:46.977 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 12:14:46.979 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API) in 1520.7ms
2025-03-24 12:14:46.981 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:14:46.983 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/user/3/purchases - 200 null application/json; charset=utf-8 1536.5264ms
2025-03-24 12:14:52.851 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/Purchases/user/35/purchases - null null
2025-03-24 12:14:52.857 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:14:52.859 +04:00  INF  Route matched with {action = "GetUserPurchases", controller = "Purchases"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.Purchases.PurchaseResponseModel]] GetUserPurchasesAsync(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.PurchasesController (offers.itacademy.ge.API).
2025-03-24 12:14:53.875 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 12:14:53.949 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API) in 1086.4024ms
2025-03-24 12:14:53.952 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.PurchasesController.GetUserPurchasesAsync (offers.itacademy.ge.API)'
2025-03-24 12:14:55.526 +04:00  INF  NotFoundException: User not found
2025-03-24 12:14:55.664 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/Purchases/user/35/purchases - 404 null application/json 2813.1747ms
2025-03-24 13:38:56.269 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:38:56.316 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 13:38:56.331 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 13:38:56.394 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 13:38:56.405 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:38:56.409 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 13:38:56.416 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 13:38:56.427 +04:00  INF  Applying migration '20250324093847_addSelectedCategoryforUsers'.
2025-03-24 13:38:56.455 +04:00  INF  Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CustomerCategories] (
    [CustomerId] int NOT NULL,
    [SelectedCategoriesId] int NOT NULL,
    CONSTRAINT [PK_CustomerCategories] PRIMARY KEY ([CustomerId], [SelectedCategoriesId]),
    CONSTRAINT [FK_CustomerCategories_Categories_SelectedCategoriesId] FOREIGN KEY ([SelectedCategoriesId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_CustomerCategories_Users_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-03-24 13:38:56.460 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_CustomerCategories_SelectedCategoriesId] ON [CustomerCategories] ([SelectedCategoriesId]);
2025-03-24 13:38:56.464 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250324093847_addSelectedCategoryforUsers', N'9.0.3');
2025-03-24 13:38:56.468 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 13:38:56.704 +04:00  INF  Executed DbCommand (20ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.715 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.721 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.737 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.743 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.749 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.801 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 13:38:56.860 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 13:38:56.880 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:56.908 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 13:38:56.922 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 13:38:56.976 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:38:57.025 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 13:38:57.215 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 13:38:57.217 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 13:38:57.330 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 13:38:57.332 +04:00  INF  Hosting environment: Development
2025-03-24 13:38:57.333 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 13:38:57.530 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 13:38:57.771 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 249.6901ms
2025-03-24 13:38:57.810 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 13:38:57.810 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 13:38:57.823 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 12.7023ms
2025-03-24 13:38:57.862 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 52.3937ms
2025-03-24 13:38:58.064 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 13:38:58.108 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 44.1362ms
2025-03-24 13:41:31.585 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 13:41:31.609 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:41:31.636 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:41:31.782 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 13:41:31.988 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 13:41:31.996 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 353.4746ms
2025-03-24 13:41:31.998 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:41:32.003 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 417.7638ms
2025-03-24 13:41:55.384 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 13:41:55.433 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:41:55.440 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:41:55.545 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 13:41:55.599 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 13:41:55.700 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 13:41:55.717 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-24 13:41:55.721 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 277.6281ms
2025-03-24 13:41:55.723 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:41:55.725 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 200 null application/json; charset=utf-8 340.8985ms
2025-03-24 13:42:12.645 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 13:42:12.651 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:42:12.652 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:42:12.665 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 13:42:12.669 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 13:42:12.681 +04:00  ERR  Failed executing DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 13:42:12.703 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:46361be9-823f-41a4-bcab-d5cdb0b81849
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:46361be9-823f-41a4-bcab-d5cdb0b81849
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-24 13:42:12.819 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 165.2141ms
2025-03-24 13:42:12.821 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:43:39.011 +04:00  INF  Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:43:39.057 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 13:43:39.071 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 13:43:39.141 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 13:43:39.154 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:43:39.158 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 13:43:39.164 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 13:43:39.174 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 13:43:39.177 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 13:43:39.399 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.407 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.410 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.424 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.427 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.430 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.480 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 13:43:39.550 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 13:43:39.570 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.596 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 13:43:39.610 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 13:43:39.651 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:43:39.689 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 13:43:39.857 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 13:43:39.859 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 13:43:39.961 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 13:43:39.963 +04:00  INF  Hosting environment: Development
2025-03-24 13:43:39.964 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 13:43:40.197 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 13:43:40.456 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 266.4797ms
2025-03-24 13:43:40.475 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 13:43:40.475 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 13:43:40.495 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 19.7791ms
2025-03-24 13:43:40.530 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 55.1383ms
2025-03-24 13:43:40.729 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 13:43:40.770 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 41.2536ms
2025-03-24 13:43:53.201 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 13:43:53.218 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:43:53.242 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:43:53.375 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 13:43:53.569 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 13:43:53.575 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 326.901ms
2025-03-24 13:43:53.577 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:43:53.581 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 379.7743ms
2025-03-24 13:44:09.680 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 13:44:09.719 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:44:09.727 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:44:09.814 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 13:44:09.860 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 13:44:09.964 +04:00  ERR  Failed executing DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 13:44:09.989 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:88ac9efb-9236-424a-b1c4-49a3aee2a4c9
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:88ac9efb-9236-424a-b1c4-49a3aee2a4c9
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-24 13:44:10.118 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 389.6067ms
2025-03-24 13:44:10.120 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:44:13.010 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:88ac9efb-9236-424a-b1c4-49a3aee2a4c9
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.UserService.UpdateCustomerCategoriesAsync(Int32 customerId, List`1 categoryIds, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 74
   at offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories(List`1 categoryIds, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 56
   at lambda_method389(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-24 13:44:13.111 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 500 null application/json 3431.627ms
2025-03-24 13:44:19.835 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 13:44:19.841 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:44:19.843 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:44:19.853 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 13:44:19.858 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 13:44:19.865 +04:00  ERR  Failed executing DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 13:44:19.871 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:88ac9efb-9236-424a-b1c4-49a3aee2a4c9
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:88ac9efb-9236-424a-b1c4-49a3aee2a4c9
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-24 13:44:19.971 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 126.3731ms
2025-03-24 13:44:19.973 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:49:16.427 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:49:16.474 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 13:49:16.489 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 13:49:16.542 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 13:49:16.553 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:49:16.556 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 13:49:16.561 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 13:49:16.570 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 13:49:16.573 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 13:49:16.780 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.788 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.792 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.807 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.812 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.815 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.860 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 13:49:16.914 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 13:49:16.933 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:16.960 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 13:49:16.976 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 13:49:17.030 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:49:17.067 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 13:49:17.240 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 13:49:17.242 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 13:49:17.345 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 13:49:17.346 +04:00  INF  Hosting environment: Development
2025-03-24 13:49:17.347 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 13:49:17.635 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 13:49:17.851 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 222.2156ms
2025-03-24 13:49:17.875 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 13:49:17.882 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 13:49:17.891 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.4316ms
2025-03-24 13:49:17.919 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 44.1711ms
2025-03-24 13:49:18.091 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 13:49:18.116 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.5213ms
2025-03-24 13:49:30.497 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 13:49:30.518 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:49:30.544 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:49:30.681 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 13:49:30.875 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 13:49:30.881 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 332.268ms
2025-03-24 13:49:30.885 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:49:30.890 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 393.093ms
2025-03-24 13:49:46.697 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 13:49:46.737 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:49:46.745 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:49:46.833 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 13:49:46.880 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 13:49:46.982 +04:00  ERR  Failed executing DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 13:49:47.007 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:694ff15c-9375-459b-bac6-afbdec8d0a80
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:694ff15c-9375-459b-bac6-afbdec8d0a80
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-24 13:49:47.129 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 381.0506ms
2025-03-24 13:49:47.131 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:52:40.284 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:52:40.330 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 13:52:40.346 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 13:52:40.398 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 13:52:40.409 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 13:52:40.412 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 13:52:40.417 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 13:52:40.426 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 13:52:40.428 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 13:52:40.655 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.663 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.667 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.686 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.690 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.693 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.749 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 13:52:40.813 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 13:52:40.839 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.869 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 13:52:40.881 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 13:52:40.924 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 13:52:40.961 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 13:52:41.124 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 13:52:41.127 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 13:52:41.231 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 13:52:41.232 +04:00  INF  Hosting environment: Development
2025-03-24 13:52:41.234 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 13:52:41.605 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 13:52:41.832 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 233.3196ms
2025-03-24 13:52:41.848 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 13:52:41.848 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 13:52:41.858 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.2038ms
2025-03-24 13:52:41.894 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.9165ms
2025-03-24 13:52:42.172 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 13:52:42.211 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.0641ms
2025-03-24 13:52:52.937 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 13:52:52.954 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:52:52.978 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:52:53.108 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 13:52:53.302 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 13:52:53.309 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 324.6541ms
2025-03-24 13:52:53.311 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 13:52:53.316 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 379.2371ms
2025-03-24 13:53:05.850 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 13:53:05.891 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:53:05.897 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 13:53:05.987 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 13:53:06.036 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 13:53:06.141 +04:00  ERR  Failed executing DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 13:53:06.168 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:4d96925b-5838-438e-aa58-495c65365c32
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:4d96925b-5838-438e-aa58-495c65365c32
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-24 13:53:06.297 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 397.7668ms
2025-03-24 13:53:06.300 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 13:53:07.514 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:4d96925b-5838-438e-aa58-495c65365c32
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.UserService.UpdateCustomerCategoriesAsync(Int32 customerId, List`1 categoryIds, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 74
   at offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories(List`1 categoryIds, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 56
   at lambda_method389(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-24 13:53:07.617 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 500 null application/json 1767.4335ms
2025-03-24 13:57:31.112 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/relevant-offers - null null
2025-03-24 13:57:31.128 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API)'
2025-03-24 13:57:31.134 +04:00  INF  Route matched with {action = "GetRelevantOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetRelevantOffers(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-24 13:57:31.242 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 13:57:31.290 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [c0].[Id], [c0].[Name]
FROM [ProductOffers] AS [p]
INNER JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p].[CompanyId] = [u0].[Id]
LEFT JOIN [Categories] AS [c0] ON [p].[CategoryId] = [c0].[Id]
WHERE [p].[Status] = 0 AND [p].[CategoryId] IN (
    SELECT [c].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c]
)
2025-03-24 13:57:31.359 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 13:57:31.372 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API) in 236.1016ms
2025-03-24 13:57:31.377 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API)'
2025-03-24 13:57:31.380 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/relevant-offers - 200 null application/json; charset=utf-8 270.3039ms
2025-03-24 13:58:35.997 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/relevant-offers - null null
2025-03-24 13:58:36.006 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API)'
2025-03-24 13:58:36.008 +04:00  INF  Route matched with {action = "GetRelevantOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetRelevantOffers(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-24 13:58:36.017 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 13:58:36.027 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [c0].[Id], [c0].[Name]
FROM [ProductOffers] AS [p]
INNER JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p].[CompanyId] = [u0].[Id]
LEFT JOIN [Categories] AS [c0] ON [p].[CategoryId] = [c0].[Id]
WHERE [p].[Status] = 0 AND [p].[CategoryId] IN (
    SELECT [c].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c]
)
2025-03-24 13:58:36.030 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 13:58:36.032 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API) in 22.025ms
2025-03-24 13:58:36.033 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API)'
2025-03-24 13:58:36.037 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/relevant-offers - 200 null application/json; charset=utf-8 41.1296ms
2025-03-24 14:06:36.202 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 14:06:36.258 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 14:06:36.276 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 14:06:36.338 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 14:06:36.349 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 14:06:36.353 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 14:06:36.359 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 14:06:36.370 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 14:06:36.374 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 14:06:36.626 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.634 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.637 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.650 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.655 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.657 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.713 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 14:06:36.793 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 14:06:36.813 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.845 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 14:06:36.857 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 14:06:36.900 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:06:36.941 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 14:06:37.122 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 14:06:37.124 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 14:06:37.237 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 14:06:37.239 +04:00  INF  Hosting environment: Development
2025-03-24 14:06:37.241 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 14:06:37.607 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 14:06:37.853 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 255.5569ms
2025-03-24 14:06:37.875 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 14:06:37.875 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 14:06:37.893 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 18.1419ms
2025-03-24 14:06:37.920 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 45.0139ms
2025-03-24 14:06:38.109 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 14:06:38.131 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 22.7422ms
2025-03-24 14:06:49.938 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 14:06:49.960 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Customer)
2025-03-24 14:06:49.965 +04:00  INF  AuthenticationScheme: Bearer was challenged.
2025-03-24 14:06:49.966 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 401 0 null 28.8493ms
2025-03-24 14:07:00.065 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 52
2025-03-24 14:07:00.072 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 14:07:00.098 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:07:00.233 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 14:07:00.425 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 14:07:00.431 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 328.1267ms
2025-03-24 14:07:00.433 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 14:07:00.438 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 373.7921ms
2025-03-24 14:07:08.854 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 14:07:08.891 +04:00  INF  Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Customer)
2025-03-24 14:07:08.893 +04:00  INF  AuthenticationScheme: Bearer was forbidden.
2025-03-24 14:07:08.895 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 403 0 null 41.4537ms
2025-03-24 14:07:20.225 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 14:07:20.229 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 14:07:20.230 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:07:20.279 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 14:07:20.410 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 14:07:20.412 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 180.0323ms
2025-03-24 14:07:20.414 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 14:07:20.416 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 191.7199ms
2025-03-24 14:07:28.044 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 14:07:28.050 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:07:28.056 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:07:28.108 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 14:07:28.155 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 14:07:28.263 +04:00  ERR  Failed executing DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p9='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 100), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1),
(@p2, @p3);
UPDATE [Users] SET [Balance] = @p4, [Email] = @p5, [Password] = @p6, [Role] = @p7, [UserName] = @p8
OUTPUT 1
WHERE [Id] = @p9;
2025-03-24 14:07:28.286 +04:00  ERR  An exception occurred in the database while saving changes for context type 'offers.itacademy.ge.Persistance.Context.DiscountPlatformContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:f8e01bd0-39b0-4be7-890e-da5f6846a1e2
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:f8e01bd0-39b0-4be7-890e-da5f6846a1e2
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)

2025-03-24 14:07:28.412 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 353.4478ms
2025-03-24 14:07:28.414 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:07:44.190 +04:00  ERR  Unhandled exception occurred.Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_CustomerCategories'. Cannot insert duplicate key in object 'dbo.CustomerCategories'. The duplicate key value is (3, 2).
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:f8e01bd0-39b0-4be7-890e-da5f6846a1e2
Error Number:2627,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at offers.itacademy.ge.Infrastructure.UnitOfWork.SaveChangesAsync(CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Infrastructure\UnitOfWork.cs:line 32
   at offers.itacademy.ge.Application.Services.UserService.UpdateCustomerCategoriesAsync(Int32 customerId, List`1 categoryIds, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Application\Services\UserService.cs:line 82
   at offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories(List`1 categoryIds, CancellationToken token) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Controllers\UsersController.cs:line 56
   at lambda_method389(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at offers.itacademy.ge.API.Infrastructure.Middlewares.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Infrastructure\Middlewares\GlobalExceptionHandlerMiddleware.cs:line 21

2025-03-24 14:07:44.284 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 500 null application/json 16240.3662ms
2025-03-24 14:07:46.154 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 14:07:46.158 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:07:46.159 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:07:46.167 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 14:07:46.174 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 14:12:57.315 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 14:12:57.358 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 14:12:57.373 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 14:12:57.428 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 14:12:57.437 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 14:12:57.440 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 14:12:57.445 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 14:12:57.452 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 14:12:57.456 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 14:12:57.671 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.679 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.683 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.697 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.702 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.704 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.752 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 14:12:57.808 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 14:12:57.827 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.857 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 14:12:57.871 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 14:12:57.910 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 14:12:57.956 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 14:12:58.121 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 14:12:58.123 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 14:12:58.223 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 14:12:58.224 +04:00  INF  Hosting environment: Development
2025-03-24 14:12:58.226 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 14:12:58.601 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 14:12:58.820 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 224.3401ms
2025-03-24 14:12:58.844 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 14:12:58.844 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 14:12:58.862 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 18.9937ms
2025-03-24 14:12:58.891 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.3646ms
2025-03-24 14:12:59.059 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 14:12:59.086 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 27.91ms
2025-03-24 14:13:08.851 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 14:13:08.871 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 14:13:08.894 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:13:09.017 +04:00  INF  Executed DbCommand (13ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 14:13:09.227 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 14:13:09.234 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 334.0508ms
2025-03-24 14:13:09.236 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 14:13:09.241 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 390.5741ms
2025-03-24 14:13:25.589 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 14:13:25.630 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:13:25.637 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:13:25.791 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 14:13:25.850 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 14:13:25.907 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 100), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Balance] = @p0, [Email] = @p1, [Password] = @p2, [Role] = @p3, [UserName] = @p4
OUTPUT 1
WHERE [Id] = @p5;
2025-03-24 14:13:31.435 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-24 14:13:31.440 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 5798.8857ms
2025-03-24 14:13:31.442 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:13:31.444 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 200 null application/json; charset=utf-8 5854.4394ms
2025-03-24 14:13:45.385 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 9
2025-03-24 14:13:45.392 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:13:45.393 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:13:45.405 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 14:13:45.409 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 14:13:45.418 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 100), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Balance] = @p0, [Email] = @p1, [Password] = @p2, [Role] = @p3, [UserName] = @p4
OUTPUT 1
WHERE [Id] = @p5;
2025-03-24 14:13:45.422 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-24 14:13:45.423 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 27.5272ms
2025-03-24 14:13:45.425 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:13:45.427 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 200 null application/json; charset=utf-8 42.2718ms
2025-03-24 14:13:54.828 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 11
2025-03-24 14:13:54.833 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:13:54.835 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:13:54.852 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 14:13:54.858 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 14:13:54.919 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 81.8305ms
2025-03-24 14:13:54.921 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:13:57.463 +04:00  INF  NotFoundException: Category with this specifications is not found
2025-03-24 14:13:57.531 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 404 null application/json 2703.5476ms
2025-03-24 14:14:12.379 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update-categories - application/json 11
2025-03-24 14:14:12.383 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:14:12.384 +04:00  INF  Route matched with {action = "UpdateCategories", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] UpdateCategories(System.Collections.Generic.List`1[System.Int32], System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 14:14:12.389 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 14:14:12.394 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
WHERE [c].[Id] IN (
    SELECT [c0].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c0]
)
2025-03-24 14:14:12.431 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p7='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (Size = 100), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CustomerCategories] ([CustomerId], [SelectedCategoriesId])
VALUES (@p0, @p1);
UPDATE [Users] SET [Balance] = @p2, [Email] = @p3, [Password] = @p4, [Role] = @p5, [UserName] = @p6
OUTPUT 1
WHERE [Id] = @p7;
2025-03-24 14:14:12.442 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-24 14:14:12.445 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API) in 58.6112ms
2025-03-24 14:14:12.447 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCategories (offers.itacademy.ge.API)'
2025-03-24 14:14:12.448 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update-categories - 200 null application/json; charset=utf-8 68.3486ms
2025-03-24 16:41:21.161 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 16:41:21.203 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 16:41:21.228 +04:00  INF  Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 16:41:21.285 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 16:41:21.294 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 16:41:21.297 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 16:41:21.305 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 16:41:21.313 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 16:41:21.317 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 16:41:21.544 +04:00  INF  Executed DbCommand (24ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.552 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.555 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.619 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 16:41:21.657 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.661 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.664 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.696 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 16:41:21.723 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 16:41:21.735 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.756 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 16:41:21.769 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 16:41:21.817 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 16:41:21.857 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 16:41:22.026 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 16:41:22.027 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 16:41:22.188 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 16:41:22.189 +04:00  INF  Hosting environment: Development
2025-03-24 16:41:22.191 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 16:41:22.261 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 16:41:22.533 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 280.5828ms
2025-03-24 16:41:22.559 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 16:41:22.559 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 16:41:22.600 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 18.773ms
2025-03-24 16:41:22.626 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 68.084ms
2025-03-24 16:41:22.890 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 16:41:22.938 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 48.5147ms
2025-03-24 17:02:53.094 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 17:02:53.143 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 17:02:53.166 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 17:02:53.222 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 17:02:53.232 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 17:02:53.235 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 17:02:53.243 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 17:02:53.251 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 17:02:53.255 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 17:02:53.504 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.512 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.516 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.571 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 17:02:53.619 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.623 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.625 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.654 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 17:02:53.679 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 17:02:53.691 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.710 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 17:02:53.723 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 17:02:53.765 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:02:53.807 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 17:02:53.983 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 17:02:53.985 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 17:02:54.111 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 17:02:54.112 +04:00  INF  Hosting environment: Development
2025-03-24 17:02:54.114 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 17:02:54.220 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 17:02:54.500 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 288.0848ms
2025-03-24 17:02:54.524 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 17:02:54.524 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 17:02:54.534 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.3862ms
2025-03-24 17:02:54.570 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.2206ms
2025-03-24 17:02:54.797 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 17:02:54.836 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.7199ms
2025-03-24 17:09:38.837 +04:00  INF  Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 17:09:38.887 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 17:09:38.908 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 17:09:38.967 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 17:09:38.978 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 17:09:38.982 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 17:09:38.990 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 17:09:38.999 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 17:09:39.004 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 17:09:39.233 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.240 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.243 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.290 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 17:09:39.346 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.349 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.352 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.386 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 17:09:39.410 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 17:09:39.423 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.441 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 17:09:39.454 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 17:09:39.494 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:09:39.533 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 17:09:39.697 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 17:09:39.699 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 17:09:39.804 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 17:09:39.806 +04:00  INF  Hosting environment: Development
2025-03-24 17:09:39.807 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 17:09:40.043 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 17:09:40.262 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 226.7482ms
2025-03-24 17:09:40.284 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 17:09:40.284 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 17:09:40.292 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 8.5781ms
2025-03-24 17:09:40.337 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.7282ms
2025-03-24 17:09:40.558 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 17:09:40.592 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 33.8083ms
2025-03-24 17:20:20.211 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/register/company - application/json 152
2025-03-24 17:20:20.407 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.RegisterCompany (offers.itacademy.ge.API)'
2025-03-24 17:20:20.429 +04:00  INF  Route matched with {action = "RegisterCompany", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Users.Company.CompanyResponseModel] RegisterCompany(offers.itacademy.ge.Application.Models.Users.Company.CompanyRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 17:20:20.564 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__model_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:20:20.854 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 255), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Email], [ImageUrl], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[Balance], INSERTED.[IsActivated]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-03-24 17:20:20.889 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Users.Company.CompanyResponseModel'.
2025-03-24 17:20:20.904 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.RegisterCompany (offers.itacademy.ge.API) in 467.8671ms
2025-03-24 17:20:20.906 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.RegisterCompany (offers.itacademy.ge.API)'
2025-03-24 17:20:20.910 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/register/company - 200 null application/json; charset=utf-8 699.5958ms
2025-03-24 17:46:54.898 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/register/customer - application/json 126
2025-03-24 17:46:54.908 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.RegisterCustomer (offers.itacademy.ge.API)'
2025-03-24 17:46:54.918 +04:00  INF  Route matched with {action = "RegisterCustomer", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Users.Customer.CustomerResponseModel] RegisterCustomer(offers.itacademy.ge.Application.Models.Users.Customer.CustomerRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 17:46:54.979 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__model_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:46:55.122 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 100), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Balance], [Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-03-24 17:46:55.140 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Users.Customer.CustomerResponseModel'.
2025-03-24 17:46:55.146 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.RegisterCustomer (offers.itacademy.ge.API) in 225.7305ms
2025-03-24 17:46:55.148 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.RegisterCustomer (offers.itacademy.ge.API)'
2025-03-24 17:46:55.150 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/register/customer - 200 null application/json; charset=utf-8 253.0184ms
2025-03-24 17:51:13.648 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 49
2025-03-24 17:51:13.656 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 17:51:13.664 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 17:51:13.737 +04:00  INF  Executed DbCommand (11ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 17:51:13.910 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 17:51:13.913 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 246.1505ms
2025-03-24 17:51:13.914 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 17:51:13.916 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 267.8717ms
2025-03-24 17:51:39.207 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/register/admin - application/json 110
2025-03-24 17:51:39.248 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.RegisterAdmin (offers.itacademy.ge.API)'
2025-03-24 17:51:39.253 +04:00  INF  Route matched with {action = "RegisterAdmin", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Users.Admin.AdminResponseModel] RegisterAdmin(offers.itacademy.ge.Application.Models.Users.Admin.AdminRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 17:51:39.271 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__model_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 17:51:39.339 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (Size = 4000), @p2='?' (DbType = Int32), @p3='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Email], [Password], [Role], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-03-24 17:51:39.345 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Users.Admin.AdminResponseModel'.
2025-03-24 17:51:39.347 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.RegisterAdmin (offers.itacademy.ge.API) in 92.611ms
2025-03-24 17:51:39.349 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.RegisterAdmin (offers.itacademy.ge.API)'
2025-03-24 17:51:39.350 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/register/admin - 200 null application/json; charset=utf-8 143.5268ms
2025-03-24 17:52:14.810 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/4/activate-company - null 0
2025-03-24 17:52:14.817 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-24 17:52:14.820 +04:00  INF  Route matched with {action = "ActivateCompany", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Boolean] ActivateCompany(Int32, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 17:52:14.857 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 17:52:14.869 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 100), @p2='?' (Size = 255), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Balance] = @p0, [Email] = @p1, [ImageUrl] = @p2, [IsActivated] = @p3, [Password] = @p4, [Role] = @p5, [UserName] = @p6
OUTPUT 1
WHERE [Id] = @p7;
2025-03-24 17:52:14.873 +04:00  INF  Executing ObjectResult, writing value of type 'System.Boolean'.
2025-03-24 17:52:14.876 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API) in 53.8058ms
2025-03-24 17:52:14.878 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.ActivateCompany (offers.itacademy.ge.API)'
2025-03-24 17:52:14.880 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/4/activate-company - 200 null application/json; charset=utf-8 72.0631ms
2025-03-24 18:28:44.238 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:28:44.283 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:28:44.305 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:28:44.360 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:28:44.371 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:28:44.375 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:28:44.383 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:28:44.392 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:28:44.397 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:28:44.628 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:44.634 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:44.637 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:44.682 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:28:44.722 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:44.726 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:44.729 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:44.762 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:28:44.813 +04:00  FTL  Application failed to start.System.InvalidOperationException: Sequence contains more than one element
   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method74(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedProductOffers(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 108
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 40
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 25
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-24 18:28:56.030 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:28:56.085 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:28:56.108 +04:00  INF  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:28:56.168 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:28:56.179 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:28:56.183 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:28:56.189 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:28:56.199 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:28:56.202 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:28:56.478 +04:00  INF  Executed DbCommand (26ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:56.485 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:56.488 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:56.538 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:28:56.582 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:56.586 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:56.590 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:28:56.638 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:28:56.687 +04:00  FTL  Application failed to start.System.InvalidOperationException: Sequence contains more than one element
   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method74(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedProductOffers(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 108
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 40
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 25
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-24 18:29:42.908 +04:00  INF  Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:29:42.949 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:29:42.958 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:30:44.911 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:30:44.954 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:30:44.979 +04:00  INF  Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:30:45.036 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:30:45.046 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:30:45.049 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:30:45.055 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:30:45.064 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:30:45.069 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:30:45.299 +04:00  INF  Executed DbCommand (17ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:45.307 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:45.311 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:45.356 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:30:45.396 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:45.401 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:45.404 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:45.433 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:30:45.476 +04:00  FTL  Application failed to start.System.InvalidOperationException: Sequence contains more than one element
   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method74(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedProductOffers(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 108
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 40
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 25
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-24 18:30:51.820 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:30:51.874 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:30:51.889 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:30:51.954 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:30:51.963 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:30:51.965 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:30:51.969 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:30:51.978 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:30:51.979 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:30:52.212 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:52.220 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:52.224 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:52.268 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:30:52.307 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:52.311 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:52.315 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:30:52.342 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:30:52.387 +04:00  FTL  Application failed to start.System.InvalidOperationException: Sequence contains more than one element
   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method74(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedProductOffers(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 108
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 40
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 25
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-24 18:31:02.629 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:31:02.683 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:31:02.699 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:31:02.759 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:31:02.769 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:31:02.773 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:31:02.778 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:31:02.791 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:31:02.793 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:31:03.016 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:31:03.024 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:31:03.028 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:31:03.070 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:31:03.106 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:31:03.111 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:31:03.113 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:31:03.143 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:31:03.188 +04:00  FTL  Application failed to start.System.InvalidOperationException: Sequence contains more than one element
   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method74(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedProductOffers(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 108
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 40
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 25
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-24 18:31:59.658 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:31:59.710 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:31:59.747 +04:00  INF  Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:31:59.806 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:31:59.817 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:31:59.820 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:31:59.825 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:31:59.833 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:31:59.840 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:32:00.082 +04:00  INF  Executed DbCommand (23ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:32:00.089 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:32:00.092 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:32:00.138 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:32:00.179 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:32:00.183 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:32:00.186 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:32:00.216 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:34:54.494 +04:00  FTL  Application failed to start.System.InvalidOperationException: Sequence contains more than one element
   at System.Linq.ThrowHelper.ThrowMoreThanOneElementException()
   at System.Linq.Enumerable.TryGetSingle[TSource](IEnumerable`1 source, Boolean& found)
   at lambda_method74(Closure, QueryContext)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.Execute[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.Execute[TResult](Expression expression)
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedProductOffers(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 108
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.SeedEverything(DiscountPlatformContext context) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 40
   at offers.itacademy.ge.Persistance.Seed.DiscountPlatformSeed.Initialize(IServiceProvider serviceProviders) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.Persistance\Seed\DiscountPlatformSeed.cs:line 25
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 70

2025-03-24 18:34:59.111 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:34:59.176 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:34:59.201 +04:00  INF  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:34:59.268 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:34:59.277 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:34:59.280 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:34:59.287 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:34:59.295 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:34:59.300 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:34:59.529 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:34:59.536 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:34:59.539 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:34:59.584 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:34:59.623 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:34:59.628 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:34:59.631 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:34:59.661 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:35:41.922 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:35:41.964 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:35:41.982 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:35:42.035 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:35:42.046 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:35:42.050 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:35:42.055 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:35:42.063 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:35:42.066 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:35:42.291 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:35:42.299 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:35:42.302 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:35:42.349 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:35:42.392 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:35:42.396 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:35:42.398 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:35:42.428 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:36:51.683 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 18:36:51.894 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 18:36:51.897 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 18:36:51.999 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 18:36:52.001 +04:00  INF  Hosting environment: Development
2025-03-24 18:36:52.002 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 18:36:52.530 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 18:36:52.776 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 250.0067ms
2025-03-24 18:36:52.813 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 18:36:52.813 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 18:36:52.833 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 17.7307ms
2025-03-24 18:36:52.891 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 77.708ms
2025-03-24 18:36:53.125 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 18:36:53.166 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 41.0766ms
2025-03-24 18:37:04.608 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:37:04.653 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:37:04.674 +04:00  INF  Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:37:04.734 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:37:04.744 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:37:04.748 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:37:04.755 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:37:04.765 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:37:04.769 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:37:05.004 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:37:05.012 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:37:05.014 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:37:05.060 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:37:05.101 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:37:05.106 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:37:05.108 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:37:05.137 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:38:09.645 +04:00  INF  Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:38:09.691 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:38:09.713 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:38:09.770 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:38:09.781 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:38:09.784 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:38:09.791 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:38:09.799 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:38:09.803 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:38:10.051 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:10.060 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:10.063 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:15.655 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:38:15.705 +04:00  INF  Executed DbCommand (10ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:15.709 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:15.712 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:17.363 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:38:55.109 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:38:55.159 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:38:55.181 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:38:55.233 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:38:55.244 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:38:55.248 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:38:55.255 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:38:55.263 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:38:55.266 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:38:55.510 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:55.518 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:38:55.522 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:39:01.288 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:39:01.337 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:39:01.343 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:39:01.346 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:39:03.502 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:40:07.777 +04:00  INF  Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:40:07.823 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:40:07.845 +04:00  INF  Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:40:07.901 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:40:07.910 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:40:07.913 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:40:07.919 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:40:07.927 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:40:07.931 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:40:08.154 +04:00  INF  Executed DbCommand (22ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.161 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.164 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.216 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:40:08.269 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.273 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.276 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.318 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:40:08.342 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:40:08.355 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.373 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 18:40:08.385 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 18:40:08.426 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:40:08.466 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 18:40:08.628 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 18:40:08.630 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 18:40:08.733 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 18:40:08.735 +04:00  INF  Hosting environment: Development
2025-03-24 18:40:08.736 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 18:40:08.972 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 18:40:09.197 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 231.3061ms
2025-03-24 18:40:09.228 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 18:40:09.228 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 18:40:09.238 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.6089ms
2025-03-24 18:40:09.286 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 58.425ms
2025-03-24 18:40:09.397 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 18:40:09.431 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 35.2559ms
2025-03-24 18:41:03.655 +04:00  INF  Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:41:03.702 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:41:03.728 +04:00  INF  Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:41:03.785 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:41:03.794 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:41:03.799 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:41:03.808 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:41:03.817 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:41:03.821 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:41:04.044 +04:00  INF  Executed DbCommand (21ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.052 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.056 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.099 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:41:04.147 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.151 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.154 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.189 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:41:04.218 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:41:04.235 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.259 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 18:41:04.276 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 18:41:04.339 +04:00  INF  Executed DbCommand (7ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:04.396 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 18:41:04.617 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 18:41:04.618 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 18:41:04.742 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 18:41:04.744 +04:00  INF  Hosting environment: Development
2025-03-24 18:41:04.745 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 18:41:04.907 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 18:41:05.166 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 267.1583ms
2025-03-24 18:41:05.196 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 18:41:05.196 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 18:41:05.206 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 9.5169ms
2025-03-24 18:41:05.253 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 56.9875ms
2025-03-24 18:41:05.365 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 18:41:05.399 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 35.0328ms
2025-03-24 18:41:48.326 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:41:48.370 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 18:41:48.394 +04:00  INF  Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 18:41:48.452 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 18:41:48.462 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 18:41:48.466 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 18:41:48.472 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 18:41:48.480 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 18:41:48.485 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 18:41:48.726 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.734 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.738 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.784 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:41:48.826 +04:00  INF  Executed DbCommand (2ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.830 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.834 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.863 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 18:41:48.887 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 18:41:48.899 +04:00  INF  Executed DbCommand (5ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:48.918 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 18:41:48.931 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 18:41:48.972 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 18:41:49.012 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 18:41:49.181 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 18:41:49.182 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 18:41:49.317 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 18:41:49.318 +04:00  INF  Hosting environment: Development
2025-03-24 18:41:49.324 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 18:41:49.369 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 18:41:49.598 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 237.8322ms
2025-03-24 18:41:49.627 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 18:41:49.631 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 18:41:49.642 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.9566ms
2025-03-24 18:41:49.678 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 50.9857ms
2025-03-24 18:41:49.794 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 18:41:49.834 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.834ms
2025-03-24 19:09:37.632 +04:00  INF  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 19:09:37.679 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 19:09:37.703 +04:00  INF  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 19:09:37.759 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 19:09:37.770 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 19:09:37.774 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 19:09:37.782 +04:00  INF  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 19:09:37.792 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 19:09:37.796 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 19:09:38.025 +04:00  INF  Executed DbCommand (16ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.033 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.038 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.084 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 19:09:38.126 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.130 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.134 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.164 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 19:09:38.190 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 19:09:38.202 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.221 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 19:09:38.234 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 19:09:38.279 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:09:38.321 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 19:09:38.495 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 19:09:38.497 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 19:09:38.608 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 19:09:38.610 +04:00  INF  Hosting environment: Development
2025-03-24 19:09:38.611 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 19:09:39.068 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 19:09:39.321 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 260.5891ms
2025-03-24 19:09:39.349 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 19:09:39.349 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 19:09:39.369 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 20.1582ms
2025-03-24 19:09:39.405 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 56.1877ms
2025-03-24 19:09:39.566 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 19:09:39.596 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.1195ms
2025-03-24 19:09:52.675 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 19:09:52.696 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 19:09:52.720 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 19:09:52.868 +04:00  INF  Executed DbCommand (37ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 19:09:53.058 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 19:09:53.065 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 337.7978ms
2025-03-24 19:09:53.067 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 19:09:53.071 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 396.2861ms
2025-03-24 19:10:47.287 +04:00  INF  Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 19:10:47.334 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 19:10:47.360 +04:00  INF  Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 19:10:47.415 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 19:10:47.423 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 19:10:47.426 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 19:10:47.432 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 19:10:47.441 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 19:10:47.445 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 19:10:47.676 +04:00  INF  Executed DbCommand (19ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.683 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.686 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.734 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 19:10:47.787 +04:00  INF  Executed DbCommand (6ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.792 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.795 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.828 +04:00  INF  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 19:10:47.855 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 19:10:47.867 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.885 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 19:10:47.899 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 19:10:47.951 +04:00  INF  Executed DbCommand (8ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:10:47.997 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 19:10:48.068 +04:00  FTL  Application startup exceptionMicrosoft.AspNetCore.Routing.Patterns.RoutePatternException: There is an incomplete parameter in the route template. Check that each '{' character has a matching '}' character.
   at Microsoft.AspNetCore.Routing.Patterns.RoutePatternParser.Parse(String pattern)
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointFactory.AddEndpoints(List`1 endpoints, HashSet`1 routeNames, ActionDescriptor action, IReadOnlyList`1 routes, IReadOnlyList`1 conventions, IReadOnlyList`1 groupConventions, IReadOnlyList`1 finallyConventions, IReadOnlyList`1 groupFinallyConventions, Boolean createInertEndpoints, RoutePattern groupPrefix)
   at Microsoft.AspNetCore.Mvc.Routing.ControllerActionEndpointDataSource.CreateEndpoints(RoutePattern groupPrefix, IReadOnlyList`1 actions, IReadOnlyList`1 conventions, IReadOnlyList`1 groupConventions, IReadOnlyList`1 finallyConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.UpdateEndpoints()
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.Initialize()
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.GetChangeToken()
   at Microsoft.Extensions.Primitives.ChangeToken.ChangeTokenRegistration`1..ctor(Func`1 changeTokenProducer, Action`1 changeTokenConsumer, TState state)
   at Microsoft.Extensions.Primitives.ChangeToken.OnChange(Func`1 changeTokenProducer, Action changeTokenConsumer)
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateChangeTokenUnsynchronized(Boolean collectionChanged)
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureChangeTokenInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.GetChangeToken()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T& target, Boolean& initialized, Object& syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)

2025-03-24 19:10:48.083 +04:00  ERR  Hosting failed to startMicrosoft.AspNetCore.Routing.Patterns.RoutePatternException: There is an incomplete parameter in the route template. Check that each '{' character has a matching '}' character.
   at Microsoft.AspNetCore.Routing.Patterns.RoutePatternParser.Parse(String pattern)
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointFactory.AddEndpoints(List`1 endpoints, HashSet`1 routeNames, ActionDescriptor action, IReadOnlyList`1 routes, IReadOnlyList`1 conventions, IReadOnlyList`1 groupConventions, IReadOnlyList`1 finallyConventions, IReadOnlyList`1 groupFinallyConventions, Boolean createInertEndpoints, RoutePattern groupPrefix)
   at Microsoft.AspNetCore.Mvc.Routing.ControllerActionEndpointDataSource.CreateEndpoints(RoutePattern groupPrefix, IReadOnlyList`1 actions, IReadOnlyList`1 conventions, IReadOnlyList`1 groupConventions, IReadOnlyList`1 finallyConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.UpdateEndpoints()
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.Initialize()
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.GetChangeToken()
   at Microsoft.Extensions.Primitives.ChangeToken.ChangeTokenRegistration`1..ctor(Func`1 changeTokenProducer, Action`1 changeTokenConsumer, TState state)
   at Microsoft.Extensions.Primitives.ChangeToken.OnChange(Func`1 changeTokenProducer, Action changeTokenConsumer)
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateChangeTokenUnsynchronized(Boolean collectionChanged)
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureChangeTokenInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.GetChangeToken()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T& target, Boolean& initialized, Object& syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)

2025-03-24 19:10:48.115 +04:00  FTL  Application failed to start.Microsoft.AspNetCore.Routing.Patterns.RoutePatternException: There is an incomplete parameter in the route template. Check that each '{' character has a matching '}' character.
   at Microsoft.AspNetCore.Routing.Patterns.RoutePatternParser.Parse(String pattern)
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointFactory.AddEndpoints(List`1 endpoints, HashSet`1 routeNames, ActionDescriptor action, IReadOnlyList`1 routes, IReadOnlyList`1 conventions, IReadOnlyList`1 groupConventions, IReadOnlyList`1 finallyConventions, IReadOnlyList`1 groupFinallyConventions, Boolean createInertEndpoints, RoutePattern groupPrefix)
   at Microsoft.AspNetCore.Mvc.Routing.ControllerActionEndpointDataSource.CreateEndpoints(RoutePattern groupPrefix, IReadOnlyList`1 actions, IReadOnlyList`1 conventions, IReadOnlyList`1 groupConventions, IReadOnlyList`1 finallyConventions, IReadOnlyList`1 groupFinallyConventions)
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.UpdateEndpoints()
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.Initialize()
   at Microsoft.AspNetCore.Mvc.Routing.ActionEndpointDataSourceBase.GetChangeToken()
   at Microsoft.Extensions.Primitives.ChangeToken.ChangeTokenRegistration`1..ctor(Func`1 changeTokenProducer, Action`1 changeTokenConsumer, TState state)
   at Microsoft.Extensions.Primitives.ChangeToken.OnChange(Func`1 changeTokenProducer, Action changeTokenConsumer)
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.CreateChangeTokenUnsynchronized(Boolean collectionChanged)
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.EnsureChangeTokenInitialized()
   at Microsoft.AspNetCore.Routing.CompositeEndpointDataSource.GetChangeToken()
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.Initialize()
   at System.Threading.LazyInitializer.EnsureInitializedCore[T](T& target, Boolean& initialized, Object& syncLock, Func`1 valueFactory)
   at Microsoft.AspNetCore.Routing.DataSourceDependentCache`1.EnsureInitialized()
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationPolicyCache..ctor(EndpointDataSource dataSource)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithOneArg(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware..ctor(RequestDelegate next, IAuthorizationPolicyProvider policyProvider, IServiceProvider services)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddlewareInternal..ctor(RequestDelegate next, IServiceProvider services, IAuthorizationPolicyProvider policyProvider, ILogger`1 logger)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   at Microsoft.Extensions.Internal.ActivatorUtilities.CreateInstance(IServiceProvider provider, Type instanceType, Object[] parameters)
   at Microsoft.AspNetCore.Builder.UseMiddlewareExtensions.ReflectionMiddlewareBinder.CreateMiddleware(RequestDelegate next)
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.ApplicationBuilder.Build()
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API\Program.cs:line 71

2025-03-24 19:11:12.565 +04:00  INF  Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 19:11:12.612 +04:00  INF  Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-24 19:11:12.639 +04:00  INF  Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-24 19:11:12.716 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-24 19:11:12.726 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-24 19:11:12.729 +04:00  INF  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-24 19:11:12.737 +04:00  INF  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-24 19:11:12.745 +04:00  INF  No migrations were applied. The database is already up to date.
2025-03-24 19:11:12.750 +04:00  INF  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-24 19:11:12.980 +04:00  INF  Executed DbCommand (14ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:12.988 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:12.991 +04:00  INF  Executed DbCommand (0ms) [Parameters=[@__category_Name_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Categories] AS [c]
        WHERE [c].[Name] = @__category_Name_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:13.036 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 19:11:13.075 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:13.079 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:13.083 +04:00  INF  Executed DbCommand (1ms) [Parameters=[@__user_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[UserName] = @__user_UserName_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:13.130 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Role] = 1
2025-03-24 19:11:13.158 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Name]
FROM [Categories] AS [c]
2025-03-24 19:11:13.170 +04:00  INF  Executed DbCommand (3ms) [Parameters=[@__offer_Name_0='?' (Size = 100), @__offer_CompanyId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ProductOffers] AS [p]
        WHERE [p].[Name] = @__offer_Name_0 AND [p].[CompanyId] = @__offer_CompanyId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:13.189 +04:00  INF  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance]
FROM [Users] AS [u]
WHERE [u].[Role] = 2
2025-03-24 19:11:13.201 +04:00  INF  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status]
FROM [ProductOffers] AS [p]
2025-03-24 19:11:13.247 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@__purchase_CustomerId_0='?' (DbType = Int32), @__purchase_ProductOfferId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Purchases] AS [p]
        WHERE [p].[CustomerId] = @__purchase_CustomerId_0 AND [p].[ProductOfferId] = @__purchase_ProductOfferId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-24 19:11:13.289 +04:00  INF  User profile is available. Using 'C:\Users\irakl\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-24 19:11:13.461 +04:00  INF  Now listening on: https://localhost:7230
2025-03-24 19:11:13.462 +04:00  INF  Now listening on: http://localhost:5229
2025-03-24 19:11:13.563 +04:00  INF  Application started. Press Ctrl+C to shut down.
2025-03-24 19:11:13.565 +04:00  INF  Hosting environment: Development
2025-03-24 19:11:13.566 +04:00  INF  Content root path: C:\Users\irakl\Desktop\TBC .Net Course\Final Project\offers.itacademy.ge.API
2025-03-24 19:11:13.820 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/index.html - null null
2025-03-24 19:11:14.047 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/index.html - 200 null text/html;charset=utf-8 233.9736ms
2025-03-24 19:11:14.073 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_vs/browserLink - null null
2025-03-24 19:11:14.073 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - null null
2025-03-24 19:11:14.084 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_framework/aspnetcore-browser-refresh.js - 200 16531 application/javascript; charset=utf-8 10.6703ms
2025-03-24 19:11:14.114 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.7316ms
2025-03-24 19:11:14.348 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - null null
2025-03-24 19:11:14.378 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.4063ms
2025-03-24 19:11:27.881 +04:00  INF  Request starting HTTP/2 POST https://localhost:7230/api/Users/login - application/json 53
2025-03-24 19:11:27.899 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 19:11:27.924 +04:00  INF  Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.String] Login(offers.itacademy.ge.Application.Models.Users.UserLoginRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 19:11:28.041 +04:00  INF  Executed DbCommand (12ms) [Parameters=[@__model_UserName_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[UserName] = @__model_UserName_0
2025-03-24 19:11:28.226 +04:00  INF  Executing ObjectResult, writing value of type 'System.String'.
2025-03-24 19:11:28.232 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API) in 301.7771ms
2025-03-24 19:11:28.234 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.Login (offers.itacademy.ge.API)'
2025-03-24 19:11:28.239 +04:00  INF  Request finished HTTP/2 POST https://localhost:7230/api/Users/login - 200 null text/plain; charset=utf-8 357.7893ms
2025-03-24 19:12:15.345 +04:00  INF  Request starting HTTP/2 PUT https://localhost:7230/api/Users/update/customer - application/json 131
2025-03-24 19:12:15.385 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCustomer (offers.itacademy.ge.API)'
2025-03-24 19:12:15.391 +04:00  INF  Route matched with {action = "UpdateCustomer", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[offers.itacademy.ge.Application.Models.Users.Customer.CustomerResponseModel] UpdateCustomer(offers.itacademy.ge.Application.Models.Users.Customer.CustomerRequestModel, System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.UsersController (offers.itacademy.ge.API).
2025-03-24 19:12:15.498 +04:00  INF  Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-03-24 19:12:15.680 +04:00  INF  Executed DbCommand (4ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 100), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [Balance] = @p0, [Email] = @p1, [Password] = @p2, [Role] = @p3, [UserName] = @p4
OUTPUT 1
WHERE [Id] = @p5;
2025-03-24 19:12:15.755 +04:00  INF  Executing ObjectResult, writing value of type 'offers.itacademy.ge.Application.Models.Users.Customer.CustomerResponseModel'.
2025-03-24 19:12:15.764 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.UsersController.UpdateCustomer (offers.itacademy.ge.API) in 369.4888ms
2025-03-24 19:12:15.767 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.UsersController.UpdateCustomer (offers.itacademy.ge.API)'
2025-03-24 19:12:15.769 +04:00  INF  Request finished HTTP/2 PUT https://localhost:7230/api/Users/update/customer - 200 null application/json; charset=utf-8 425.1126ms
2025-03-24 19:13:39.465 +04:00  INF  Request starting HTTP/2 GET https://localhost:7230/api/ProductOffers/relevant-offers - null null
2025-03-24 19:13:39.474 +04:00  INF  Executing endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API)'
2025-03-24 19:13:39.477 +04:00  INF  Route matched with {action = "GetRelevantOffers", controller = "ProductOffers"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel]] GetRelevantOffers(System.Threading.CancellationToken) on controller offers.itacademy.ge.API.Controllers.ProductOffersController (offers.itacademy.ge.API).
2025-03-24 19:13:39.564 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [s].[CustomerId], [s].[SelectedCategoriesId], [s].[Id], [s].[Name]
FROM (
    SELECT TOP(1) [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Id] = @__userId_0
) AS [u0]
LEFT JOIN (
    SELECT [c].[CustomerId], [c].[SelectedCategoriesId], [c0].[Id], [c0].[Name]
    FROM [CustomerCategories] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[SelectedCategoriesId] = [c0].[Id]
) AS [s] ON [u0].[Id] = [s].[CustomerId]
ORDER BY [u0].[Id], [s].[CustomerId], [s].[SelectedCategoriesId]
2025-03-24 19:13:39.648 +04:00  INF  Executed DbCommand (9ms) [Parameters=[@__categoryIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[CategoryId], [p].[CompanyId], [p].[CreationTime], [p].[Description], [p].[ExpirationTime], [p].[Name], [p].[Price], [p].[Quantity], [p].[Status], [u0].[Id], [u0].[Email], [u0].[Password], [u0].[Role], [u0].[UserName], [u0].[Balance], [u0].[ImageUrl], [u0].[IsActivated], [c0].[Id], [c0].[Name]
FROM [ProductOffers] AS [p]
INNER JOIN (
    SELECT [u].[Id], [u].[Email], [u].[Password], [u].[Role], [u].[UserName], [u].[Balance], [u].[ImageUrl], [u].[IsActivated]
    FROM [Users] AS [u]
    WHERE [u].[Role] = 1
) AS [u0] ON [p].[CompanyId] = [u0].[Id]
LEFT JOIN [Categories] AS [c0] ON [p].[CategoryId] = [c0].[Id]
WHERE [p].[Status] = 0 AND [p].[CategoryId] IN (
    SELECT [c].[value]
    FROM OPENJSON(@__categoryIds_0) WITH ([value] int '$') AS [c]
)
2025-03-24 19:13:39.661 +04:00  INF  Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[offers.itacademy.ge.Application.Models.ProductOffers.ProductOfferResponseModel, offers.itacademy.ge.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-03-24 19:13:39.671 +04:00  INF  Executed action offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API) in 192.1598ms
2025-03-24 19:13:39.674 +04:00  INF  Executed endpoint 'offers.itacademy.ge.API.Controllers.ProductOffersController.GetRelevantOffers (offers.itacademy.ge.API)'
2025-03-24 19:13:39.680 +04:00  INF  Request finished HTTP/2 GET https://localhost:7230/api/ProductOffers/relevant-offers - 200 null application/json; charset=utf-8 215.4238ms
